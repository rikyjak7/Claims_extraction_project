<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation</title>
<!--Generated on Thu Oct 10 22:42:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.19483v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S1" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S2" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S2.SS1" title="In 2 Related Work ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>CLIP in Medical Domain</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S2.SS2" title="In 2 Related Work ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Weakly Supervised Semantic Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S2.SS3" title="In 2 Related Work ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>SAM for Medical Imaging Modalities</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS1" title="In 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Efficient BiomedCLIP Fine-Tuning with the DHN-NCE loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS2" title="In 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Zero-shot and Weakly Supervised Medical Image Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS3" title="In 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Datasets and Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS3.SSS1" title="In 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>BiomedCLIP fine-tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS3.SSS2" title="In 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Image segmentation accuracy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.SS3.SSS3" title="In 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Experimental setup and metrics</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS1" title="In 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Comparison with SOTA Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS2" title="In 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Cross-modal retrieval accuracy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS3" title="In 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS3.SSS1" title="In 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Effect of text prompt designs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS3.SSS2" title="In 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Component Ablation Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS3.SSS3" title="In 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Effect of Saliency Maps</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS3.SSS4" title="In 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.4 </span>SAM and Visual Prompting Comparison</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.SS4" title="In 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Qualitative Segmentation Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S5" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S6" title="In MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Taha Koleilat
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Hojat Asgariandehkordi
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Hassan Rivaz <span class="ltx_ERROR undefined" id="id1.1.id1">\IEEEmembership</span>Senior Member, IEEE
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> and Yiming Xiao <span class="ltx_ERROR undefined" id="id2.1.id1">\IEEEmembership</span>Senior Member, IEEE
</span><span class="ltx_author_notes">Submitted September 2024. This work was supported by the Natural Sciences and Engineering Research Council of Canada (NSERC).Taha Koleilat, Hojat Asgariandehkordi, and Hassan Rivaz are with the Department of Electrical and Computer Engineering, Concordia University, Montreal, Canada (e-mail: taha.koleilat@concordia.ca, hojat.asgariandehkordi@concordia.ca, hassan.rivaz@concordia.ca).Yiming Xiao is with the Department of Computer Science and Software Engineering, Concordia University, Montreal, Canada (e-mail: yiming.xiao@concordia.ca).</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">Segmentation of anatomical structures and pathological regions in medical images is essential for modern clinical diagnosis, disease research, and treatment planning. While significant advancements have been made in deep learning-based segmentation techniques, many of these methods still suffer from limitations in data efficiency, generalizability, and interactivity. As a result, developing precise segmentation methods that require fewer labeled datasets remains a critical challenge in medical image analysis. Recently, the introduction of foundation models like CLIP and Segment-Anything-Model (SAM), with robust cross-domain representations, has paved the way for interactive and universal image segmentation. However, further exploration of these models for data-efficient segmentation in medical imaging is still needed and highly relevant. In this paper, we introduce MedCLIP-SAMv2, a novel framework that integrates the CLIP and SAM models to perform segmentation on clinical scans using text prompts, in both zero-shot and weakly supervised settings. Our approach includes fine-tuning the BiomedCLIP model with a new Decoupled Hard Negative Noise Contrastive Estimation (DHN-NCE) loss, and leveraging the Multi-modal Information Bottleneck (M2IB) to create visual prompts for generating segmentation masks from SAM in the zero-shot setting. We also investigate using zero-shot segmentation labels within a weakly supervised paradigm to enhance segmentation quality further. Extensive testing across four diverse segmentation tasks and medical imaging modalities (breast tumor ultrasound, brain tumor MRI, lung X-ray, and lung CT) demonstrates the high accuracy of our proposed framework. Our code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/HealthX-Lab/MedCLIP-SAMv2" title="">https://github.com/HealthX-Lab/MedCLIP-SAMv2</a>.</p>
</div>
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">{IEEEkeywords}</span>
<p class="ltx_p" id="p1.2">Text-driven Image segmentation, Vision-Language models, Foundation Models, Weakly Supervised Semantic Segmentation</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<span class="ltx_ERROR undefined" id="S1.p1.1">\IEEEPARstart</span>
<p class="ltx_p" id="S1.p1.2">With the growing availability of radiological technologies, there is an increasing demand for precise and efficient medical image segmentation to support the study, diagnosis, and treatment of various medical conditions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib1" title="">1</a>]</cite>. Deep learning (DL) techniques have emerged as state-of-the-art (SOTA) in this field; however, they face three key challenges that hinder their broader clinical use. First, the scarcity of large, well-annotated datasets presents a major obstacle to DL model development. Second, the lack of interactivity and interpretability undermines trust in these methods. Finally, most medical DL models are trained for specific tasks and contrasts/modalities, limiting their flexibility. While several self-supervised and weakly supervised approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib4" title="">4</a>]</cite> have been introduced to improve training efficiency, and explainable AI (XAI) techniques (e.g., uncertainty estimation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib6" title="">6</a>]</cite> and saliency maps <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib8" title="">8</a>]</cite>) are under active investigation, cross-domain generalization remains a major challenge.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, the introduction of foundation models, such as Contrastive Language-Image Pre-Training (CLIP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib9" title="">9</a>]</cite> and Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib10" title="">10</a>]</cite> has paved the way for interactive and universal medical image segmentation. Several research groups have adapted CLIP and SAM for radiological tasks, including the development of BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> and MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib12" title="">12</a>]</cite>, which were pre-trained on vast amounts of biomedical data. However, further advances in parameter fine-tuning methods could enhance the performance of these models in radiology.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">As interest in SAM grows, to mitigate its reliance on drawing-based prompts (e.g., point and/or bounding box) for segmentation, which require prior clinical knowledge, recent methods have emerged to fine-tune SAM without prompts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib14" title="">14</a>]</cite>, generate prompts via Class Activation Maps (CAM) from classification tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib17" title="">17</a>]</cite>, and refine its output using weak supervision <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib20" title="">20</a>]</cite>. While still in its early stages, the use of foundation models for interactive and universal medical image segmentation remains an important area for further exploration. To address these challenges, we introduce MedCLIP-SAMv2, a novel framework that integrates BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> and SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib10" title="">10</a>]</cite> for text-prompt-based interactive and universal medical image segmentation, in both zero-shot and weakly supervised settings. The MedCLIP-SAMv2 framework extends and improves upon our original MedCLIP-SAM framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib21" title="">21</a>]</cite> from MICCAI 2024 by incorporating several updates:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We explored different saliency map generation techniques, where we replaced gScoreCAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib22" title="">22</a>]</cite> with M2IB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib23" title="">23</a>]</cite>, which, when combined with our fine-tuning of BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite>, significantly improved zero-shot segmentation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We enhanced weakly supervised segmentation results from the previous framework by training nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib24" title="">24</a>]</cite> using pseudo labels and providing uncertainty estimation via checkpoint ensembling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib25" title="">25</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The validation was expanded by incorporating an additional Lung CT dataset, thereby covering four key radiology modalities—CT, MRI, ultrasound, and X-ray. This comprehensive testing demonstrates the framework’s versatility and robustness across diverse segmentation tasks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We investigated advanced text prompt engineering strategies by leveraging LLM reasoning and various ensembling methods, which significantly influence zero-shot segmentation performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i5.p1">
<p class="ltx_p" id="S1.I1.i5.p1.1">Significantly more extensive experiments were conducted for further validation, including testing different SAM backbones and visual prompts. We meticulously evaluate the necessity of each component in our framework and demonstrate the incremental contribution to the overall performance.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p3.2">The refined MedCLIP-SAMv2 framework is now more accurate, advancing further toward universal text-driven medical image segmentation. Our contributions are threefold: <span class="ltx_text ltx_font_bold" id="S1.p3.2.1">First</span>, we propose a new CLIP training/fine-tuning approach called Decoupled Hard Negative Noise Contrastive Estimation (DHN-NCE). <span class="ltx_text ltx_font_bold" id="S1.p3.2.2">Second</span>, we introduce a text-driven zero-shot medical segmentation method, combining CLIP and SAM for radiological tasks. <span class="ltx_text ltx_font_bold" id="S1.p3.2.3">Lastly</span>, we explore a weakly-supervised strategy to further refine zero-shot segmentation results with uncertainty estimation. Our proposed framework is extensively validated across four distinct segmentation tasks and modalities, including breast tumor segmentation in ultrasound, brain tumor segmentation in MRI, and lung segmentation in chest X-ray and CT.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>CLIP in Medical Domain</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Several works have utilized CLIP for medical images and texts. Despite being trained on 400 million natural image-text pairs, CLIP’s performance suffers on medical tasks. For this reason, works like PubMedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib26" title="">26</a>]</cite> suggested fine-tuning CLIP on a set of PubMed articles for the task of Medical Question-Answering; Zhang <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> later showed PubMedCLIP’s poor performance on cross-modal retrieval tasks (worse than CLIP). On the other hand, MedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib27" title="">27</a>]</cite> proposed a technique to utilize decoupled images and texts in the training process to augment data while Windsor <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib28" title="">28</a>]</cite> explored different methods of enhancing the performance of vision-language models for medical domain tasks in a limited data setting. Alternatively, Wu <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.3">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib29" title="">29</a>]</cite> proposed a method of enhancing the text in medical reports by simplifying the sentence complexity. Moreover, other works like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib30" title="">30</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib31" title="">31</a>]</cite> have utilized CLIP for the task of expert pathology detection and medical report generation. However, notably, almost all mentioned works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib31" title="">31</a>]</cite> only utilized Chest X-ray data for their proposed methods. BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> is by far the most recent work for multi-modal medical data on a large scale, which was shown to be superior for cross-modal retrieval accuracy.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Weakly Supervised Semantic Segmentation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Many works have explored weakly supervised paradigms for segmenting distinct regions in natural images. CLIP-ES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib32" title="">32</a>]</cite> proposed a purely text-driven approach to producing better pseudo-masks through CLIP’s class activation maps instead of training affinity networks, while SAMS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib18" title="">18</a>]</cite> later extended the work by making use of the SAM model to produce coarse and fine seeds from image-level labels. Additionally, SG-WSSS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib33" title="">33</a>]</cite> studied different methods, including scribbles, points, and bounding boxes to prompt SAM through CAM scores. However, these works may fail to translate well to medical scans, which have different characteristics than natural images. Novel CAM techniques specifically tailored for CLIP models like gScoreCAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib22" title="">22</a>]</cite> and M2IB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib23" title="">23</a>]</cite> have emerged with SOTA results for generating multi-modal saliency maps. Specifically, gScoreCAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib22" title="">22</a>]</cite> utilized the top-K channel activations from the text and image encoder layers, leading to better-localized saliency maps. The more recent M2IB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib23" title="">23</a>]</cite> reformulates the information bottleneck theory to multi-modal applications, where it was proven to outperform CAM-based, perturbation-based, and attention-based saliency mapping techniques. Additionally, M2IB also demonstrated its potential for medical image applications, where a fine-tuned CLIP model on Chest X-ray datasets was shown to properly highlight regions of abnormalities. Recently, Liu <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib34" title="">34</a>]</cite> focus on improving interpretation of zero-shot medical image diagnosis through engineering relevant text prompts by integrating ChatGPT that outputs relevant descriptions of the radiological abnormality. However, the previous works don’t inspect improving medical segmentation through model training.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>SAM for Medical Imaging Modalities</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">With the advent of SAM, a myriad of research has been dedicated to adapting it for medical imaging purposes. MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib12" title="">12</a>]</cite> provided a large-scale fine-tuning of SAM on about 1 million medical image-mask pairs and demonstrated superior performance when it comes to multiple segmentation tasks. AutoSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib35" title="">35</a>]</cite> offered a more efficient approach to fine-tuning SAM on medical images through training the prompt encoder and developing a lightweight deconvolution mask decoder for medical segmentation tasks. Cheng <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib36" title="">36</a>]</cite> found that bounding boxes gave the best results when prompting SAM across 12 different medical segmentation tasks, and Huang <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib20" title="">20</a>]</cite> proposed a pseudo-mask correction framework to enhance noisy labels generated from SAM for medical images that can be used for further fine-tuning. Finally, Gong <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.3">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib37" title="">37</a>]</cite> replaced SAM’s mask decoder with a 3D convolutional neural network so that volumetric medical images can be supported.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">An overview of the proposed MedCLIP-SAMv2 framework is presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.F1" title="Figure 1 ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>, which is organized into three distinct stages: BiomedCLIP fine-tuning employing our new DHN-NCE loss, zero-shot segmentation guided by text-prompts, and weakly supervised segmentation for potential label refinement.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="336" id="S3.F1.g1" src="x1.png" width="770"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S3.F1.3.2" style="font-size:90%;">An overview of the proposed MedCLIP-SAMv2 framework.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Efficient BiomedCLIP Fine-Tuning with the DHN-NCE loss</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.8">Typically, a CLIP model is trained on large datasets consisting of images and their corresponding text descriptions. The model utilizes both an image encoder and a text encoder to extract features from images and texts, projecting them into vectors of the same dimension, denoted as <math alttext="\mathbf{I}_{p,i}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.2"><semantics id="S3.SS1.p1.1.m1.2a"><msub id="S3.SS1.p1.1.m1.2.3" xref="S3.SS1.p1.1.m1.2.3.cmml"><mi id="S3.SS1.p1.1.m1.2.3.2" xref="S3.SS1.p1.1.m1.2.3.2.cmml">𝐈</mi><mrow id="S3.SS1.p1.1.m1.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">p</mi><mo id="S3.SS1.p1.1.m1.2.2.2.4.1" xref="S3.SS1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.1.m1.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.3.cmml" xref="S3.SS1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.p1.1.m1.2.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.3.2.cmml" xref="S3.SS1.p1.1.m1.2.3.2">𝐈</ci><list id="S3.SS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4"><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑝</ci><ci id="S3.SS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">\mathbf{I}_{p,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.2d">bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for images and <math alttext="\mathbf{T}_{p,i}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.2"><semantics id="S3.SS1.p1.2.m2.2a"><msub id="S3.SS1.p1.2.m2.2.3" xref="S3.SS1.p1.2.m2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.2.3.2" xref="S3.SS1.p1.2.m2.2.3.2.cmml">𝐓</mi><mrow id="S3.SS1.p1.2.m2.2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">p</mi><mo id="S3.SS1.p1.2.m2.2.2.2.4.1" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.3.2">𝐓</ci><list id="S3.SS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.4"><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑝</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">\mathbf{T}_{p,i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.2d">bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for texts. Through contrastive learning, the model learns a shared embedding space, where similar image-text pairs are positioned closer together while dissimilar pairs are pulled further apart. Although BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> was trained on medical charts/images and clinical texts, further fine-tuning can significantly enhance its performance on tasks specific to medical imaging. In traditional CLIP training with the InfoNCE loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib38" title="">38</a>]</cite>, the <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.8.1">negative-positive-coupling (NPC)</span> effect <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib39" title="">39</a>]</cite> can reduce learning efficiency, especially with smaller batch sizes. Additionally, for medical images, distinguishing between subtle differences in cases within the same imaging category can be challenging. To address these issues, we propose the Decoupled Hard Negative Noise Contrastive Estimation (DHN-NCE) loss, which 1) combines the InfoNCE loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib38" title="">38</a>]</cite> with hard negative sampling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib40" title="">40</a>]</cite>, emphasizing “close samples”, and 2) incorporates decoupled contrastive learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib39" title="">39</a>]</cite> by removing the positive term in the denominator, allowing for smaller batch sizes. The resulting DHN-NCE loss function, <math alttext="\mathcal{L}_{DHN-NCE}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mrow id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.2.2.cmml">D</mi><mo id="S3.SS1.p1.3.m3.1.1.3.2.1" xref="S3.SS1.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.2.3" xref="S3.SS1.p1.3.m3.1.1.3.2.3.cmml">H</mi><mo id="S3.SS1.p1.3.m3.1.1.3.2.1a" xref="S3.SS1.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.2.4" xref="S3.SS1.p1.3.m3.1.1.3.2.4.cmml">N</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">−</mo><mrow id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p1.3.m3.1.1.3.3.1" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml">C</mi><mo id="S3.SS1.p1.3.m3.1.1.3.3.1a" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.4" xref="S3.SS1.p1.3.m3.1.1.3.3.4.cmml">E</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">ℒ</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><minus id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></minus><apply id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2"><times id="S3.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.2">𝐷</ci><ci id="S3.SS1.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.3">𝐻</ci><ci id="S3.SS1.p1.3.m3.1.1.3.2.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2.4">𝑁</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><times id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">𝐶</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.4">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{L}_{DHN-NCE}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_H italic_N - italic_N italic_C italic_E end_POSTSUBSCRIPT</annotation></semantics></math>, employs weighting functions (<math alttext="\mathcal{W}_{\mathbf{I}_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.4"><semantics id="S3.SS1.p1.4.m4.4a"><msubsup id="S3.SS1.p1.4.m4.4.5" xref="S3.SS1.p1.4.m4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.4.5.2.2" xref="S3.SS1.p1.4.m4.4.5.2.2.cmml">𝒲</mi><mrow id="S3.SS1.p1.4.m4.4.4.4" xref="S3.SS1.p1.4.m4.4.4.4.cmml"><msub id="S3.SS1.p1.4.m4.4.4.4.6" xref="S3.SS1.p1.4.m4.4.4.4.6.cmml"><mi id="S3.SS1.p1.4.m4.4.4.4.6.2" xref="S3.SS1.p1.4.m4.4.4.4.6.2.cmml">𝐈</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml">p</mi><mo id="S3.SS1.p1.4.m4.2.2.2.2.2.4.1" xref="S3.SS1.p1.4.m4.2.2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.4.m4.4.4.4.5" xref="S3.SS1.p1.4.m4.4.4.4.5.cmml">⁢</mo><msub id="S3.SS1.p1.4.m4.4.4.4.7" xref="S3.SS1.p1.4.m4.4.4.4.7.cmml"><mi id="S3.SS1.p1.4.m4.4.4.4.7.2" xref="S3.SS1.p1.4.m4.4.4.4.7.2.cmml">𝐓</mi><mrow id="S3.SS1.p1.4.m4.4.4.4.4.2.4" xref="S3.SS1.p1.4.m4.4.4.4.4.2.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.3.3.1.1" xref="S3.SS1.p1.4.m4.3.3.3.3.1.1.cmml">p</mi><mo id="S3.SS1.p1.4.m4.4.4.4.4.2.4.1" xref="S3.SS1.p1.4.m4.4.4.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.4.4.4.4.2.2" xref="S3.SS1.p1.4.m4.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.SS1.p1.4.m4.4.5.3" xref="S3.SS1.p1.4.m4.4.5.3.cmml"><mi id="S3.SS1.p1.4.m4.4.5.3.2" xref="S3.SS1.p1.4.m4.4.5.3.2.cmml">v</mi><mo id="S3.SS1.p1.4.m4.4.5.3.1" stretchy="false" xref="S3.SS1.p1.4.m4.4.5.3.1.cmml">→</mo><mi id="S3.SS1.p1.4.m4.4.5.3.3" xref="S3.SS1.p1.4.m4.4.5.3.3.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.4b"><apply id="S3.SS1.p1.4.m4.4.5.cmml" xref="S3.SS1.p1.4.m4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.5.1.cmml" xref="S3.SS1.p1.4.m4.4.5">superscript</csymbol><apply id="S3.SS1.p1.4.m4.4.5.2.cmml" xref="S3.SS1.p1.4.m4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.5.2.1.cmml" xref="S3.SS1.p1.4.m4.4.5">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.5.2.2.cmml" xref="S3.SS1.p1.4.m4.4.5.2.2">𝒲</ci><apply id="S3.SS1.p1.4.m4.4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4.4"><times id="S3.SS1.p1.4.m4.4.4.4.5.cmml" xref="S3.SS1.p1.4.m4.4.4.4.5"></times><apply id="S3.SS1.p1.4.m4.4.4.4.6.cmml" xref="S3.SS1.p1.4.m4.4.4.4.6"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.4.6.1.cmml" xref="S3.SS1.p1.4.m4.4.4.4.6">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.4.6.2.cmml" xref="S3.SS1.p1.4.m4.4.4.4.6.2">𝐈</ci><list id="S3.SS1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2.4"><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1">𝑝</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS1.p1.4.m4.4.4.4.7.cmml" xref="S3.SS1.p1.4.m4.4.4.4.7"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.4.7.1.cmml" xref="S3.SS1.p1.4.m4.4.4.4.7">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.4.7.2.cmml" xref="S3.SS1.p1.4.m4.4.4.4.7.2">𝐓</ci><list id="S3.SS1.p1.4.m4.4.4.4.4.2.3.cmml" xref="S3.SS1.p1.4.m4.4.4.4.4.2.4"><ci id="S3.SS1.p1.4.m4.3.3.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3.1.1">𝑝</ci><ci id="S3.SS1.p1.4.m4.4.4.4.4.2.2.cmml" xref="S3.SS1.p1.4.m4.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.SS1.p1.4.m4.4.5.3.cmml" xref="S3.SS1.p1.4.m4.4.5.3"><ci id="S3.SS1.p1.4.m4.4.5.3.1.cmml" xref="S3.SS1.p1.4.m4.4.5.3.1">→</ci><ci id="S3.SS1.p1.4.m4.4.5.3.2.cmml" xref="S3.SS1.p1.4.m4.4.5.3.2">𝑣</ci><ci id="S3.SS1.p1.4.m4.4.5.3.3.cmml" xref="S3.SS1.p1.4.m4.4.5.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.4c">\mathcal{W}_{\mathbf{I}_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.4d">caligraphic_W start_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v → italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{W}_{\mathbf{T}_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.4"><semantics id="S3.SS1.p1.5.m5.4a"><msubsup id="S3.SS1.p1.5.m5.4.5" xref="S3.SS1.p1.5.m5.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.5.2.2" xref="S3.SS1.p1.5.m5.4.5.2.2.cmml">𝒲</mi><mrow id="S3.SS1.p1.5.m5.4.4.4" xref="S3.SS1.p1.5.m5.4.4.4.cmml"><msub id="S3.SS1.p1.5.m5.4.4.4.6" xref="S3.SS1.p1.5.m5.4.4.4.6.cmml"><mi id="S3.SS1.p1.5.m5.4.4.4.6.2" xref="S3.SS1.p1.5.m5.4.4.4.6.2.cmml">𝐓</mi><mrow id="S3.SS1.p1.5.m5.2.2.2.2.2.4" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml">p</mi><mo id="S3.SS1.p1.5.m5.2.2.2.2.2.4.1" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.5.m5.2.2.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS1.p1.5.m5.4.4.4.5" xref="S3.SS1.p1.5.m5.4.4.4.5.cmml">⁢</mo><msub id="S3.SS1.p1.5.m5.4.4.4.7" xref="S3.SS1.p1.5.m5.4.4.4.7.cmml"><mi id="S3.SS1.p1.5.m5.4.4.4.7.2" xref="S3.SS1.p1.5.m5.4.4.4.7.2.cmml">𝐈</mi><mrow id="S3.SS1.p1.5.m5.4.4.4.4.2.4" xref="S3.SS1.p1.5.m5.4.4.4.4.2.3.cmml"><mi id="S3.SS1.p1.5.m5.3.3.3.3.1.1" xref="S3.SS1.p1.5.m5.3.3.3.3.1.1.cmml">p</mi><mo id="S3.SS1.p1.5.m5.4.4.4.4.2.4.1" xref="S3.SS1.p1.5.m5.4.4.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p1.5.m5.4.4.4.4.2.2" xref="S3.SS1.p1.5.m5.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.SS1.p1.5.m5.4.5.3" xref="S3.SS1.p1.5.m5.4.5.3.cmml"><mi id="S3.SS1.p1.5.m5.4.5.3.2" xref="S3.SS1.p1.5.m5.4.5.3.2.cmml">t</mi><mo id="S3.SS1.p1.5.m5.4.5.3.1" stretchy="false" xref="S3.SS1.p1.5.m5.4.5.3.1.cmml">→</mo><mi id="S3.SS1.p1.5.m5.4.5.3.3" xref="S3.SS1.p1.5.m5.4.5.3.3.cmml">v</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.4b"><apply id="S3.SS1.p1.5.m5.4.5.cmml" xref="S3.SS1.p1.5.m5.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.5.1.cmml" xref="S3.SS1.p1.5.m5.4.5">superscript</csymbol><apply id="S3.SS1.p1.5.m5.4.5.2.cmml" xref="S3.SS1.p1.5.m5.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.5.2.1.cmml" xref="S3.SS1.p1.5.m5.4.5">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.5.2.2.cmml" xref="S3.SS1.p1.5.m5.4.5.2.2">𝒲</ci><apply id="S3.SS1.p1.5.m5.4.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4.4"><times id="S3.SS1.p1.5.m5.4.4.4.5.cmml" xref="S3.SS1.p1.5.m5.4.4.4.5"></times><apply id="S3.SS1.p1.5.m5.4.4.4.6.cmml" xref="S3.SS1.p1.5.m5.4.4.4.6"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.4.6.1.cmml" xref="S3.SS1.p1.5.m5.4.4.4.6">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.4.6.2.cmml" xref="S3.SS1.p1.5.m5.4.4.4.6.2">𝐓</ci><list id="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.4"><ci id="S3.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.1.1">𝑝</ci><ci id="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS1.p1.5.m5.4.4.4.7.cmml" xref="S3.SS1.p1.5.m5.4.4.4.7"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.4.7.1.cmml" xref="S3.SS1.p1.5.m5.4.4.4.7">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.4.7.2.cmml" xref="S3.SS1.p1.5.m5.4.4.4.7.2">𝐈</ci><list id="S3.SS1.p1.5.m5.4.4.4.4.2.3.cmml" xref="S3.SS1.p1.5.m5.4.4.4.4.2.4"><ci id="S3.SS1.p1.5.m5.3.3.3.3.1.1.cmml" xref="S3.SS1.p1.5.m5.3.3.3.3.1.1">𝑝</ci><ci id="S3.SS1.p1.5.m5.4.4.4.4.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.SS1.p1.5.m5.4.5.3.cmml" xref="S3.SS1.p1.5.m5.4.5.3"><ci id="S3.SS1.p1.5.m5.4.5.3.1.cmml" xref="S3.SS1.p1.5.m5.4.5.3.1">→</ci><ci id="S3.SS1.p1.5.m5.4.5.3.2.cmml" xref="S3.SS1.p1.5.m5.4.5.3.2">𝑡</ci><ci id="S3.SS1.p1.5.m5.4.5.3.3.cmml" xref="S3.SS1.p1.5.m5.4.5.3.3">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.4c">\mathcal{W}_{\mathbf{T}_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.4d">caligraphic_W start_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t → italic_v end_POSTSUPERSCRIPT</annotation></semantics></math>) to increase the penalty for negative samples that are close to the anchor, using image-to-text and text-to-image hardness parameters <math alttext="\beta_{1},\beta_{2}\geq 0" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.2"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml"><mrow id="S3.SS1.p1.6.m6.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.3.cmml"><msub id="S3.SS1.p1.6.m6.1.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml">β</mi><mn id="S3.SS1.p1.6.m6.1.1.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.6.m6.2.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.6.m6.2.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.6.m6.2.2.2.2.2.2" xref="S3.SS1.p1.6.m6.2.2.2.2.2.2.cmml">β</mi><mn id="S3.SS1.p1.6.m6.2.2.2.2.2.3" xref="S3.SS1.p1.6.m6.2.2.2.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.SS1.p1.6.m6.2.2.3" xref="S3.SS1.p1.6.m6.2.2.3.cmml">≥</mo><mn id="S3.SS1.p1.6.m6.2.2.4" xref="S3.SS1.p1.6.m6.2.2.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><apply id="S3.SS1.p1.6.m6.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2"><geq id="S3.SS1.p1.6.m6.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.3"></geq><list id="S3.SS1.p1.6.m6.2.2.2.3.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2"><apply id="S3.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1.1.2">𝛽</ci><cn id="S3.SS1.p1.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.6.m6.2.2.2.2.2.2">𝛽</ci><cn id="S3.SS1.p1.6.m6.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2.2.2.2.3">2</cn></apply></list><cn id="S3.SS1.p1.6.m6.2.2.4.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">\beta_{1},\beta_{2}\geq 0</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ≥ 0</annotation></semantics></math>. In this context, <math alttext="t\rightarrow v" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">t</mi><mo id="S3.SS1.p1.7.m7.1.1.1" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.1.cmml">→</mo><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><ci id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1">→</ci><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑡</ci><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">t\rightarrow v</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_t → italic_v</annotation></semantics></math> refers to text-to-image, while <math alttext="v\rightarrow t" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">v</mi><mo id="S3.SS1.p1.8.m8.1.1.1" stretchy="false" xref="S3.SS1.p1.8.m8.1.1.1.cmml">→</mo><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><ci id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">→</ci><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑣</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">v\rightarrow t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_v → italic_t</annotation></semantics></math> indicates image-to-text.

<br class="ltx_break"/>
<br class="ltx_break"/></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" id="S3.E1.m1.1.1.1" style="width:427.5pt;height:46.8pt;vertical-align:-23.7pt;"><span class="ltx_transformed_inner" style="transform:translate(123.5pt,-6.7pt) scale(2.36734197213262,2.36734197213262) ;">
<p class="ltx_p" id="S3.E1.m1.1.1.1.1"><math alttext="\mathcal{L}^{v\rightarrow t}=-\sum\limits_{i=1}^{B}\frac{\mathbf{I}_{p,i}%
\mathbf{T}_{p,i}^{\top}}{\tau}+\sum\limits_{i=1}^{B}\log\left(\sum\limits_{j%
\neq i}e^{\mathbf{I}_{p,i}\mathbf{T}_{p,j}^{\top}/\tau}\mathcal{W}_{\mathbf{I}%
_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}\right)" class="ltx_Math" display="inline" id="S3.E1.m1.1.1.1.1.m1.14"><semantics id="S3.E1.m1.1.1.1.1.m1.14a"><mrow id="S3.E1.m1.1.1.1.1.m1.14.14" xref="S3.E1.m1.1.1.1.1.m1.14.14.cmml"><msup id="S3.E1.m1.1.1.1.1.m1.14.14.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.14.14.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.2.cmml">ℒ</mi><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.2.cmml">v</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.1.cmml">→</mo><mi id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.3.cmml">t</mi></mrow></msup><mo id="S3.E1.m1.1.1.1.1.m1.14.14.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.3a" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.3.cmml">B</mi></munderover><mfrac id="S3.E1.m1.1.1.1.1.m1.4.4" xref="S3.E1.m1.1.1.1.1.m1.4.4.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.4.4.4" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.cmml"><msub id="S3.E1.m1.1.1.1.1.m1.4.4.4.6" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.6.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.4.4.4.6.2" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.6.2.cmml">𝐈</mi><mrow id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.m1.4.4.4.5" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.5.cmml">⁢</mo><msubsup id="S3.E1.m1.1.1.1.1.m1.4.4.4.7" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.2" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.2.cmml">𝐓</mi><mrow id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.4" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.1" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.2" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.2.cmml">i</mi></mrow><mo id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.3" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7.3.cmml">⊤</mo></msubsup></mrow><mi id="S3.E1.m1.1.1.1.1.m1.4.4.6" xref="S3.E1.m1.1.1.1.1.m1.4.4.6.cmml">τ</mi></mfrac></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.2" rspace="0.055em" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.3.cmml">B</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.13.13" xref="S3.E1.m1.1.1.1.1.m1.13.13.cmml">log</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1a" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.cmml"><munder id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.1.cmml">≠</mo><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></munder><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.cmml"><msup id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.2.cmml">e</mi><mrow id="S3.E1.m1.1.1.1.1.m1.8.8.4" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.cmml"><mrow id="S3.E1.m1.1.1.1.1.m1.8.8.4.6" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.cmml"><msub id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.2" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.2.cmml">𝐈</mi><mrow id="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.4" xref="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.5.5.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.5.5.1.1.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.1" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.1.cmml">⁢</mo><msubsup id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.2" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.2.cmml">𝐓</mi><mrow id="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.4" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.7.7.3.3.1.1" xref="S3.E1.m1.1.1.1.1.m1.7.7.3.3.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.2" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.2.cmml">j</mi></mrow><mo id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.3" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S3.E1.m1.1.1.1.1.m1.8.8.4.5" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.5.cmml">/</mo><mi id="S3.E1.m1.1.1.1.1.m1.8.8.4.7" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.7.cmml">τ</mi></mrow></msup><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.2.cmml">𝒲</mi><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.4" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.cmml"><msub id="S3.E1.m1.1.1.1.1.m1.12.12.4.6" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.6.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.12.12.4.6.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.6.2.cmml">𝐈</mi><mrow id="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.4" xref="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.9.9.1.1.1.1" xref="S3.E1.m1.1.1.1.1.m1.9.9.1.1.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.2" xref="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E1.m1.1.1.1.1.m1.12.12.4.5" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.5.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.m1.12.12.4.7" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.7.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.12.12.4.7.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.7.2.cmml">𝐓</mi><mrow id="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.4" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.11.11.3.3.1.1" xref="S3.E1.m1.1.1.1.1.m1.11.11.3.3.1.1.cmml">p</mi><mo id="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.4.1" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.2" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.2" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.2.cmml">v</mi><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.1.cmml">→</mo><mi id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.3.cmml">t</mi></mrow></msubsup></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1.1.1.1.m1.14b"><apply id="S3.E1.m1.1.1.1.1.m1.14.14.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14"><eq id="S3.E1.m1.1.1.1.1.m1.14.14.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.2"></eq><apply id="S3.E1.m1.1.1.1.1.m1.14.14.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.14.14.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.2">ℒ</ci><apply id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3"><ci id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.1">→</ci><ci id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.2">𝑣</ci><ci id="S3.E1.m1.1.1.1.1.m1.14.14.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.3.3.3">𝑡</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1"><plus id="S3.E1.m1.1.1.1.1.m1.14.14.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.2"></plus><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3"><minus id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3"></minus><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2"><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3"><eq id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.3.2.1.3">𝐵</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.4.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4"><divide id="S3.E1.m1.1.1.1.1.m1.4.4.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4"></divide><apply id="S3.E1.m1.1.1.1.1.m1.4.4.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4"><times id="S3.E1.m1.1.1.1.1.m1.4.4.4.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.5"></times><apply id="S3.E1.m1.1.1.1.1.m1.4.4.4.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.4.4.4.6.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.6">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.4.4.4.6.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.6.2">𝐈</ci><list id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.1.1.1.1.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7.2.2">𝐓</ci><list id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.3.3.3.3.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.4.2.2">𝑖</ci></list></apply><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.m1.4.4.4.7.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.4.7.3">top</csymbol></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.4.4.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.4.4.6">𝜏</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1"><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.2.3">𝐵</ci></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1"><log id="S3.E1.m1.1.1.1.1.m1.13.13.cmml" xref="S3.E1.m1.1.1.1.1.m1.13.13"></log><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.2"></sum><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3"><neq id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.1"></neq><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.2.2">𝑒</ci><apply id="S3.E1.m1.1.1.1.1.m1.8.8.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4"><divide id="S3.E1.m1.1.1.1.1.m1.8.8.4.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.5"></divide><apply id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6"><times id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.1"></times><apply id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.2.2">𝐈</ci><list id="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.5.5.1.1.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.6.6.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.2.2">𝐓</ci><list id="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.7.7.3.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.7.7.3.3.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.4.2.2">𝑗</ci></list></apply><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.6.3.3">top</csymbol></apply></apply><ci id="S3.E1.m1.1.1.1.1.m1.8.8.4.7.cmml" xref="S3.E1.m1.1.1.1.1.m1.8.8.4.7">𝜏</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.2.2">𝒲</ci><apply id="S3.E1.m1.1.1.1.1.m1.12.12.4.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4"><times id="S3.E1.m1.1.1.1.1.m1.12.12.4.5.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.5"></times><apply id="S3.E1.m1.1.1.1.1.m1.12.12.4.6.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.12.12.4.6.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.6">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.12.12.4.6.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.6.2">𝐈</ci><list id="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.9.9.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.9.9.1.1.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.10.10.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E1.m1.1.1.1.1.m1.12.12.4.7.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.7"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.m1.12.12.4.7.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.7">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.m1.12.12.4.7.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.7.2">𝐓</ci><list id="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.4"><ci id="S3.E1.m1.1.1.1.1.m1.11.11.3.3.1.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.11.11.3.3.1.1">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.12.12.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3"><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.1">→</ci><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.2">𝑣</ci><ci id="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.m1.14.14.1.1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1.1.1.1.m1.14c">\mathcal{L}^{v\rightarrow t}=-\sum\limits_{i=1}^{B}\frac{\mathbf{I}_{p,i}%
\mathbf{T}_{p,i}^{\top}}{\tau}+\sum\limits_{i=1}^{B}\log\left(\sum\limits_{j%
\neq i}e^{\mathbf{I}_{p,i}\mathbf{T}_{p,j}^{\top}/\tau}\mathcal{W}_{\mathbf{I}%
_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1.1.1.1.m1.14d">caligraphic_L start_POSTSUPERSCRIPT italic_v → italic_t end_POSTSUPERSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT divide start_ARG bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_τ end_ARG + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT roman_log ( ∑ start_POSTSUBSCRIPT italic_j ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT / italic_τ end_POSTSUPERSCRIPT caligraphic_W start_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v → italic_t end_POSTSUPERSCRIPT )</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="0"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center">
<div class="ltx_inline-block ltx_markedasmath ltx_transformed_outer" id="S3.E2.m1.1.1.1" style="width:427.5pt;height:46.7pt;vertical-align:-23.6pt;"><span class="ltx_transformed_inner" style="transform:translate(123.3pt,-6.7pt) scale(2.3623908347299,2.3623908347299) ;">
<p class="ltx_p" id="S3.E2.m1.1.1.1.1"><math alttext="\mathcal{L}^{t\rightarrow v}=-\sum\limits_{i=1}^{B}\frac{\mathbf{T}_{p,i}%
\mathbf{I}_{p,i}^{\top}}{\tau}+\sum\limits_{i=1}^{B}log\left(\sum\limits_{j%
\neq i}e^{\mathbf{T}_{p,i}\mathbf{I}_{p,j}^{\top}/\tau}\mathcal{W}_{\mathbf{T}%
_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}\right)" class="ltx_Math" display="inline" id="S3.E2.m1.1.1.1.1.m1.13"><semantics id="S3.E2.m1.1.1.1.1.m1.13a"><mrow id="S3.E2.m1.1.1.1.1.m1.13.13" xref="S3.E2.m1.1.1.1.1.m1.13.13.cmml"><msup id="S3.E2.m1.1.1.1.1.m1.13.13.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.m1.13.13.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.2.cmml">ℒ</mi><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.1" stretchy="false" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.1.cmml">→</mo><mi id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.3.cmml">v</mi></mrow></msup><mo id="S3.E2.m1.1.1.1.1.m1.13.13.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.cmml"><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.3a" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.cmml">−</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.cmml"><munderover id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.cmml"><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.2" movablelimits="false" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.3.cmml">B</mi></munderover><mfrac id="S3.E2.m1.1.1.1.1.m1.4.4" xref="S3.E2.m1.1.1.1.1.m1.4.4.cmml"><mrow id="S3.E2.m1.1.1.1.1.m1.4.4.4" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.cmml"><msub id="S3.E2.m1.1.1.1.1.m1.4.4.4.6" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.6.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.4.4.4.6.2" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.6.2.cmml">𝐓</mi><mrow id="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.4" xref="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.m1.4.4.4.5" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.5.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.m1.4.4.4.7" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.2" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.2.cmml">𝐈</mi><mrow id="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.4" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.3.3.3.3.1.1" xref="S3.E2.m1.1.1.1.1.m1.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.2" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.2.cmml">i</mi></mrow><mo id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.3" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7.3.cmml">⊤</mo></msubsup></mrow><mi id="S3.E2.m1.1.1.1.1.m1.4.4.6" xref="S3.E2.m1.1.1.1.1.m1.4.4.6.cmml">τ</mi></mfrac></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.2" rspace="0.055em" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.2.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.cmml"><munderover id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.2" movablelimits="false" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.3.cmml">B</mi></munderover><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.3.cmml">l</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.4" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.4.cmml">o</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.5" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.5.cmml">g</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2b" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.cmml"><munder id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.2" lspace="0em" movablelimits="false" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.1.cmml">≠</mo><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></munder><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.cmml"><msup id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.2.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.m1.8.8.4" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.cmml"><mrow id="S3.E2.m1.1.1.1.1.m1.8.8.4.6" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.cmml"><msub id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.2" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.2.cmml">𝐓</mi><mrow id="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.4" xref="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.5.5.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.5.5.1.1.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.2" xref="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.1" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.1.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.2" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.2.cmml">𝐈</mi><mrow id="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.4" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.7.7.3.3.1.1" xref="S3.E2.m1.1.1.1.1.m1.7.7.3.3.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.2" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.2.cmml">j</mi></mrow><mo id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.3" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.3.cmml">⊤</mo></msubsup></mrow><mo id="S3.E2.m1.1.1.1.1.m1.8.8.4.5" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.5.cmml">/</mo><mi id="S3.E2.m1.1.1.1.1.m1.8.8.4.7" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.7.cmml">τ</mi></mrow></msup><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.1" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.2.cmml">𝒲</mi><mrow id="S3.E2.m1.1.1.1.1.m1.12.12.4" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.cmml"><msub id="S3.E2.m1.1.1.1.1.m1.12.12.4.6" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.6.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.12.12.4.6.2" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.6.2.cmml">𝐓</mi><mrow id="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.4" xref="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.9.9.1.1.1.1" xref="S3.E2.m1.1.1.1.1.m1.9.9.1.1.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.2" xref="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.m1.12.12.4.5" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.5.cmml">⁢</mo><msub id="S3.E2.m1.1.1.1.1.m1.12.12.4.7" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.7.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.12.12.4.7.2" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.7.2.cmml">𝐈</mi><mrow id="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.4" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.11.11.3.3.1.1" xref="S3.E2.m1.1.1.1.1.m1.11.11.3.3.1.1.cmml">p</mi><mo id="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.4.1" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.2" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.2" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.1" stretchy="false" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.1.cmml">→</mo><mi id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.3.cmml">v</mi></mrow></msubsup></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1.1.1.1.m1.13b"><apply id="S3.E2.m1.1.1.1.1.m1.13.13.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13"><eq id="S3.E2.m1.1.1.1.1.m1.13.13.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.2"></eq><apply id="S3.E2.m1.1.1.1.1.m1.13.13.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.13.13.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.2">ℒ</ci><apply id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3"><ci id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.1">→</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.2">𝑡</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.3.3.3">𝑣</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1"><plus id="S3.E2.m1.1.1.1.1.m1.13.13.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.2"></plus><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3"><minus id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3"></minus><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2"><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3"><eq id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.2">𝑖</ci><cn id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.3.2.1.3">𝐵</ci></apply><apply id="S3.E2.m1.1.1.1.1.m1.4.4.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4"><divide id="S3.E2.m1.1.1.1.1.m1.4.4.5.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4"></divide><apply id="S3.E2.m1.1.1.1.1.m1.4.4.4.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4"><times id="S3.E2.m1.1.1.1.1.m1.4.4.4.5.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.5"></times><apply id="S3.E2.m1.1.1.1.1.m1.4.4.4.6.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.4.4.4.6.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.6">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.4.4.4.6.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.6.2">𝐓</ci><list id="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.1.1.1.1.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7.2.2">𝐈</ci><list id="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.3.3.3.3.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.4.2.2">𝑖</ci></list></apply><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.m1.4.4.4.7.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.4.7.3">top</csymbol></apply></apply><ci id="S3.E2.m1.1.1.1.1.m1.4.4.6.cmml" xref="S3.E2.m1.1.1.1.1.m1.4.4.6">𝜏</ci></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1"><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3"><eq id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.2.3">𝐵</ci></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1"><times id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.3">𝑙</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.4">𝑜</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.5">𝑔</ci><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1"><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.2"></sum><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3"><neq id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.1"></neq><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.2">𝑗</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.2.2">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.m1.8.8.4.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4"><divide id="S3.E2.m1.1.1.1.1.m1.8.8.4.5.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.5"></divide><apply id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6"><times id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.1"></times><apply id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.2.2">𝐓</ci><list id="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.5.5.1.1.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.6.6.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.2.2">𝐈</ci><list id="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.7.7.3.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.7.7.3.3.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.4.2.2">𝑗</ci></list></apply><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.6.3.3">top</csymbol></apply></apply><ci id="S3.E2.m1.1.1.1.1.m1.8.8.4.7.cmml" xref="S3.E2.m1.1.1.1.1.m1.8.8.4.7">𝜏</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.2.2">𝒲</ci><apply id="S3.E2.m1.1.1.1.1.m1.12.12.4.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4"><times id="S3.E2.m1.1.1.1.1.m1.12.12.4.5.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.5"></times><apply id="S3.E2.m1.1.1.1.1.m1.12.12.4.6.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.12.12.4.6.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.6">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.12.12.4.6.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.6.2">𝐓</ci><list id="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.9.9.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.9.9.1.1.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.10.10.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E2.m1.1.1.1.1.m1.12.12.4.7.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.7"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.m1.12.12.4.7.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.7">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.m1.12.12.4.7.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.7.2">𝐈</ci><list id="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.4"><ci id="S3.E2.m1.1.1.1.1.m1.11.11.3.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.11.11.3.3.1.1">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.12.12.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3"><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.1">→</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.2">𝑡</ci><ci id="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.m1.13.13.1.1.1.1.1.1.2.3.3.3">𝑣</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1.1.1.1.m1.13c">\mathcal{L}^{t\rightarrow v}=-\sum\limits_{i=1}^{B}\frac{\mathbf{T}_{p,i}%
\mathbf{I}_{p,i}^{\top}}{\tau}+\sum\limits_{i=1}^{B}log\left(\sum\limits_{j%
\neq i}e^{\mathbf{T}_{p,i}\mathbf{I}_{p,j}^{\top}/\tau}\mathcal{W}_{\mathbf{T}%
_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1.1.1.1.m1.13d">caligraphic_L start_POSTSUPERSCRIPT italic_t → italic_v end_POSTSUPERSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT divide start_ARG bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_τ end_ARG + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT italic_l italic_o italic_g ( ∑ start_POSTSUBSCRIPT italic_j ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT / italic_τ end_POSTSUPERSCRIPT caligraphic_W start_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t → italic_v end_POSTSUPERSCRIPT )</annotation></semantics></math></p>
</span></div>
</td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="0"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{DHN-NCE}=\mathcal{L}^{v\rightarrow t}+\mathcal{L}^{t\rightarrow v}" class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml"><mrow id="S3.E3.m1.1.1.2.3.2" xref="S3.E3.m1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.1.1.2.3.2.2" xref="S3.E3.m1.1.1.2.3.2.2.cmml">D</mi><mo id="S3.E3.m1.1.1.2.3.2.1" xref="S3.E3.m1.1.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.2.3" xref="S3.E3.m1.1.1.2.3.2.3.cmml">H</mi><mo id="S3.E3.m1.1.1.2.3.2.1a" xref="S3.E3.m1.1.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.2.4" xref="S3.E3.m1.1.1.2.3.2.4.cmml">N</mi></mrow><mo id="S3.E3.m1.1.1.2.3.1" xref="S3.E3.m1.1.1.2.3.1.cmml">−</mo><mrow id="S3.E3.m1.1.1.2.3.3" xref="S3.E3.m1.1.1.2.3.3.cmml"><mi id="S3.E3.m1.1.1.2.3.3.2" xref="S3.E3.m1.1.1.2.3.3.2.cmml">N</mi><mo id="S3.E3.m1.1.1.2.3.3.1" xref="S3.E3.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.3.3" xref="S3.E3.m1.1.1.2.3.3.3.cmml">C</mi><mo id="S3.E3.m1.1.1.2.3.3.1a" xref="S3.E3.m1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.3.4" xref="S3.E3.m1.1.1.2.3.3.4.cmml">E</mi></mrow></mrow></msub><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><msup id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.2.3.2" xref="S3.E3.m1.1.1.3.2.3.2.cmml">v</mi><mo id="S3.E3.m1.1.1.3.2.3.1" stretchy="false" xref="S3.E3.m1.1.1.3.2.3.1.cmml">→</mo><mi id="S3.E3.m1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.3.2.3.3.cmml">t</mi></mrow></msup><mo id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">+</mo><msup id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.2.cmml">t</mi><mo id="S3.E3.m1.1.1.3.3.3.1" stretchy="false" xref="S3.E3.m1.1.1.3.3.3.1.cmml">→</mo><mi id="S3.E3.m1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.cmml">v</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">ℒ</ci><apply id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3"><minus id="S3.E3.m1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.2.3.1"></minus><apply id="S3.E3.m1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.2.3.2"><times id="S3.E3.m1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.1.1.2.3.2.1"></times><ci id="S3.E3.m1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.1.1.2.3.2.2">𝐷</ci><ci id="S3.E3.m1.1.1.2.3.2.3.cmml" xref="S3.E3.m1.1.1.2.3.2.3">𝐻</ci><ci id="S3.E3.m1.1.1.2.3.2.4.cmml" xref="S3.E3.m1.1.1.2.3.2.4">𝑁</ci></apply><apply id="S3.E3.m1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3"><times id="S3.E3.m1.1.1.2.3.3.1.cmml" xref="S3.E3.m1.1.1.2.3.3.1"></times><ci id="S3.E3.m1.1.1.2.3.3.2.cmml" xref="S3.E3.m1.1.1.2.3.3.2">𝑁</ci><ci id="S3.E3.m1.1.1.2.3.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3.3">𝐶</ci><ci id="S3.E3.m1.1.1.2.3.3.4.cmml" xref="S3.E3.m1.1.1.2.3.3.4">𝐸</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><plus id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></plus><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3"><ci id="S3.E3.m1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.3.1">→</ci><ci id="S3.E3.m1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.3.2">𝑣</ci><ci id="S3.E3.m1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2">ℒ</ci><apply id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3"><ci id="S3.E3.m1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3.1">→</ci><ci id="S3.E3.m1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.2">𝑡</ci><ci id="S3.E3.m1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathcal{L}_{DHN-NCE}=\mathcal{L}^{v\rightarrow t}+\mathcal{L}^{t\rightarrow v}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_H italic_N - italic_N italic_C italic_E end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_v → italic_t end_POSTSUPERSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_t → italic_v end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.10">where <math alttext="B" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m1.1"><semantics id="S3.SS1.p1.9.m1.1a"><mi id="S3.SS1.p1.9.m1.1.1" xref="S3.SS1.p1.9.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.1b"><ci id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m1.1d">italic_B</annotation></semantics></math> is the batch size, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m2.1"><semantics id="S3.SS1.p1.10.m2.1a"><mi id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><ci id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m2.1d">italic_τ</annotation></semantics></math> is the temperature parameter, and the hardness weighting formulas are as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{W}_{\mathbf{I}_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}=(B-1)\times%
\frac{e^{\beta_{1}\mathbf{I}_{p,i}\mathbf{T}_{p,j}/\tau}}{\sum_{k\neq i}e^{%
\beta_{1}\mathbf{I}_{p,i}\mathbf{T}_{p,k}/\tau}}" class="ltx_Math" display="block" id="S3.E4.m1.13"><semantics id="S3.E4.m1.13a"><mrow id="S3.E4.m1.13.13" xref="S3.E4.m1.13.13.cmml"><msubsup id="S3.E4.m1.13.13.3" xref="S3.E4.m1.13.13.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.13.13.3.2.2" xref="S3.E4.m1.13.13.3.2.2.cmml">𝒲</mi><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><msub id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml"><mi id="S3.E4.m1.4.4.4.6.2" xref="S3.E4.m1.4.4.4.6.2.cmml">𝐈</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">⁢</mo><msub id="S3.E4.m1.4.4.4.7" xref="S3.E4.m1.4.4.4.7.cmml"><mi id="S3.E4.m1.4.4.4.7.2" xref="S3.E4.m1.4.4.4.7.2.cmml">𝐓</mi><mrow id="S3.E4.m1.4.4.4.4.2.4" xref="S3.E4.m1.4.4.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E4.m1.4.4.4.4.2.4.1" xref="S3.E4.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.4.4.2.2" xref="S3.E4.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.E4.m1.13.13.3.3" xref="S3.E4.m1.13.13.3.3.cmml"><mi id="S3.E4.m1.13.13.3.3.2" xref="S3.E4.m1.13.13.3.3.2.cmml">v</mi><mo id="S3.E4.m1.13.13.3.3.1" stretchy="false" xref="S3.E4.m1.13.13.3.3.1.cmml">→</mo><mi id="S3.E4.m1.13.13.3.3.3" xref="S3.E4.m1.13.13.3.3.3.cmml">t</mi></mrow></msubsup><mo id="S3.E4.m1.13.13.2" xref="S3.E4.m1.13.13.2.cmml">=</mo><mrow id="S3.E4.m1.13.13.1" xref="S3.E4.m1.13.13.1.cmml"><mrow id="S3.E4.m1.13.13.1.1.1" xref="S3.E4.m1.13.13.1.1.1.1.cmml"><mo id="S3.E4.m1.13.13.1.1.1.2" stretchy="false" xref="S3.E4.m1.13.13.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.13.13.1.1.1.1" xref="S3.E4.m1.13.13.1.1.1.1.cmml"><mi id="S3.E4.m1.13.13.1.1.1.1.2" xref="S3.E4.m1.13.13.1.1.1.1.2.cmml">B</mi><mo id="S3.E4.m1.13.13.1.1.1.1.1" xref="S3.E4.m1.13.13.1.1.1.1.1.cmml">−</mo><mn id="S3.E4.m1.13.13.1.1.1.1.3" xref="S3.E4.m1.13.13.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E4.m1.13.13.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E4.m1.13.13.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.13.13.1.2" rspace="0.222em" xref="S3.E4.m1.13.13.1.2.cmml">×</mo><mfrac id="S3.E4.m1.12.12" xref="S3.E4.m1.12.12.cmml"><msup id="S3.E4.m1.8.8.4" xref="S3.E4.m1.8.8.4.cmml"><mi id="S3.E4.m1.8.8.4.6" xref="S3.E4.m1.8.8.4.6.cmml">e</mi><mrow id="S3.E4.m1.8.8.4.4.4" xref="S3.E4.m1.8.8.4.4.4.cmml"><mrow id="S3.E4.m1.8.8.4.4.4.6" xref="S3.E4.m1.8.8.4.4.4.6.cmml"><msub id="S3.E4.m1.8.8.4.4.4.6.2" xref="S3.E4.m1.8.8.4.4.4.6.2.cmml"><mi id="S3.E4.m1.8.8.4.4.4.6.2.2" xref="S3.E4.m1.8.8.4.4.4.6.2.2.cmml">β</mi><mn id="S3.E4.m1.8.8.4.4.4.6.2.3" xref="S3.E4.m1.8.8.4.4.4.6.2.3.cmml">1</mn></msub><mo id="S3.E4.m1.8.8.4.4.4.6.1" xref="S3.E4.m1.8.8.4.4.4.6.1.cmml">⁢</mo><msub id="S3.E4.m1.8.8.4.4.4.6.3" xref="S3.E4.m1.8.8.4.4.4.6.3.cmml"><mi id="S3.E4.m1.8.8.4.4.4.6.3.2" xref="S3.E4.m1.8.8.4.4.4.6.3.2.cmml">𝐈</mi><mrow id="S3.E4.m1.6.6.2.2.2.2.2.4" xref="S3.E4.m1.6.6.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E4.m1.6.6.2.2.2.2.2.4.1" xref="S3.E4.m1.6.6.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2.2.2.2.2" xref="S3.E4.m1.6.6.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E4.m1.8.8.4.4.4.6.1a" xref="S3.E4.m1.8.8.4.4.4.6.1.cmml">⁢</mo><msub id="S3.E4.m1.8.8.4.4.4.6.4" xref="S3.E4.m1.8.8.4.4.4.6.4.cmml"><mi id="S3.E4.m1.8.8.4.4.4.6.4.2" xref="S3.E4.m1.8.8.4.4.4.6.4.2.cmml">𝐓</mi><mrow id="S3.E4.m1.8.8.4.4.4.4.2.4" xref="S3.E4.m1.8.8.4.4.4.4.2.3.cmml"><mi id="S3.E4.m1.7.7.3.3.3.3.1.1" xref="S3.E4.m1.7.7.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E4.m1.8.8.4.4.4.4.2.4.1" xref="S3.E4.m1.8.8.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.4.4.4.4.2.2" xref="S3.E4.m1.8.8.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E4.m1.8.8.4.4.4.5" xref="S3.E4.m1.8.8.4.4.4.5.cmml">/</mo><mi id="S3.E4.m1.8.8.4.4.4.7" xref="S3.E4.m1.8.8.4.4.4.7.cmml">τ</mi></mrow></msup><mrow id="S3.E4.m1.12.12.8" xref="S3.E4.m1.12.12.8.cmml"><msub id="S3.E4.m1.12.12.8.5" xref="S3.E4.m1.12.12.8.5.cmml"><mo id="S3.E4.m1.12.12.8.5.2" xref="S3.E4.m1.12.12.8.5.2.cmml">∑</mo><mrow id="S3.E4.m1.12.12.8.5.3" xref="S3.E4.m1.12.12.8.5.3.cmml"><mi id="S3.E4.m1.12.12.8.5.3.2" xref="S3.E4.m1.12.12.8.5.3.2.cmml">k</mi><mo id="S3.E4.m1.12.12.8.5.3.1" xref="S3.E4.m1.12.12.8.5.3.1.cmml">≠</mo><mi id="S3.E4.m1.12.12.8.5.3.3" xref="S3.E4.m1.12.12.8.5.3.3.cmml">i</mi></mrow></msub><msup id="S3.E4.m1.12.12.8.6" xref="S3.E4.m1.12.12.8.6.cmml"><mi id="S3.E4.m1.12.12.8.6.2" xref="S3.E4.m1.12.12.8.6.2.cmml">e</mi><mrow id="S3.E4.m1.12.12.8.4.4" xref="S3.E4.m1.12.12.8.4.4.cmml"><mrow id="S3.E4.m1.12.12.8.4.4.6" xref="S3.E4.m1.12.12.8.4.4.6.cmml"><msub id="S3.E4.m1.12.12.8.4.4.6.2" xref="S3.E4.m1.12.12.8.4.4.6.2.cmml"><mi id="S3.E4.m1.12.12.8.4.4.6.2.2" xref="S3.E4.m1.12.12.8.4.4.6.2.2.cmml">β</mi><mn id="S3.E4.m1.12.12.8.4.4.6.2.3" xref="S3.E4.m1.12.12.8.4.4.6.2.3.cmml">1</mn></msub><mo id="S3.E4.m1.12.12.8.4.4.6.1" xref="S3.E4.m1.12.12.8.4.4.6.1.cmml">⁢</mo><msub id="S3.E4.m1.12.12.8.4.4.6.3" xref="S3.E4.m1.12.12.8.4.4.6.3.cmml"><mi id="S3.E4.m1.12.12.8.4.4.6.3.2" xref="S3.E4.m1.12.12.8.4.4.6.3.2.cmml">𝐈</mi><mrow id="S3.E4.m1.10.10.6.2.2.2.2.4" xref="S3.E4.m1.10.10.6.2.2.2.2.3.cmml"><mi id="S3.E4.m1.9.9.5.1.1.1.1.1" xref="S3.E4.m1.9.9.5.1.1.1.1.1.cmml">p</mi><mo id="S3.E4.m1.10.10.6.2.2.2.2.4.1" xref="S3.E4.m1.10.10.6.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.10.10.6.2.2.2.2.2" xref="S3.E4.m1.10.10.6.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E4.m1.12.12.8.4.4.6.1a" xref="S3.E4.m1.12.12.8.4.4.6.1.cmml">⁢</mo><msub id="S3.E4.m1.12.12.8.4.4.6.4" xref="S3.E4.m1.12.12.8.4.4.6.4.cmml"><mi id="S3.E4.m1.12.12.8.4.4.6.4.2" xref="S3.E4.m1.12.12.8.4.4.6.4.2.cmml">𝐓</mi><mrow id="S3.E4.m1.12.12.8.4.4.4.2.4" xref="S3.E4.m1.12.12.8.4.4.4.2.3.cmml"><mi id="S3.E4.m1.11.11.7.3.3.3.1.1" xref="S3.E4.m1.11.11.7.3.3.3.1.1.cmml">p</mi><mo id="S3.E4.m1.12.12.8.4.4.4.2.4.1" xref="S3.E4.m1.12.12.8.4.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.12.12.8.4.4.4.2.2" xref="S3.E4.m1.12.12.8.4.4.4.2.2.cmml">k</mi></mrow></msub></mrow><mo id="S3.E4.m1.12.12.8.4.4.5" xref="S3.E4.m1.12.12.8.4.4.5.cmml">/</mo><mi id="S3.E4.m1.12.12.8.4.4.7" xref="S3.E4.m1.12.12.8.4.4.7.cmml">τ</mi></mrow></msup></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.13b"><apply id="S3.E4.m1.13.13.cmml" xref="S3.E4.m1.13.13"><eq id="S3.E4.m1.13.13.2.cmml" xref="S3.E4.m1.13.13.2"></eq><apply id="S3.E4.m1.13.13.3.cmml" xref="S3.E4.m1.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.13.13.3.1.cmml" xref="S3.E4.m1.13.13.3">superscript</csymbol><apply id="S3.E4.m1.13.13.3.2.cmml" xref="S3.E4.m1.13.13.3"><csymbol cd="ambiguous" id="S3.E4.m1.13.13.3.2.1.cmml" xref="S3.E4.m1.13.13.3">subscript</csymbol><ci id="S3.E4.m1.13.13.3.2.2.cmml" xref="S3.E4.m1.13.13.3.2.2">𝒲</ci><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><times id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5"></times><apply id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.6.1.cmml" xref="S3.E4.m1.4.4.4.6">subscript</csymbol><ci id="S3.E4.m1.4.4.4.6.2.cmml" xref="S3.E4.m1.4.4.4.6.2">𝐈</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑝</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E4.m1.4.4.4.7.cmml" xref="S3.E4.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.7.1.cmml" xref="S3.E4.m1.4.4.4.7">subscript</csymbol><ci id="S3.E4.m1.4.4.4.7.2.cmml" xref="S3.E4.m1.4.4.4.7.2">𝐓</ci><list id="S3.E4.m1.4.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.4.2.4"><ci id="S3.E4.m1.3.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1">𝑝</ci><ci id="S3.E4.m1.4.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E4.m1.13.13.3.3.cmml" xref="S3.E4.m1.13.13.3.3"><ci id="S3.E4.m1.13.13.3.3.1.cmml" xref="S3.E4.m1.13.13.3.3.1">→</ci><ci id="S3.E4.m1.13.13.3.3.2.cmml" xref="S3.E4.m1.13.13.3.3.2">𝑣</ci><ci id="S3.E4.m1.13.13.3.3.3.cmml" xref="S3.E4.m1.13.13.3.3.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.13.13.1.cmml" xref="S3.E4.m1.13.13.1"><times id="S3.E4.m1.13.13.1.2.cmml" xref="S3.E4.m1.13.13.1.2"></times><apply id="S3.E4.m1.13.13.1.1.1.1.cmml" xref="S3.E4.m1.13.13.1.1.1"><minus id="S3.E4.m1.13.13.1.1.1.1.1.cmml" xref="S3.E4.m1.13.13.1.1.1.1.1"></minus><ci id="S3.E4.m1.13.13.1.1.1.1.2.cmml" xref="S3.E4.m1.13.13.1.1.1.1.2">𝐵</ci><cn id="S3.E4.m1.13.13.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.13.13.1.1.1.1.3">1</cn></apply><apply id="S3.E4.m1.12.12.cmml" xref="S3.E4.m1.12.12"><divide id="S3.E4.m1.12.12.9.cmml" xref="S3.E4.m1.12.12"></divide><apply id="S3.E4.m1.8.8.4.cmml" xref="S3.E4.m1.8.8.4"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.4.5.cmml" xref="S3.E4.m1.8.8.4">superscript</csymbol><ci id="S3.E4.m1.8.8.4.6.cmml" xref="S3.E4.m1.8.8.4.6">𝑒</ci><apply id="S3.E4.m1.8.8.4.4.4.cmml" xref="S3.E4.m1.8.8.4.4.4"><divide id="S3.E4.m1.8.8.4.4.4.5.cmml" xref="S3.E4.m1.8.8.4.4.4.5"></divide><apply id="S3.E4.m1.8.8.4.4.4.6.cmml" xref="S3.E4.m1.8.8.4.4.4.6"><times id="S3.E4.m1.8.8.4.4.4.6.1.cmml" xref="S3.E4.m1.8.8.4.4.4.6.1"></times><apply id="S3.E4.m1.8.8.4.4.4.6.2.cmml" xref="S3.E4.m1.8.8.4.4.4.6.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.4.4.4.6.2.1.cmml" xref="S3.E4.m1.8.8.4.4.4.6.2">subscript</csymbol><ci id="S3.E4.m1.8.8.4.4.4.6.2.2.cmml" xref="S3.E4.m1.8.8.4.4.4.6.2.2">𝛽</ci><cn id="S3.E4.m1.8.8.4.4.4.6.2.3.cmml" type="integer" xref="S3.E4.m1.8.8.4.4.4.6.2.3">1</cn></apply><apply id="S3.E4.m1.8.8.4.4.4.6.3.cmml" xref="S3.E4.m1.8.8.4.4.4.6.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.4.4.4.6.3.1.cmml" xref="S3.E4.m1.8.8.4.4.4.6.3">subscript</csymbol><ci id="S3.E4.m1.8.8.4.4.4.6.3.2.cmml" xref="S3.E4.m1.8.8.4.4.4.6.3.2">𝐈</ci><list id="S3.E4.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2.4"><ci id="S3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1.1.1.1">𝑝</ci><ci id="S3.E4.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E4.m1.8.8.4.4.4.6.4.cmml" xref="S3.E4.m1.8.8.4.4.4.6.4"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.4.4.4.6.4.1.cmml" xref="S3.E4.m1.8.8.4.4.4.6.4">subscript</csymbol><ci id="S3.E4.m1.8.8.4.4.4.6.4.2.cmml" xref="S3.E4.m1.8.8.4.4.4.6.4.2">𝐓</ci><list id="S3.E4.m1.8.8.4.4.4.4.2.3.cmml" xref="S3.E4.m1.8.8.4.4.4.4.2.4"><ci id="S3.E4.m1.7.7.3.3.3.3.1.1.cmml" xref="S3.E4.m1.7.7.3.3.3.3.1.1">𝑝</ci><ci id="S3.E4.m1.8.8.4.4.4.4.2.2.cmml" xref="S3.E4.m1.8.8.4.4.4.4.2.2">𝑗</ci></list></apply></apply><ci id="S3.E4.m1.8.8.4.4.4.7.cmml" xref="S3.E4.m1.8.8.4.4.4.7">𝜏</ci></apply></apply><apply id="S3.E4.m1.12.12.8.cmml" xref="S3.E4.m1.12.12.8"><apply id="S3.E4.m1.12.12.8.5.cmml" xref="S3.E4.m1.12.12.8.5"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.8.5.1.cmml" xref="S3.E4.m1.12.12.8.5">subscript</csymbol><sum id="S3.E4.m1.12.12.8.5.2.cmml" xref="S3.E4.m1.12.12.8.5.2"></sum><apply id="S3.E4.m1.12.12.8.5.3.cmml" xref="S3.E4.m1.12.12.8.5.3"><neq id="S3.E4.m1.12.12.8.5.3.1.cmml" xref="S3.E4.m1.12.12.8.5.3.1"></neq><ci id="S3.E4.m1.12.12.8.5.3.2.cmml" xref="S3.E4.m1.12.12.8.5.3.2">𝑘</ci><ci id="S3.E4.m1.12.12.8.5.3.3.cmml" xref="S3.E4.m1.12.12.8.5.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.12.12.8.6.cmml" xref="S3.E4.m1.12.12.8.6"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.8.6.1.cmml" xref="S3.E4.m1.12.12.8.6">superscript</csymbol><ci id="S3.E4.m1.12.12.8.6.2.cmml" xref="S3.E4.m1.12.12.8.6.2">𝑒</ci><apply id="S3.E4.m1.12.12.8.4.4.cmml" xref="S3.E4.m1.12.12.8.4.4"><divide id="S3.E4.m1.12.12.8.4.4.5.cmml" xref="S3.E4.m1.12.12.8.4.4.5"></divide><apply id="S3.E4.m1.12.12.8.4.4.6.cmml" xref="S3.E4.m1.12.12.8.4.4.6"><times id="S3.E4.m1.12.12.8.4.4.6.1.cmml" xref="S3.E4.m1.12.12.8.4.4.6.1"></times><apply id="S3.E4.m1.12.12.8.4.4.6.2.cmml" xref="S3.E4.m1.12.12.8.4.4.6.2"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.8.4.4.6.2.1.cmml" xref="S3.E4.m1.12.12.8.4.4.6.2">subscript</csymbol><ci id="S3.E4.m1.12.12.8.4.4.6.2.2.cmml" xref="S3.E4.m1.12.12.8.4.4.6.2.2">𝛽</ci><cn id="S3.E4.m1.12.12.8.4.4.6.2.3.cmml" type="integer" xref="S3.E4.m1.12.12.8.4.4.6.2.3">1</cn></apply><apply id="S3.E4.m1.12.12.8.4.4.6.3.cmml" xref="S3.E4.m1.12.12.8.4.4.6.3"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.8.4.4.6.3.1.cmml" xref="S3.E4.m1.12.12.8.4.4.6.3">subscript</csymbol><ci id="S3.E4.m1.12.12.8.4.4.6.3.2.cmml" xref="S3.E4.m1.12.12.8.4.4.6.3.2">𝐈</ci><list id="S3.E4.m1.10.10.6.2.2.2.2.3.cmml" xref="S3.E4.m1.10.10.6.2.2.2.2.4"><ci id="S3.E4.m1.9.9.5.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.5.1.1.1.1.1">𝑝</ci><ci id="S3.E4.m1.10.10.6.2.2.2.2.2.cmml" xref="S3.E4.m1.10.10.6.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E4.m1.12.12.8.4.4.6.4.cmml" xref="S3.E4.m1.12.12.8.4.4.6.4"><csymbol cd="ambiguous" id="S3.E4.m1.12.12.8.4.4.6.4.1.cmml" xref="S3.E4.m1.12.12.8.4.4.6.4">subscript</csymbol><ci id="S3.E4.m1.12.12.8.4.4.6.4.2.cmml" xref="S3.E4.m1.12.12.8.4.4.6.4.2">𝐓</ci><list id="S3.E4.m1.12.12.8.4.4.4.2.3.cmml" xref="S3.E4.m1.12.12.8.4.4.4.2.4"><ci id="S3.E4.m1.11.11.7.3.3.3.1.1.cmml" xref="S3.E4.m1.11.11.7.3.3.3.1.1">𝑝</ci><ci id="S3.E4.m1.12.12.8.4.4.4.2.2.cmml" xref="S3.E4.m1.12.12.8.4.4.4.2.2">𝑘</ci></list></apply></apply><ci id="S3.E4.m1.12.12.8.4.4.7.cmml" xref="S3.E4.m1.12.12.8.4.4.7">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.13c">\mathcal{W}_{\mathbf{I}_{p,i}\mathbf{T}_{p,j}}^{v\rightarrow t}=(B-1)\times%
\frac{e^{\beta_{1}\mathbf{I}_{p,i}\mathbf{T}_{p,j}/\tau}}{\sum_{k\neq i}e^{%
\beta_{1}\mathbf{I}_{p,i}\mathbf{T}_{p,k}/\tau}}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.13d">caligraphic_W start_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_v → italic_t end_POSTSUPERSCRIPT = ( italic_B - 1 ) × divide start_ARG italic_e start_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT / italic_τ end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_k end_POSTSUBSCRIPT / italic_τ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{W}_{\mathbf{T}_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}=(B-1)\times%
\frac{e^{\beta_{2}\mathbf{T}_{p,i}\mathbf{I}_{p,j}/\tau}}{\sum_{k\neq i}e^{%
\beta_{2}\mathbf{T}_{p,i}\mathbf{I}_{p,k}/\tau}}" class="ltx_Math" display="block" id="S3.E5.m1.13"><semantics id="S3.E5.m1.13a"><mrow id="S3.E5.m1.13.13" xref="S3.E5.m1.13.13.cmml"><msubsup id="S3.E5.m1.13.13.3" xref="S3.E5.m1.13.13.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.13.13.3.2.2" xref="S3.E5.m1.13.13.3.2.2.cmml">𝒲</mi><mrow id="S3.E5.m1.4.4.4" xref="S3.E5.m1.4.4.4.cmml"><msub id="S3.E5.m1.4.4.4.6" xref="S3.E5.m1.4.4.4.6.cmml"><mi id="S3.E5.m1.4.4.4.6.2" xref="S3.E5.m1.4.4.4.6.2.cmml">𝐓</mi><mrow id="S3.E5.m1.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E5.m1.2.2.2.2.2.4.1" xref="S3.E5.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E5.m1.4.4.4.5" xref="S3.E5.m1.4.4.4.5.cmml">⁢</mo><msub id="S3.E5.m1.4.4.4.7" xref="S3.E5.m1.4.4.4.7.cmml"><mi id="S3.E5.m1.4.4.4.7.2" xref="S3.E5.m1.4.4.4.7.2.cmml">𝐈</mi><mrow id="S3.E5.m1.4.4.4.4.2.4" xref="S3.E5.m1.4.4.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.3.3.1.1" xref="S3.E5.m1.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E5.m1.4.4.4.4.2.4.1" xref="S3.E5.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4.4.4.2.2" xref="S3.E5.m1.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="S3.E5.m1.13.13.3.3" xref="S3.E5.m1.13.13.3.3.cmml"><mi id="S3.E5.m1.13.13.3.3.2" xref="S3.E5.m1.13.13.3.3.2.cmml">t</mi><mo id="S3.E5.m1.13.13.3.3.1" stretchy="false" xref="S3.E5.m1.13.13.3.3.1.cmml">→</mo><mi id="S3.E5.m1.13.13.3.3.3" xref="S3.E5.m1.13.13.3.3.3.cmml">v</mi></mrow></msubsup><mo id="S3.E5.m1.13.13.2" xref="S3.E5.m1.13.13.2.cmml">=</mo><mrow id="S3.E5.m1.13.13.1" xref="S3.E5.m1.13.13.1.cmml"><mrow id="S3.E5.m1.13.13.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.cmml"><mo id="S3.E5.m1.13.13.1.1.1.2" stretchy="false" xref="S3.E5.m1.13.13.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.13.13.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.1.2.cmml">B</mi><mo id="S3.E5.m1.13.13.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.13.13.1.1.1.1.3" xref="S3.E5.m1.13.13.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.13.13.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E5.m1.13.13.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E5.m1.13.13.1.2" rspace="0.222em" xref="S3.E5.m1.13.13.1.2.cmml">×</mo><mfrac id="S3.E5.m1.12.12" xref="S3.E5.m1.12.12.cmml"><msup id="S3.E5.m1.8.8.4" xref="S3.E5.m1.8.8.4.cmml"><mi id="S3.E5.m1.8.8.4.6" xref="S3.E5.m1.8.8.4.6.cmml">e</mi><mrow id="S3.E5.m1.8.8.4.4.4" xref="S3.E5.m1.8.8.4.4.4.cmml"><mrow id="S3.E5.m1.8.8.4.4.4.6" xref="S3.E5.m1.8.8.4.4.4.6.cmml"><msub id="S3.E5.m1.8.8.4.4.4.6.2" xref="S3.E5.m1.8.8.4.4.4.6.2.cmml"><mi id="S3.E5.m1.8.8.4.4.4.6.2.2" xref="S3.E5.m1.8.8.4.4.4.6.2.2.cmml">β</mi><mn id="S3.E5.m1.8.8.4.4.4.6.2.3" xref="S3.E5.m1.8.8.4.4.4.6.2.3.cmml">2</mn></msub><mo id="S3.E5.m1.8.8.4.4.4.6.1" xref="S3.E5.m1.8.8.4.4.4.6.1.cmml">⁢</mo><msub id="S3.E5.m1.8.8.4.4.4.6.3" xref="S3.E5.m1.8.8.4.4.4.6.3.cmml"><mi id="S3.E5.m1.8.8.4.4.4.6.3.2" xref="S3.E5.m1.8.8.4.4.4.6.3.2.cmml">𝐓</mi><mrow id="S3.E5.m1.6.6.2.2.2.2.2.4" xref="S3.E5.m1.6.6.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml">p</mi><mo id="S3.E5.m1.6.6.2.2.2.2.2.4.1" xref="S3.E5.m1.6.6.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.6.6.2.2.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E5.m1.8.8.4.4.4.6.1a" xref="S3.E5.m1.8.8.4.4.4.6.1.cmml">⁢</mo><msub id="S3.E5.m1.8.8.4.4.4.6.4" xref="S3.E5.m1.8.8.4.4.4.6.4.cmml"><mi id="S3.E5.m1.8.8.4.4.4.6.4.2" xref="S3.E5.m1.8.8.4.4.4.6.4.2.cmml">𝐈</mi><mrow id="S3.E5.m1.8.8.4.4.4.4.2.4" xref="S3.E5.m1.8.8.4.4.4.4.2.3.cmml"><mi id="S3.E5.m1.7.7.3.3.3.3.1.1" xref="S3.E5.m1.7.7.3.3.3.3.1.1.cmml">p</mi><mo id="S3.E5.m1.8.8.4.4.4.4.2.4.1" xref="S3.E5.m1.8.8.4.4.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.8.8.4.4.4.4.2.2" xref="S3.E5.m1.8.8.4.4.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E5.m1.8.8.4.4.4.5" xref="S3.E5.m1.8.8.4.4.4.5.cmml">/</mo><mi id="S3.E5.m1.8.8.4.4.4.7" xref="S3.E5.m1.8.8.4.4.4.7.cmml">τ</mi></mrow></msup><mrow id="S3.E5.m1.12.12.8" xref="S3.E5.m1.12.12.8.cmml"><msub id="S3.E5.m1.12.12.8.5" xref="S3.E5.m1.12.12.8.5.cmml"><mo id="S3.E5.m1.12.12.8.5.2" xref="S3.E5.m1.12.12.8.5.2.cmml">∑</mo><mrow id="S3.E5.m1.12.12.8.5.3" xref="S3.E5.m1.12.12.8.5.3.cmml"><mi id="S3.E5.m1.12.12.8.5.3.2" xref="S3.E5.m1.12.12.8.5.3.2.cmml">k</mi><mo id="S3.E5.m1.12.12.8.5.3.1" xref="S3.E5.m1.12.12.8.5.3.1.cmml">≠</mo><mi id="S3.E5.m1.12.12.8.5.3.3" xref="S3.E5.m1.12.12.8.5.3.3.cmml">i</mi></mrow></msub><msup id="S3.E5.m1.12.12.8.6" xref="S3.E5.m1.12.12.8.6.cmml"><mi id="S3.E5.m1.12.12.8.6.2" xref="S3.E5.m1.12.12.8.6.2.cmml">e</mi><mrow id="S3.E5.m1.12.12.8.4.4" xref="S3.E5.m1.12.12.8.4.4.cmml"><mrow id="S3.E5.m1.12.12.8.4.4.6" xref="S3.E5.m1.12.12.8.4.4.6.cmml"><msub id="S3.E5.m1.12.12.8.4.4.6.2" xref="S3.E5.m1.12.12.8.4.4.6.2.cmml"><mi id="S3.E5.m1.12.12.8.4.4.6.2.2" xref="S3.E5.m1.12.12.8.4.4.6.2.2.cmml">β</mi><mn id="S3.E5.m1.12.12.8.4.4.6.2.3" xref="S3.E5.m1.12.12.8.4.4.6.2.3.cmml">2</mn></msub><mo id="S3.E5.m1.12.12.8.4.4.6.1" xref="S3.E5.m1.12.12.8.4.4.6.1.cmml">⁢</mo><msub id="S3.E5.m1.12.12.8.4.4.6.3" xref="S3.E5.m1.12.12.8.4.4.6.3.cmml"><mi id="S3.E5.m1.12.12.8.4.4.6.3.2" xref="S3.E5.m1.12.12.8.4.4.6.3.2.cmml">𝐓</mi><mrow id="S3.E5.m1.10.10.6.2.2.2.2.4" xref="S3.E5.m1.10.10.6.2.2.2.2.3.cmml"><mi id="S3.E5.m1.9.9.5.1.1.1.1.1" xref="S3.E5.m1.9.9.5.1.1.1.1.1.cmml">p</mi><mo id="S3.E5.m1.10.10.6.2.2.2.2.4.1" xref="S3.E5.m1.10.10.6.2.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.10.10.6.2.2.2.2.2" xref="S3.E5.m1.10.10.6.2.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.E5.m1.12.12.8.4.4.6.1a" xref="S3.E5.m1.12.12.8.4.4.6.1.cmml">⁢</mo><msub id="S3.E5.m1.12.12.8.4.4.6.4" xref="S3.E5.m1.12.12.8.4.4.6.4.cmml"><mi id="S3.E5.m1.12.12.8.4.4.6.4.2" xref="S3.E5.m1.12.12.8.4.4.6.4.2.cmml">𝐈</mi><mrow id="S3.E5.m1.12.12.8.4.4.4.2.4" xref="S3.E5.m1.12.12.8.4.4.4.2.3.cmml"><mi id="S3.E5.m1.11.11.7.3.3.3.1.1" xref="S3.E5.m1.11.11.7.3.3.3.1.1.cmml">p</mi><mo id="S3.E5.m1.12.12.8.4.4.4.2.4.1" xref="S3.E5.m1.12.12.8.4.4.4.2.3.cmml">,</mo><mi id="S3.E5.m1.12.12.8.4.4.4.2.2" xref="S3.E5.m1.12.12.8.4.4.4.2.2.cmml">k</mi></mrow></msub></mrow><mo id="S3.E5.m1.12.12.8.4.4.5" xref="S3.E5.m1.12.12.8.4.4.5.cmml">/</mo><mi id="S3.E5.m1.12.12.8.4.4.7" xref="S3.E5.m1.12.12.8.4.4.7.cmml">τ</mi></mrow></msup></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.13b"><apply id="S3.E5.m1.13.13.cmml" xref="S3.E5.m1.13.13"><eq id="S3.E5.m1.13.13.2.cmml" xref="S3.E5.m1.13.13.2"></eq><apply id="S3.E5.m1.13.13.3.cmml" xref="S3.E5.m1.13.13.3"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.3.1.cmml" xref="S3.E5.m1.13.13.3">superscript</csymbol><apply id="S3.E5.m1.13.13.3.2.cmml" xref="S3.E5.m1.13.13.3"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.3.2.1.cmml" xref="S3.E5.m1.13.13.3">subscript</csymbol><ci id="S3.E5.m1.13.13.3.2.2.cmml" xref="S3.E5.m1.13.13.3.2.2">𝒲</ci><apply id="S3.E5.m1.4.4.4.cmml" xref="S3.E5.m1.4.4.4"><times id="S3.E5.m1.4.4.4.5.cmml" xref="S3.E5.m1.4.4.4.5"></times><apply id="S3.E5.m1.4.4.4.6.cmml" xref="S3.E5.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.6.1.cmml" xref="S3.E5.m1.4.4.4.6">subscript</csymbol><ci id="S3.E5.m1.4.4.4.6.2.cmml" xref="S3.E5.m1.4.4.4.6.2">𝐓</ci><list id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝑝</ci><ci id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E5.m1.4.4.4.7.cmml" xref="S3.E5.m1.4.4.4.7"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.7.1.cmml" xref="S3.E5.m1.4.4.4.7">subscript</csymbol><ci id="S3.E5.m1.4.4.4.7.2.cmml" xref="S3.E5.m1.4.4.4.7.2">𝐈</ci><list id="S3.E5.m1.4.4.4.4.2.3.cmml" xref="S3.E5.m1.4.4.4.4.2.4"><ci id="S3.E5.m1.3.3.3.3.1.1.cmml" xref="S3.E5.m1.3.3.3.3.1.1">𝑝</ci><ci id="S3.E5.m1.4.4.4.4.2.2.cmml" xref="S3.E5.m1.4.4.4.4.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.E5.m1.13.13.3.3.cmml" xref="S3.E5.m1.13.13.3.3"><ci id="S3.E5.m1.13.13.3.3.1.cmml" xref="S3.E5.m1.13.13.3.3.1">→</ci><ci id="S3.E5.m1.13.13.3.3.2.cmml" xref="S3.E5.m1.13.13.3.3.2">𝑡</ci><ci id="S3.E5.m1.13.13.3.3.3.cmml" xref="S3.E5.m1.13.13.3.3.3">𝑣</ci></apply></apply><apply id="S3.E5.m1.13.13.1.cmml" xref="S3.E5.m1.13.13.1"><times id="S3.E5.m1.13.13.1.2.cmml" xref="S3.E5.m1.13.13.1.2"></times><apply id="S3.E5.m1.13.13.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1"><minus id="S3.E5.m1.13.13.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1"></minus><ci id="S3.E5.m1.13.13.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.2">𝐵</ci><cn id="S3.E5.m1.13.13.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.13.13.1.1.1.1.3">1</cn></apply><apply id="S3.E5.m1.12.12.cmml" xref="S3.E5.m1.12.12"><divide id="S3.E5.m1.12.12.9.cmml" xref="S3.E5.m1.12.12"></divide><apply id="S3.E5.m1.8.8.4.cmml" xref="S3.E5.m1.8.8.4"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.4.5.cmml" xref="S3.E5.m1.8.8.4">superscript</csymbol><ci id="S3.E5.m1.8.8.4.6.cmml" xref="S3.E5.m1.8.8.4.6">𝑒</ci><apply id="S3.E5.m1.8.8.4.4.4.cmml" xref="S3.E5.m1.8.8.4.4.4"><divide id="S3.E5.m1.8.8.4.4.4.5.cmml" xref="S3.E5.m1.8.8.4.4.4.5"></divide><apply id="S3.E5.m1.8.8.4.4.4.6.cmml" xref="S3.E5.m1.8.8.4.4.4.6"><times id="S3.E5.m1.8.8.4.4.4.6.1.cmml" xref="S3.E5.m1.8.8.4.4.4.6.1"></times><apply id="S3.E5.m1.8.8.4.4.4.6.2.cmml" xref="S3.E5.m1.8.8.4.4.4.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.4.4.4.6.2.1.cmml" xref="S3.E5.m1.8.8.4.4.4.6.2">subscript</csymbol><ci id="S3.E5.m1.8.8.4.4.4.6.2.2.cmml" xref="S3.E5.m1.8.8.4.4.4.6.2.2">𝛽</ci><cn id="S3.E5.m1.8.8.4.4.4.6.2.3.cmml" type="integer" xref="S3.E5.m1.8.8.4.4.4.6.2.3">2</cn></apply><apply id="S3.E5.m1.8.8.4.4.4.6.3.cmml" xref="S3.E5.m1.8.8.4.4.4.6.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.4.4.4.6.3.1.cmml" xref="S3.E5.m1.8.8.4.4.4.6.3">subscript</csymbol><ci id="S3.E5.m1.8.8.4.4.4.6.3.2.cmml" xref="S3.E5.m1.8.8.4.4.4.6.3.2">𝐓</ci><list id="S3.E5.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.4"><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">𝑝</ci><ci id="S3.E5.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E5.m1.8.8.4.4.4.6.4.cmml" xref="S3.E5.m1.8.8.4.4.4.6.4"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.4.4.4.6.4.1.cmml" xref="S3.E5.m1.8.8.4.4.4.6.4">subscript</csymbol><ci id="S3.E5.m1.8.8.4.4.4.6.4.2.cmml" xref="S3.E5.m1.8.8.4.4.4.6.4.2">𝐈</ci><list id="S3.E5.m1.8.8.4.4.4.4.2.3.cmml" xref="S3.E5.m1.8.8.4.4.4.4.2.4"><ci id="S3.E5.m1.7.7.3.3.3.3.1.1.cmml" xref="S3.E5.m1.7.7.3.3.3.3.1.1">𝑝</ci><ci id="S3.E5.m1.8.8.4.4.4.4.2.2.cmml" xref="S3.E5.m1.8.8.4.4.4.4.2.2">𝑗</ci></list></apply></apply><ci id="S3.E5.m1.8.8.4.4.4.7.cmml" xref="S3.E5.m1.8.8.4.4.4.7">𝜏</ci></apply></apply><apply id="S3.E5.m1.12.12.8.cmml" xref="S3.E5.m1.12.12.8"><apply id="S3.E5.m1.12.12.8.5.cmml" xref="S3.E5.m1.12.12.8.5"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.8.5.1.cmml" xref="S3.E5.m1.12.12.8.5">subscript</csymbol><sum id="S3.E5.m1.12.12.8.5.2.cmml" xref="S3.E5.m1.12.12.8.5.2"></sum><apply id="S3.E5.m1.12.12.8.5.3.cmml" xref="S3.E5.m1.12.12.8.5.3"><neq id="S3.E5.m1.12.12.8.5.3.1.cmml" xref="S3.E5.m1.12.12.8.5.3.1"></neq><ci id="S3.E5.m1.12.12.8.5.3.2.cmml" xref="S3.E5.m1.12.12.8.5.3.2">𝑘</ci><ci id="S3.E5.m1.12.12.8.5.3.3.cmml" xref="S3.E5.m1.12.12.8.5.3.3">𝑖</ci></apply></apply><apply id="S3.E5.m1.12.12.8.6.cmml" xref="S3.E5.m1.12.12.8.6"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.8.6.1.cmml" xref="S3.E5.m1.12.12.8.6">superscript</csymbol><ci id="S3.E5.m1.12.12.8.6.2.cmml" xref="S3.E5.m1.12.12.8.6.2">𝑒</ci><apply id="S3.E5.m1.12.12.8.4.4.cmml" xref="S3.E5.m1.12.12.8.4.4"><divide id="S3.E5.m1.12.12.8.4.4.5.cmml" xref="S3.E5.m1.12.12.8.4.4.5"></divide><apply id="S3.E5.m1.12.12.8.4.4.6.cmml" xref="S3.E5.m1.12.12.8.4.4.6"><times id="S3.E5.m1.12.12.8.4.4.6.1.cmml" xref="S3.E5.m1.12.12.8.4.4.6.1"></times><apply id="S3.E5.m1.12.12.8.4.4.6.2.cmml" xref="S3.E5.m1.12.12.8.4.4.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.8.4.4.6.2.1.cmml" xref="S3.E5.m1.12.12.8.4.4.6.2">subscript</csymbol><ci id="S3.E5.m1.12.12.8.4.4.6.2.2.cmml" xref="S3.E5.m1.12.12.8.4.4.6.2.2">𝛽</ci><cn id="S3.E5.m1.12.12.8.4.4.6.2.3.cmml" type="integer" xref="S3.E5.m1.12.12.8.4.4.6.2.3">2</cn></apply><apply id="S3.E5.m1.12.12.8.4.4.6.3.cmml" xref="S3.E5.m1.12.12.8.4.4.6.3"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.8.4.4.6.3.1.cmml" xref="S3.E5.m1.12.12.8.4.4.6.3">subscript</csymbol><ci id="S3.E5.m1.12.12.8.4.4.6.3.2.cmml" xref="S3.E5.m1.12.12.8.4.4.6.3.2">𝐓</ci><list id="S3.E5.m1.10.10.6.2.2.2.2.3.cmml" xref="S3.E5.m1.10.10.6.2.2.2.2.4"><ci id="S3.E5.m1.9.9.5.1.1.1.1.1.cmml" xref="S3.E5.m1.9.9.5.1.1.1.1.1">𝑝</ci><ci id="S3.E5.m1.10.10.6.2.2.2.2.2.cmml" xref="S3.E5.m1.10.10.6.2.2.2.2.2">𝑖</ci></list></apply><apply id="S3.E5.m1.12.12.8.4.4.6.4.cmml" xref="S3.E5.m1.12.12.8.4.4.6.4"><csymbol cd="ambiguous" id="S3.E5.m1.12.12.8.4.4.6.4.1.cmml" xref="S3.E5.m1.12.12.8.4.4.6.4">subscript</csymbol><ci id="S3.E5.m1.12.12.8.4.4.6.4.2.cmml" xref="S3.E5.m1.12.12.8.4.4.6.4.2">𝐈</ci><list id="S3.E5.m1.12.12.8.4.4.4.2.3.cmml" xref="S3.E5.m1.12.12.8.4.4.4.2.4"><ci id="S3.E5.m1.11.11.7.3.3.3.1.1.cmml" xref="S3.E5.m1.11.11.7.3.3.3.1.1">𝑝</ci><ci id="S3.E5.m1.12.12.8.4.4.4.2.2.cmml" xref="S3.E5.m1.12.12.8.4.4.4.2.2">𝑘</ci></list></apply></apply><ci id="S3.E5.m1.12.12.8.4.4.7.cmml" xref="S3.E5.m1.12.12.8.4.4.7">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.13c">\mathcal{W}_{\mathbf{T}_{p,i}\mathbf{I}_{p,j}}^{t\rightarrow v}=(B-1)\times%
\frac{e^{\beta_{2}\mathbf{T}_{p,i}\mathbf{I}_{p,j}/\tau}}{\sum_{k\neq i}e^{%
\beta_{2}\mathbf{T}_{p,i}\mathbf{I}_{p,k}/\tau}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.13d">caligraphic_W start_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t → italic_v end_POSTSUPERSCRIPT = ( italic_B - 1 ) × divide start_ARG italic_e start_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_j end_POSTSUBSCRIPT / italic_τ end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k ≠ italic_i end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_T start_POSTSUBSCRIPT italic_p , italic_i end_POSTSUBSCRIPT bold_I start_POSTSUBSCRIPT italic_p , italic_k end_POSTSUBSCRIPT / italic_τ end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Zero-shot and Weakly Supervised Medical Image Segmentation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5">In this stage, we utilize the fine-tuned BiomedCLIP with the updated parameters <math alttext="\boldsymbol{\theta}=\{\boldsymbol{\theta}_{\text{img}},\boldsymbol{\theta}_{%
\text{text}}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.2"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.4" xref="S3.SS2.p1.1.m1.2.2.4.cmml">𝜽</mi><mo id="S3.SS2.p1.1.m1.2.2.3" xref="S3.SS2.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml"><mo id="S3.SS2.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝜽</mi><mtext id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3a.cmml">img</mtext></msub><mo id="S3.SS2.p1.1.m1.2.2.2.2.4" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2.cmml">𝜽</mi><mtext id="S3.SS2.p1.1.m1.2.2.2.2.2.3" xref="S3.SS2.p1.1.m1.2.2.2.2.2.3a.cmml">text</mtext></msub><mo id="S3.SS2.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S3.SS2.p1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2"><eq id="S3.SS2.p1.1.m1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.3"></eq><ci id="S3.SS2.p1.1.m1.2.2.4.cmml" xref="S3.SS2.p1.1.m1.2.2.4">𝜽</ci><set id="S3.SS2.p1.1.m1.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2"><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.2">𝜽</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.3a.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3"><mtext id="S3.SS2.p1.1.m1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.1.1.1.1.1.3">img</mtext></ci></apply><apply id="S3.SS2.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.2">𝜽</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.2.3a.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.2.3"><mtext id="S3.SS2.p1.1.m1.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.2.2.2.2.2.3">text</mtext></ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">\boldsymbol{\theta}=\{\boldsymbol{\theta}_{\text{img}},\boldsymbol{\theta}_{%
\text{text}}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.2d">bold_italic_θ = { bold_italic_θ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT , bold_italic_θ start_POSTSUBSCRIPT text end_POSTSUBSCRIPT }</annotation></semantics></math> as the backbone model for feature extraction from both images and text prompts. The core segmentation process relies on the Multi-modal Information Bottleneck (M2IB) technique, which generates visual saliency maps of the target regions by associating text prompts with image regions.

<br class="ltx_break"/>
<br class="ltx_break"/>The zero-shot segmentation pipeline can be described mathematically as follows:

<br class="ltx_break"/>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.1">Image and Text Embedding Extraction</span>: Given input medical images <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">bold_I</annotation></semantics></math> and their corresponding text prompts <math alttext="\mathbf{T}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐓</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathbf{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">bold_T</annotation></semantics></math>, the image encoder <math alttext="\Phi_{\text{img}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" mathvariant="normal" xref="S3.SS2.p1.4.m4.1.1.2.cmml">Φ</mi><mtext id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3a.cmml">img</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">Φ</ci><ci id="S3.SS2.p1.4.m4.1.1.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><mtext id="S3.SS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.4.m4.1.1.3">img</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\Phi_{\text{img}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">roman_Φ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT</annotation></semantics></math> and the text encoder <math alttext="\Phi_{\text{text}}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" mathvariant="normal" xref="S3.SS2.p1.5.m5.1.1.2.cmml">Φ</mi><mtext id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">Φ</ci><ci id="S3.SS2.p1.5.m5.1.1.3a.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><mtext id="S3.SS2.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.5.m5.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\Phi_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">roman_Φ start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math> from the fine-tuned BiomedCLIP model are used to extract embeddings:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}_{\text{img}}=\Phi_{\text{img}}(\mathbf{I};\boldsymbol{\theta}_{%
\text{img}})" class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><msub id="S3.E6.m1.2.2.3" xref="S3.E6.m1.2.2.3.cmml"><mi id="S3.E6.m1.2.2.3.2" xref="S3.E6.m1.2.2.3.2.cmml">𝐙</mi><mtext id="S3.E6.m1.2.2.3.3" xref="S3.E6.m1.2.2.3.3a.cmml">img</mtext></msub><mo id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml">=</mo><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.cmml"><msub id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.2.2.1.3.cmml"><mi id="S3.E6.m1.2.2.1.3.2" mathvariant="normal" xref="S3.E6.m1.2.2.1.3.2.cmml">Φ</mi><mtext id="S3.E6.m1.2.2.1.3.3" xref="S3.E6.m1.2.2.1.3.3a.cmml">img</mtext></msub><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.2.cmml"><mo id="S3.E6.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐈</mi><mo id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.2.cmml">;</mo><msub id="S3.E6.m1.2.2.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.2.cmml">𝜽</mi><mtext id="S3.E6.m1.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.3a.cmml">img</mtext></msub><mo id="S3.E6.m1.2.2.1.1.1.4" stretchy="false" xref="S3.E6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><eq id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"></eq><apply id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.3.1.cmml" xref="S3.E6.m1.2.2.3">subscript</csymbol><ci id="S3.E6.m1.2.2.3.2.cmml" xref="S3.E6.m1.2.2.3.2">𝐙</ci><ci id="S3.E6.m1.2.2.3.3a.cmml" xref="S3.E6.m1.2.2.3.3"><mtext id="S3.E6.m1.2.2.3.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.3.3">img</mtext></ci></apply><apply id="S3.E6.m1.2.2.1.cmml" xref="S3.E6.m1.2.2.1"><times id="S3.E6.m1.2.2.1.2.cmml" xref="S3.E6.m1.2.2.1.2"></times><apply id="S3.E6.m1.2.2.1.3.cmml" xref="S3.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.3.1.cmml" xref="S3.E6.m1.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.3.2.cmml" xref="S3.E6.m1.2.2.1.3.2">Φ</ci><ci id="S3.E6.m1.2.2.1.3.3a.cmml" xref="S3.E6.m1.2.2.1.3.3"><mtext id="S3.E6.m1.2.2.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.1.3.3">img</mtext></ci></apply><list id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐈</ci><apply id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.2">𝜽</ci><ci id="S3.E6.m1.2.2.1.1.1.1.3a.cmml" xref="S3.E6.m1.2.2.1.1.1.1.3"><mtext id="S3.E6.m1.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.1.1.1.1.3">img</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\mathbf{Z}_{\text{img}}=\Phi_{\text{img}}(\mathbf{I};\boldsymbol{\theta}_{%
\text{img}})</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">bold_Z start_POSTSUBSCRIPT img end_POSTSUBSCRIPT = roman_Φ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT ( bold_I ; bold_italic_θ start_POSTSUBSCRIPT img end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}_{\text{text}}=\Phi_{\text{text}}(\mathbf{T};\boldsymbol{\theta}_{%
\text{text}})" class="ltx_Math" display="block" id="S3.E7.m1.2"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><msub id="S3.E7.m1.2.2.3" xref="S3.E7.m1.2.2.3.cmml"><mi id="S3.E7.m1.2.2.3.2" xref="S3.E7.m1.2.2.3.2.cmml">𝐙</mi><mtext id="S3.E7.m1.2.2.3.3" xref="S3.E7.m1.2.2.3.3a.cmml">text</mtext></msub><mo id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml">=</mo><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.cmml"><msub id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.2.2.1.3.cmml"><mi id="S3.E7.m1.2.2.1.3.2" mathvariant="normal" xref="S3.E7.m1.2.2.1.3.2.cmml">Φ</mi><mtext id="S3.E7.m1.2.2.1.3.3" xref="S3.E7.m1.2.2.1.3.3a.cmml">text</mtext></msub><mo id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.2.cmml"><mo id="S3.E7.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.1.1.2.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝐓</mi><mo id="S3.E7.m1.2.2.1.1.1.3" xref="S3.E7.m1.2.2.1.1.2.cmml">;</mo><msub id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml">𝜽</mi><mtext id="S3.E7.m1.2.2.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.3a.cmml">text</mtext></msub><mo id="S3.E7.m1.2.2.1.1.1.4" stretchy="false" xref="S3.E7.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><eq id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"></eq><apply id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.3.1.cmml" xref="S3.E7.m1.2.2.3">subscript</csymbol><ci id="S3.E7.m1.2.2.3.2.cmml" xref="S3.E7.m1.2.2.3.2">𝐙</ci><ci id="S3.E7.m1.2.2.3.3a.cmml" xref="S3.E7.m1.2.2.3.3"><mtext id="S3.E7.m1.2.2.3.3.cmml" mathsize="70%" xref="S3.E7.m1.2.2.3.3">text</mtext></ci></apply><apply id="S3.E7.m1.2.2.1.cmml" xref="S3.E7.m1.2.2.1"><times id="S3.E7.m1.2.2.1.2.cmml" xref="S3.E7.m1.2.2.1.2"></times><apply id="S3.E7.m1.2.2.1.3.cmml" xref="S3.E7.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.3.1.cmml" xref="S3.E7.m1.2.2.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.3.2.cmml" xref="S3.E7.m1.2.2.1.3.2">Φ</ci><ci id="S3.E7.m1.2.2.1.3.3a.cmml" xref="S3.E7.m1.2.2.1.3.3"><mtext id="S3.E7.m1.2.2.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.2.2.1.3.3">text</mtext></ci></apply><list id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝐓</ci><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">𝜽</ci><ci id="S3.E7.m1.2.2.1.1.1.1.3a.cmml" xref="S3.E7.m1.2.2.1.1.1.1.3"><mtext id="S3.E7.m1.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E7.m1.2.2.1.1.1.1.3">text</mtext></ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\mathbf{Z}_{\text{text}}=\Phi_{\text{text}}(\mathbf{T};\boldsymbol{\theta}_{%
\text{text}})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.2d">bold_Z start_POSTSUBSCRIPT text end_POSTSUBSCRIPT = roman_Φ start_POSTSUBSCRIPT text end_POSTSUBSCRIPT ( bold_T ; bold_italic_θ start_POSTSUBSCRIPT text end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.3"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.3.1">Saliency Map Generation</span>: The embeddings <math alttext="\mathbf{Z}_{\text{img}}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝐙</mi><mtext id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3a.cmml">img</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐙</ci><ci id="S3.SS2.p2.1.m1.1.1.3a.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><mtext id="S3.SS2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p2.1.m1.1.1.3">img</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathbf{Z}_{\text{img}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">bold_Z start_POSTSUBSCRIPT img end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{Z}_{\text{text}}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">𝐙</mi><mtext id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3a.cmml">text</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝐙</ci><ci id="S3.SS2.p2.2.m2.1.1.3a.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><mtext id="S3.SS2.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p2.2.m2.1.1.3">text</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathbf{Z}_{\text{text}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">bold_Z start_POSTSUBSCRIPT text end_POSTSUBSCRIPT</annotation></semantics></math> are then passed through the Multi-modal Information Bottleneck (M2IB) module, which learns to align the image and text modalities by maximizing the mutual information between them while filtering out irrelevant information between the image embedding and the input image. Specifically, the M2IB module produces a continuous visual saliency map <math alttext="\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">bold_S</annotation></semantics></math> for the image representing the importance of each pixel concerning the text prompt. This visual saliency map is produced by optimizing the following objective function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{S}=MI(\mathbf{Z}_{\text{img}},\mathbf{Z}_{\text{text}};\boldsymbol{%
\theta})-\beta\times MI(\mathbf{Z}_{\text{img}},\mathbf{I};\boldsymbol{\theta})" class="ltx_Math" display="block" id="S3.E8.m1.6"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6" xref="S3.E8.m1.6.6.cmml"><mi id="S3.E8.m1.6.6.5" xref="S3.E8.m1.6.6.5.cmml">𝐒</mi><mo id="S3.E8.m1.6.6.4" xref="S3.E8.m1.6.6.4.cmml">=</mo><mrow id="S3.E8.m1.6.6.3" xref="S3.E8.m1.6.6.3.cmml"><mrow id="S3.E8.m1.5.5.2.2" xref="S3.E8.m1.5.5.2.2.cmml"><mi id="S3.E8.m1.5.5.2.2.4" xref="S3.E8.m1.5.5.2.2.4.cmml">M</mi><mo id="S3.E8.m1.5.5.2.2.3" xref="S3.E8.m1.5.5.2.2.3.cmml">⁢</mo><mi id="S3.E8.m1.5.5.2.2.5" xref="S3.E8.m1.5.5.2.2.5.cmml">I</mi><mo id="S3.E8.m1.5.5.2.2.3a" xref="S3.E8.m1.5.5.2.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.2.2.2.2" xref="S3.E8.m1.5.5.2.2.2.3.cmml"><mo id="S3.E8.m1.5.5.2.2.2.2.3" stretchy="false" xref="S3.E8.m1.5.5.2.2.2.3.cmml">(</mo><msub id="S3.E8.m1.4.4.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.2.cmml">𝐙</mi><mtext id="S3.E8.m1.4.4.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.3a.cmml">img</mtext></msub><mo id="S3.E8.m1.5.5.2.2.2.2.4" xref="S3.E8.m1.5.5.2.2.2.3.cmml">,</mo><msub id="S3.E8.m1.5.5.2.2.2.2.2" xref="S3.E8.m1.5.5.2.2.2.2.2.cmml"><mi id="S3.E8.m1.5.5.2.2.2.2.2.2" xref="S3.E8.m1.5.5.2.2.2.2.2.2.cmml">𝐙</mi><mtext id="S3.E8.m1.5.5.2.2.2.2.2.3" xref="S3.E8.m1.5.5.2.2.2.2.2.3a.cmml">text</mtext></msub><mo id="S3.E8.m1.5.5.2.2.2.2.5" xref="S3.E8.m1.5.5.2.2.2.3.cmml">;</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝜽</mi><mo id="S3.E8.m1.5.5.2.2.2.2.6" stretchy="false" xref="S3.E8.m1.5.5.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.3.4" xref="S3.E8.m1.6.6.3.4.cmml">−</mo><mrow id="S3.E8.m1.6.6.3.3" xref="S3.E8.m1.6.6.3.3.cmml"><mrow id="S3.E8.m1.6.6.3.3.3" xref="S3.E8.m1.6.6.3.3.3.cmml"><mi id="S3.E8.m1.6.6.3.3.3.2" xref="S3.E8.m1.6.6.3.3.3.2.cmml">β</mi><mo id="S3.E8.m1.6.6.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.6.6.3.3.3.1.cmml">×</mo><mi id="S3.E8.m1.6.6.3.3.3.3" xref="S3.E8.m1.6.6.3.3.3.3.cmml">M</mi></mrow><mo id="S3.E8.m1.6.6.3.3.2" xref="S3.E8.m1.6.6.3.3.2.cmml">⁢</mo><mi id="S3.E8.m1.6.6.3.3.4" xref="S3.E8.m1.6.6.3.3.4.cmml">I</mi><mo id="S3.E8.m1.6.6.3.3.2a" xref="S3.E8.m1.6.6.3.3.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.3.3.1.1" xref="S3.E8.m1.6.6.3.3.1.2.cmml"><mo id="S3.E8.m1.6.6.3.3.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.3.3.1.2.cmml">(</mo><msub id="S3.E8.m1.6.6.3.3.1.1.1" xref="S3.E8.m1.6.6.3.3.1.1.1.cmml"><mi id="S3.E8.m1.6.6.3.3.1.1.1.2" xref="S3.E8.m1.6.6.3.3.1.1.1.2.cmml">𝐙</mi><mtext id="S3.E8.m1.6.6.3.3.1.1.1.3" xref="S3.E8.m1.6.6.3.3.1.1.1.3a.cmml">img</mtext></msub><mo id="S3.E8.m1.6.6.3.3.1.1.3" xref="S3.E8.m1.6.6.3.3.1.2.cmml">,</mo><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">𝐈</mi><mo id="S3.E8.m1.6.6.3.3.1.1.4" xref="S3.E8.m1.6.6.3.3.1.2.cmml">;</mo><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">𝜽</mi><mo id="S3.E8.m1.6.6.3.3.1.1.5" stretchy="false" xref="S3.E8.m1.6.6.3.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.cmml" xref="S3.E8.m1.6.6"><eq id="S3.E8.m1.6.6.4.cmml" xref="S3.E8.m1.6.6.4"></eq><ci id="S3.E8.m1.6.6.5.cmml" xref="S3.E8.m1.6.6.5">𝐒</ci><apply id="S3.E8.m1.6.6.3.cmml" xref="S3.E8.m1.6.6.3"><minus id="S3.E8.m1.6.6.3.4.cmml" xref="S3.E8.m1.6.6.3.4"></minus><apply id="S3.E8.m1.5.5.2.2.cmml" xref="S3.E8.m1.5.5.2.2"><times id="S3.E8.m1.5.5.2.2.3.cmml" xref="S3.E8.m1.5.5.2.2.3"></times><ci id="S3.E8.m1.5.5.2.2.4.cmml" xref="S3.E8.m1.5.5.2.2.4">𝑀</ci><ci id="S3.E8.m1.5.5.2.2.5.cmml" xref="S3.E8.m1.5.5.2.2.5">𝐼</ci><vector id="S3.E8.m1.5.5.2.2.2.3.cmml" xref="S3.E8.m1.5.5.2.2.2.2"><apply id="S3.E8.m1.4.4.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.2">𝐙</ci><ci id="S3.E8.m1.4.4.1.1.1.1.1.3a.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.3"><mtext id="S3.E8.m1.4.4.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E8.m1.4.4.1.1.1.1.1.3">img</mtext></ci></apply><apply id="S3.E8.m1.5.5.2.2.2.2.2.cmml" xref="S3.E8.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.E8.m1.5.5.2.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.E8.m1.5.5.2.2.2.2.2.2">𝐙</ci><ci id="S3.E8.m1.5.5.2.2.2.2.2.3a.cmml" xref="S3.E8.m1.5.5.2.2.2.2.2.3"><mtext id="S3.E8.m1.5.5.2.2.2.2.2.3.cmml" mathsize="70%" xref="S3.E8.m1.5.5.2.2.2.2.2.3">text</mtext></ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝜽</ci></vector></apply><apply id="S3.E8.m1.6.6.3.3.cmml" xref="S3.E8.m1.6.6.3.3"><times id="S3.E8.m1.6.6.3.3.2.cmml" xref="S3.E8.m1.6.6.3.3.2"></times><apply id="S3.E8.m1.6.6.3.3.3.cmml" xref="S3.E8.m1.6.6.3.3.3"><times id="S3.E8.m1.6.6.3.3.3.1.cmml" xref="S3.E8.m1.6.6.3.3.3.1"></times><ci id="S3.E8.m1.6.6.3.3.3.2.cmml" xref="S3.E8.m1.6.6.3.3.3.2">𝛽</ci><ci id="S3.E8.m1.6.6.3.3.3.3.cmml" xref="S3.E8.m1.6.6.3.3.3.3">𝑀</ci></apply><ci id="S3.E8.m1.6.6.3.3.4.cmml" xref="S3.E8.m1.6.6.3.3.4">𝐼</ci><vector id="S3.E8.m1.6.6.3.3.1.2.cmml" xref="S3.E8.m1.6.6.3.3.1.1"><apply id="S3.E8.m1.6.6.3.3.1.1.1.cmml" xref="S3.E8.m1.6.6.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.3.3.1.1.1.1.cmml" xref="S3.E8.m1.6.6.3.3.1.1.1">subscript</csymbol><ci id="S3.E8.m1.6.6.3.3.1.1.1.2.cmml" xref="S3.E8.m1.6.6.3.3.1.1.1.2">𝐙</ci><ci id="S3.E8.m1.6.6.3.3.1.1.1.3a.cmml" xref="S3.E8.m1.6.6.3.3.1.1.1.3"><mtext id="S3.E8.m1.6.6.3.3.1.1.1.3.cmml" mathsize="70%" xref="S3.E8.m1.6.6.3.3.1.1.1.3">img</mtext></ci></apply><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">𝐈</ci><ci id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3">𝜽</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\mathbf{S}=MI(\mathbf{Z}_{\text{img}},\mathbf{Z}_{\text{text}};\boldsymbol{%
\theta})-\beta\times MI(\mathbf{Z}_{\text{img}},\mathbf{I};\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.6d">bold_S = italic_M italic_I ( bold_Z start_POSTSUBSCRIPT img end_POSTSUBSCRIPT , bold_Z start_POSTSUBSCRIPT text end_POSTSUBSCRIPT ; bold_italic_θ ) - italic_β × italic_M italic_I ( bold_Z start_POSTSUBSCRIPT img end_POSTSUBSCRIPT , bold_I ; bold_italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.7">where <math alttext="MI" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m1.1"><semantics id="S3.SS2.p2.4.m1.1a"><mrow id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml"><mi id="S3.SS2.p2.4.m1.1.1.2" xref="S3.SS2.p2.4.m1.1.1.2.cmml">M</mi><mo id="S3.SS2.p2.4.m1.1.1.1" xref="S3.SS2.p2.4.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m1.1.1.3" xref="S3.SS2.p2.4.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><apply id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1"><times id="S3.SS2.p2.4.m1.1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1.1"></times><ci id="S3.SS2.p2.4.m1.1.1.2.cmml" xref="S3.SS2.p2.4.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p2.4.m1.1.1.3.cmml" xref="S3.SS2.p2.4.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">MI</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m1.1d">italic_M italic_I</annotation></semantics></math> is the mutual information operation and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m2.1"><semantics id="S3.SS2.p2.5.m2.1a"><mi id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><ci id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m2.1d">italic_β</annotation></semantics></math> is a hyperparameter that balances the trade-off between
relevance and compression.

<br class="ltx_break"/>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.7.1">K-means Clustering for Initial Segmentation</span>: To generate discrete pixel-wise labels as an initial coarse segmentation, a post-processing step is applied to the saliency map <math alttext="\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m3.1"><semantics id="S3.SS2.p2.6.m3.1a"><mi id="S3.SS2.p2.6.m3.1.1" xref="S3.SS2.p2.6.m3.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m3.1b"><ci id="S3.SS2.p2.6.m3.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m3.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m3.1d">bold_S</annotation></semantics></math>. This includes applying K-means clustering to divide the pixels in <math alttext="\mathbf{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m4.1"><semantics id="S3.SS2.p2.7.m4.1a"><mi id="S3.SS2.p2.7.m4.1.1" xref="S3.SS2.p2.7.m4.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m4.1b"><ci id="S3.SS2.p2.7.m4.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m4.1c">\mathbf{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m4.1d">bold_S</annotation></semantics></math> into two groups: foreground (region of interests) and background:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Y}_{\text{kmeans}}=\mathrm{Kmeans}(\mathbf{S};k=2)" class="ltx_Math" display="block" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><msub id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml"><mi id="S3.E9.m1.3.3.3.2" xref="S3.E9.m1.3.3.3.2.cmml">𝐘</mi><mtext id="S3.E9.m1.3.3.3.3" xref="S3.E9.m1.3.3.3.3a.cmml">kmeans</mtext></msub><mo id="S3.E9.m1.3.3.2" xref="S3.E9.m1.3.3.2.cmml">=</mo><mrow id="S3.E9.m1.3.3.1" xref="S3.E9.m1.3.3.1.cmml"><mi id="S3.E9.m1.3.3.1.3" xref="S3.E9.m1.3.3.1.3.cmml">Kmeans</mi><mo id="S3.E9.m1.3.3.1.2" xref="S3.E9.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.3.3.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.cmml"><mo id="S3.E9.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E9.m1.3.3.1.1.1.1.2.2" xref="S3.E9.m1.3.3.1.1.1.1.2.1.cmml"><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">𝐒</mi><mo id="S3.E9.m1.3.3.1.1.1.1.2.2.1" xref="S3.E9.m1.3.3.1.1.1.1.2.1.cmml">;</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">k</mi></mrow><mo id="S3.E9.m1.3.3.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.cmml">=</mo><mn id="S3.E9.m1.3.3.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.E9.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.2.cmml" xref="S3.E9.m1.3.3.2"></eq><apply id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.2">𝐘</ci><ci id="S3.E9.m1.3.3.3.3a.cmml" xref="S3.E9.m1.3.3.3.3"><mtext id="S3.E9.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E9.m1.3.3.3.3">kmeans</mtext></ci></apply><apply id="S3.E9.m1.3.3.1.cmml" xref="S3.E9.m1.3.3.1"><times id="S3.E9.m1.3.3.1.2.cmml" xref="S3.E9.m1.3.3.1.2"></times><ci id="S3.E9.m1.3.3.1.3.cmml" xref="S3.E9.m1.3.3.1.3">Kmeans</ci><apply id="S3.E9.m1.3.3.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1"><eq id="S3.E9.m1.3.3.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1"></eq><list id="S3.E9.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝐒</ci><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑘</ci></list><cn id="S3.E9.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\mathbf{Y}_{\text{kmeans}}=\mathrm{Kmeans}(\mathbf{S};k=2)</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">bold_Y start_POSTSUBSCRIPT kmeans end_POSTSUBSCRIPT = roman_Kmeans ( bold_S ; italic_k = 2 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.10">This separates high-intensity (salient) regions from the background based on pixel intensity in the saliency map to get clusters <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m1.1"><semantics id="S3.SS2.p2.8.m1.1a"><mi id="S3.SS2.p2.8.m1.1.1" xref="S3.SS2.p2.8.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m1.1b"><ci id="S3.SS2.p2.8.m1.1.1.cmml" xref="S3.SS2.p2.8.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m1.1d">italic_C</annotation></semantics></math>. Afring, small, disconnected regions arusing <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m2.1"><semantics id="S3.SS2.p2.9.m2.1a"><mi id="S3.SS2.p2.9.m2.1.1" xref="S3.SS2.p2.9.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m2.1b"><ci id="S3.SS2.p2.9.m2.1.1.cmml" xref="S3.SS2.p2.9.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m2.1d">italic_A</annotation></semantics></math> to refine the coarse segmentation Specifically, clusters with an area smaller than <math alttext="A" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m3.1"><semantics id="S3.SS2.p2.10.m3.1a"><mi id="S3.SS2.p2.10.m3.1.1" xref="S3.SS2.p2.10.m3.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m3.1b"><ci id="S3.SS2.p2.10.m3.1.1.cmml" xref="S3.SS2.p2.10.m3.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m3.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m3.1d">italic_A</annotation></semantics></math> are filtered out as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Y}_{\text{coarse}}=\{c\in C:\text{Area}(c)&gt;A\}" class="ltx_Math" display="block" id="S3.E10.m1.3"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml"><msub id="S3.E10.m1.3.3.4" xref="S3.E10.m1.3.3.4.cmml"><mi id="S3.E10.m1.3.3.4.2" xref="S3.E10.m1.3.3.4.2.cmml">𝐘</mi><mtext id="S3.E10.m1.3.3.4.3" xref="S3.E10.m1.3.3.4.3a.cmml">coarse</mtext></msub><mo id="S3.E10.m1.3.3.3" xref="S3.E10.m1.3.3.3.cmml">=</mo><mrow id="S3.E10.m1.3.3.2.2" xref="S3.E10.m1.3.3.2.3.cmml"><mo id="S3.E10.m1.3.3.2.2.3" stretchy="false" xref="S3.E10.m1.3.3.2.3.1.cmml">{</mo><mrow id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.2.cmml">c</mi><mo id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml">∈</mo><mi id="S3.E10.m1.2.2.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.3.cmml">C</mi></mrow><mo id="S3.E10.m1.3.3.2.2.4" lspace="0.278em" rspace="0.278em" xref="S3.E10.m1.3.3.2.3.1.cmml">:</mo><mrow id="S3.E10.m1.3.3.2.2.2" xref="S3.E10.m1.3.3.2.2.2.cmml"><mrow id="S3.E10.m1.3.3.2.2.2.2" xref="S3.E10.m1.3.3.2.2.2.2.cmml"><mtext id="S3.E10.m1.3.3.2.2.2.2.2" xref="S3.E10.m1.3.3.2.2.2.2.2a.cmml">Area</mtext><mo id="S3.E10.m1.3.3.2.2.2.2.1" xref="S3.E10.m1.3.3.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.3.3.2.2.2.2.3.2" xref="S3.E10.m1.3.3.2.2.2.2.cmml"><mo id="S3.E10.m1.3.3.2.2.2.2.3.2.1" stretchy="false" xref="S3.E10.m1.3.3.2.2.2.2.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">c</mi><mo id="S3.E10.m1.3.3.2.2.2.2.3.2.2" stretchy="false" xref="S3.E10.m1.3.3.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.3.3.2.2.2.1" xref="S3.E10.m1.3.3.2.2.2.1.cmml">&gt;</mo><mi id="S3.E10.m1.3.3.2.2.2.3" xref="S3.E10.m1.3.3.2.2.2.3.cmml">A</mi></mrow><mo id="S3.E10.m1.3.3.2.2.5" stretchy="false" xref="S3.E10.m1.3.3.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"><eq id="S3.E10.m1.3.3.3.cmml" xref="S3.E10.m1.3.3.3"></eq><apply id="S3.E10.m1.3.3.4.cmml" xref="S3.E10.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.4.1.cmml" xref="S3.E10.m1.3.3.4">subscript</csymbol><ci id="S3.E10.m1.3.3.4.2.cmml" xref="S3.E10.m1.3.3.4.2">𝐘</ci><ci id="S3.E10.m1.3.3.4.3a.cmml" xref="S3.E10.m1.3.3.4.3"><mtext id="S3.E10.m1.3.3.4.3.cmml" mathsize="70%" xref="S3.E10.m1.3.3.4.3">coarse</mtext></ci></apply><apply id="S3.E10.m1.3.3.2.3.cmml" xref="S3.E10.m1.3.3.2.2"><csymbol cd="latexml" id="S3.E10.m1.3.3.2.3.1.cmml" xref="S3.E10.m1.3.3.2.2.3">conditional-set</csymbol><apply id="S3.E10.m1.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1"><in id="S3.E10.m1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1"></in><ci id="S3.E10.m1.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.2">𝑐</ci><ci id="S3.E10.m1.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.3">𝐶</ci></apply><apply id="S3.E10.m1.3.3.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2"><gt id="S3.E10.m1.3.3.2.2.2.1.cmml" xref="S3.E10.m1.3.3.2.2.2.1"></gt><apply id="S3.E10.m1.3.3.2.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2.2"><times id="S3.E10.m1.3.3.2.2.2.2.1.cmml" xref="S3.E10.m1.3.3.2.2.2.2.1"></times><ci id="S3.E10.m1.3.3.2.2.2.2.2a.cmml" xref="S3.E10.m1.3.3.2.2.2.2.2"><mtext id="S3.E10.m1.3.3.2.2.2.2.2.cmml" xref="S3.E10.m1.3.3.2.2.2.2.2">Area</mtext></ci><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑐</ci></apply><ci id="S3.E10.m1.3.3.2.2.2.3.cmml" xref="S3.E10.m1.3.3.2.2.2.3">𝐴</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">\mathbf{Y}_{\text{coarse}}=\{c\in C:\text{Area}(c)&gt;A\}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.3d">bold_Y start_POSTSUBSCRIPT coarse end_POSTSUBSCRIPT = { italic_c ∈ italic_C : Area ( italic_c ) &gt; italic_A }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<br class="ltx_break"/>
<p class="ltx_p" id="S3.SS2.p2.12"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.12.1">Segmentation Refinement via SAM</span>: The initial segmentation is used as input to the Segment Anything Model, which refines the segmentation by taking visual prompts <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS2.p2.11.m1.1"><semantics id="S3.SS2.p2.11.m1.1a"><mi id="S3.SS2.p2.11.m1.1.1" xref="S3.SS2.p2.11.m1.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m1.1b"><ci id="S3.SS2.p2.11.m1.1.1.cmml" xref="S3.SS2.p2.11.m1.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m1.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.11.m1.1d">bold_V</annotation></semantics></math> (e.g., bounding boxes or points) derived from the post-processed clusters. For bounding boxes, we calculate 4 box coordinates (bounding boxes) that enclose each connected contour in the coarse segmentation, while for points, we randomly sample different points that lie within the contour. The final zero-shot segmentation mask <math alttext="\mathbf{Y}_{\text{zero-shot}}" class="ltx_Math" display="inline" id="S3.SS2.p2.12.m2.1"><semantics id="S3.SS2.p2.12.m2.1a"><msub id="S3.SS2.p2.12.m2.1.1" xref="S3.SS2.p2.12.m2.1.1.cmml"><mi id="S3.SS2.p2.12.m2.1.1.2" xref="S3.SS2.p2.12.m2.1.1.2.cmml">𝐘</mi><mtext id="S3.SS2.p2.12.m2.1.1.3" xref="S3.SS2.p2.12.m2.1.1.3a.cmml">zero-shot</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m2.1b"><apply id="S3.SS2.p2.12.m2.1.1.cmml" xref="S3.SS2.p2.12.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m2.1.1.1.cmml" xref="S3.SS2.p2.12.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.12.m2.1.1.2.cmml" xref="S3.SS2.p2.12.m2.1.1.2">𝐘</ci><ci id="S3.SS2.p2.12.m2.1.1.3a.cmml" xref="S3.SS2.p2.12.m2.1.1.3"><mtext id="S3.SS2.p2.12.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p2.12.m2.1.1.3">zero-shot</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m2.1c">\mathbf{Y}_{\text{zero-shot}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.12.m2.1d">bold_Y start_POSTSUBSCRIPT zero-shot end_POSTSUBSCRIPT</annotation></semantics></math> is thus produced as:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Y}_{\text{zero-shot}}=\textit{SAM}(\mathbf{Y}_{\text{coarse}};\mathbf{%
V})" class="ltx_Math" display="block" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml"><msub id="S3.E11.m1.2.2.3" xref="S3.E11.m1.2.2.3.cmml"><mi id="S3.E11.m1.2.2.3.2" xref="S3.E11.m1.2.2.3.2.cmml">𝐘</mi><mtext id="S3.E11.m1.2.2.3.3" xref="S3.E11.m1.2.2.3.3a.cmml">zero-shot</mtext></msub><mo id="S3.E11.m1.2.2.2" xref="S3.E11.m1.2.2.2.cmml">=</mo><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E11.m1.2.2.1.3" xref="S3.E11.m1.2.2.1.3a.cmml">SAM</mtext><mo id="S3.E11.m1.2.2.1.2" xref="S3.E11.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1" xref="S3.E11.m1.2.2.1.1.2.cmml"><mo id="S3.E11.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.E11.m1.2.2.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.2.cmml">𝐘</mi><mtext id="S3.E11.m1.2.2.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.3a.cmml">coarse</mtext></msub><mo id="S3.E11.m1.2.2.1.1.1.3" xref="S3.E11.m1.2.2.1.1.2.cmml">;</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐕</mi><mo id="S3.E11.m1.2.2.1.1.1.4" stretchy="false" xref="S3.E11.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2"><eq id="S3.E11.m1.2.2.2.cmml" xref="S3.E11.m1.2.2.2"></eq><apply id="S3.E11.m1.2.2.3.cmml" xref="S3.E11.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.3.1.cmml" xref="S3.E11.m1.2.2.3">subscript</csymbol><ci id="S3.E11.m1.2.2.3.2.cmml" xref="S3.E11.m1.2.2.3.2">𝐘</ci><ci id="S3.E11.m1.2.2.3.3a.cmml" xref="S3.E11.m1.2.2.3.3"><mtext id="S3.E11.m1.2.2.3.3.cmml" mathsize="70%" xref="S3.E11.m1.2.2.3.3">zero-shot</mtext></ci></apply><apply id="S3.E11.m1.2.2.1.cmml" xref="S3.E11.m1.2.2.1"><times id="S3.E11.m1.2.2.1.2.cmml" xref="S3.E11.m1.2.2.1.2"></times><ci id="S3.E11.m1.2.2.1.3a.cmml" xref="S3.E11.m1.2.2.1.3"><mtext class="ltx_mathvariant_italic" id="S3.E11.m1.2.2.1.3.cmml" xref="S3.E11.m1.2.2.1.3">SAM</mtext></ci><list id="S3.E11.m1.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1"><apply id="S3.E11.m1.2.2.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.2">𝐘</ci><ci id="S3.E11.m1.2.2.1.1.1.1.3a.cmml" xref="S3.E11.m1.2.2.1.1.1.1.3"><mtext id="S3.E11.m1.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E11.m1.2.2.1.1.1.1.3">coarse</mtext></ci></apply><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐕</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\mathbf{Y}_{\text{zero-shot}}=\textit{SAM}(\mathbf{Y}_{\text{coarse}};\mathbf{%
V})</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">bold_Y start_POSTSUBSCRIPT zero-shot end_POSTSUBSCRIPT = SAM ( bold_Y start_POSTSUBSCRIPT coarse end_POSTSUBSCRIPT ; bold_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.11"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.11.1">Weakly Supervised Training with Pseudo-labels</span>: To further enhance the segmentation accuracy, the zero-shot segmentation results <math alttext="\mathbf{Y}_{\text{zero-shot}}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">𝐘</mi><mtext id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3a.cmml">zero-shot</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝐘</ci><ci id="S3.SS2.p4.1.m1.1.1.3a.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><mtext id="S3.SS2.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.1.m1.1.1.3">zero-shot</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathbf{Y}_{\text{zero-shot}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">bold_Y start_POSTSUBSCRIPT zero-shot end_POSTSUBSCRIPT</annotation></semantics></math> are then used as pseudo-labels with the input medical images <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">bold_I</annotation></semantics></math> to train a segmentation network <math alttext="\mathbf{M}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">bold_M</annotation></semantics></math> in a weakly supervised manner. Thus, the training data will be <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">caligraphic_T</annotation></semantics></math> = <math alttext="\{(\mathbf{I},\mathbf{Y}_{\text{zero-shot}})\}" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.2"><semantics id="S3.SS2.p4.5.m5.2a"><mrow id="S3.SS2.p4.5.m5.2.2.1" xref="S3.SS2.p4.5.m5.2.2.2.cmml"><mo id="S3.SS2.p4.5.m5.2.2.1.2" stretchy="false" xref="S3.SS2.p4.5.m5.2.2.2.cmml">{</mo><mrow id="S3.SS2.p4.5.m5.2.2.1.1.1" xref="S3.SS2.p4.5.m5.2.2.1.1.2.cmml"><mo id="S3.SS2.p4.5.m5.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.p4.5.m5.2.2.1.1.2.cmml">(</mo><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">𝐈</mi><mo id="S3.SS2.p4.5.m5.2.2.1.1.1.3" xref="S3.SS2.p4.5.m5.2.2.1.1.2.cmml">,</mo><msub id="S3.SS2.p4.5.m5.2.2.1.1.1.1" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p4.5.m5.2.2.1.1.1.1.2" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.2.cmml">𝐘</mi><mtext id="S3.SS2.p4.5.m5.2.2.1.1.1.1.3" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.3a.cmml">zero-shot</mtext></msub><mo id="S3.SS2.p4.5.m5.2.2.1.1.1.4" stretchy="false" xref="S3.SS2.p4.5.m5.2.2.1.1.2.cmml">)</mo></mrow><mo id="S3.SS2.p4.5.m5.2.2.1.3" stretchy="false" xref="S3.SS2.p4.5.m5.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.2b"><set id="S3.SS2.p4.5.m5.2.2.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1"><interval closure="open" id="S3.SS2.p4.5.m5.2.2.1.1.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝐈</ci><apply id="S3.SS2.p4.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.2">𝐘</ci><ci id="S3.SS2.p4.5.m5.2.2.1.1.1.1.3a.cmml" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.3"><mtext id="S3.SS2.p4.5.m5.2.2.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.5.m5.2.2.1.1.1.1.3">zero-shot</mtext></ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.2c">\{(\mathbf{I},\mathbf{Y}_{\text{zero-shot}})\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.2d">{ ( bold_I , bold_Y start_POSTSUBSCRIPT zero-shot end_POSTSUBSCRIPT ) }</annotation></semantics></math>. Building on the recent work by Zhao <span class="ltx_text ltx_font_italic" id="S3.SS2.p4.11.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib25" title="">25</a>]</cite>, checkpoint ensembling has demonstrated superior effectiveness in uncertainty estimation for medical image segmentation when compared to techniques such as Monte Carlo Dropout and mean-field Bayesian Neural Networks. This finding is particularly relevant in the context of the nnUNet framework <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib24" title="">24</a>]</cite>. Given a total number of epochs <math alttext="E" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_E</annotation></semantics></math>, the training process is divided into <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">italic_D</annotation></semantics></math> cycles composed of <math alttext="E_{d}=\frac{E}{D}" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><mrow id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml"><msub id="S3.SS2.p4.8.m8.1.1.2" xref="S3.SS2.p4.8.m8.1.1.2.cmml"><mi id="S3.SS2.p4.8.m8.1.1.2.2" xref="S3.SS2.p4.8.m8.1.1.2.2.cmml">E</mi><mi id="S3.SS2.p4.8.m8.1.1.2.3" xref="S3.SS2.p4.8.m8.1.1.2.3.cmml">d</mi></msub><mo id="S3.SS2.p4.8.m8.1.1.1" xref="S3.SS2.p4.8.m8.1.1.1.cmml">=</mo><mfrac id="S3.SS2.p4.8.m8.1.1.3" xref="S3.SS2.p4.8.m8.1.1.3.cmml"><mi id="S3.SS2.p4.8.m8.1.1.3.2" xref="S3.SS2.p4.8.m8.1.1.3.2.cmml">E</mi><mi id="S3.SS2.p4.8.m8.1.1.3.3" xref="S3.SS2.p4.8.m8.1.1.3.3.cmml">D</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><apply id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1"><eq id="S3.SS2.p4.8.m8.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1.1"></eq><apply id="S3.SS2.p4.8.m8.1.1.2.cmml" xref="S3.SS2.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.1.2.1.cmml" xref="S3.SS2.p4.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.8.m8.1.1.2.2.cmml" xref="S3.SS2.p4.8.m8.1.1.2.2">𝐸</ci><ci id="S3.SS2.p4.8.m8.1.1.2.3.cmml" xref="S3.SS2.p4.8.m8.1.1.2.3">𝑑</ci></apply><apply id="S3.SS2.p4.8.m8.1.1.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3"><divide id="S3.SS2.p4.8.m8.1.1.3.1.cmml" xref="S3.SS2.p4.8.m8.1.1.3"></divide><ci id="S3.SS2.p4.8.m8.1.1.3.2.cmml" xref="S3.SS2.p4.8.m8.1.1.3.2">𝐸</ci><ci id="S3.SS2.p4.8.m8.1.1.3.3.cmml" xref="S3.SS2.p4.8.m8.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">E_{d}=\frac{E}{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">italic_E start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = divide start_ARG italic_E end_ARG start_ARG italic_D end_ARG</annotation></semantics></math> epochs, and during each cycle, we save <math alttext="G_{d}" class="ltx_Math" display="inline" id="S3.SS2.p4.9.m9.1"><semantics id="S3.SS2.p4.9.m9.1a"><msub id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml"><mi id="S3.SS2.p4.9.m9.1.1.2" xref="S3.SS2.p4.9.m9.1.1.2.cmml">G</mi><mi id="S3.SS2.p4.9.m9.1.1.3" xref="S3.SS2.p4.9.m9.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><apply id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m9.1.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p4.9.m9.1.1.2.cmml" xref="S3.SS2.p4.9.m9.1.1.2">𝐺</ci><ci id="S3.SS2.p4.9.m9.1.1.3.cmml" xref="S3.SS2.p4.9.m9.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">G_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m9.1d">italic_G start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> checkpoints of the model. After completing all training cycles, the probabilistic prediction of the final segmentation <math alttext="\mathbf{Y}_{\text{final}}" class="ltx_Math" display="inline" id="S3.SS2.p4.10.m10.1"><semantics id="S3.SS2.p4.10.m10.1a"><msub id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml"><mi id="S3.SS2.p4.10.m10.1.1.2" xref="S3.SS2.p4.10.m10.1.1.2.cmml">𝐘</mi><mtext id="S3.SS2.p4.10.m10.1.1.3" xref="S3.SS2.p4.10.m10.1.1.3a.cmml">final</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><apply id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.10.m10.1.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p4.10.m10.1.1.2.cmml" xref="S3.SS2.p4.10.m10.1.1.2">𝐘</ci><ci id="S3.SS2.p4.10.m10.1.1.3a.cmml" xref="S3.SS2.p4.10.m10.1.1.3"><mtext id="S3.SS2.p4.10.m10.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.10.m10.1.1.3">final</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">\mathbf{Y}_{\text{final}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m10.1d">bold_Y start_POSTSUBSCRIPT final end_POSTSUBSCRIPT</annotation></semantics></math> is obtained by averaging the predictions from the <math alttext="G=D*G_{d}" class="ltx_Math" display="inline" id="S3.SS2.p4.11.m11.1"><semantics id="S3.SS2.p4.11.m11.1a"><mrow id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml"><mi id="S3.SS2.p4.11.m11.1.1.2" xref="S3.SS2.p4.11.m11.1.1.2.cmml">G</mi><mo id="S3.SS2.p4.11.m11.1.1.1" xref="S3.SS2.p4.11.m11.1.1.1.cmml">=</mo><mrow id="S3.SS2.p4.11.m11.1.1.3" xref="S3.SS2.p4.11.m11.1.1.3.cmml"><mi id="S3.SS2.p4.11.m11.1.1.3.2" xref="S3.SS2.p4.11.m11.1.1.3.2.cmml">D</mi><mo id="S3.SS2.p4.11.m11.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.11.m11.1.1.3.1.cmml">∗</mo><msub id="S3.SS2.p4.11.m11.1.1.3.3" xref="S3.SS2.p4.11.m11.1.1.3.3.cmml"><mi id="S3.SS2.p4.11.m11.1.1.3.3.2" xref="S3.SS2.p4.11.m11.1.1.3.3.2.cmml">G</mi><mi id="S3.SS2.p4.11.m11.1.1.3.3.3" xref="S3.SS2.p4.11.m11.1.1.3.3.3.cmml">d</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><apply id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1"><eq id="S3.SS2.p4.11.m11.1.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1.1"></eq><ci id="S3.SS2.p4.11.m11.1.1.2.cmml" xref="S3.SS2.p4.11.m11.1.1.2">𝐺</ci><apply id="S3.SS2.p4.11.m11.1.1.3.cmml" xref="S3.SS2.p4.11.m11.1.1.3"><times id="S3.SS2.p4.11.m11.1.1.3.1.cmml" xref="S3.SS2.p4.11.m11.1.1.3.1"></times><ci id="S3.SS2.p4.11.m11.1.1.3.2.cmml" xref="S3.SS2.p4.11.m11.1.1.3.2">𝐷</ci><apply id="S3.SS2.p4.11.m11.1.1.3.3.cmml" xref="S3.SS2.p4.11.m11.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.11.m11.1.1.3.3.1.cmml" xref="S3.SS2.p4.11.m11.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p4.11.m11.1.1.3.3.2.cmml" xref="S3.SS2.p4.11.m11.1.1.3.3.2">𝐺</ci><ci id="S3.SS2.p4.11.m11.1.1.3.3.3.cmml" xref="S3.SS2.p4.11.m11.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">G=D*G_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m11.1d">italic_G = italic_D ∗ italic_G start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> total checkpoints saved during the training process providing a Monte-Carlo approximation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(\mathbf{Y}_{\text{final}}|\mathbf{X};\mathcal{T})\approx\frac{1}{G}\sum_{n=1%
}^{G}p(\mathbf{Y}_{\text{final}}|\mathbf{X};\mathbf{M}_{n})" class="ltx_Math" display="block" id="S3.E12.m1.5"><semantics id="S3.E12.m1.5a"><mrow id="S3.E12.m1.5.5" xref="S3.E12.m1.5.5.cmml"><mrow id="S3.E12.m1.4.4.1" xref="S3.E12.m1.4.4.1.cmml"><mi id="S3.E12.m1.4.4.1.3" xref="S3.E12.m1.4.4.1.3.cmml">p</mi><mo id="S3.E12.m1.4.4.1.2" xref="S3.E12.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.4.4.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.cmml"><mo id="S3.E12.m1.4.4.1.1.1.2" stretchy="false" xref="S3.E12.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.4.4.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.cmml"><msub id="S3.E12.m1.4.4.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E12.m1.4.4.1.1.1.1.2.2" xref="S3.E12.m1.4.4.1.1.1.1.2.2.cmml">𝐘</mi><mtext id="S3.E12.m1.4.4.1.1.1.1.2.3" xref="S3.E12.m1.4.4.1.1.1.1.2.3a.cmml">final</mtext></msub><mo fence="false" id="S3.E12.m1.4.4.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.cmml">|</mo><mrow id="S3.E12.m1.4.4.1.1.1.1.3.2" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml"><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">𝐗</mi><mo id="S3.E12.m1.4.4.1.1.1.1.3.2.1" xref="S3.E12.m1.4.4.1.1.1.1.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">𝒯</mi></mrow></mrow><mo id="S3.E12.m1.4.4.1.1.1.3" stretchy="false" xref="S3.E12.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.5.5.3" xref="S3.E12.m1.5.5.3.cmml">≈</mo><mrow id="S3.E12.m1.5.5.2" xref="S3.E12.m1.5.5.2.cmml"><mfrac id="S3.E12.m1.5.5.2.3" xref="S3.E12.m1.5.5.2.3.cmml"><mn id="S3.E12.m1.5.5.2.3.2" xref="S3.E12.m1.5.5.2.3.2.cmml">1</mn><mi id="S3.E12.m1.5.5.2.3.3" xref="S3.E12.m1.5.5.2.3.3.cmml">G</mi></mfrac><mo id="S3.E12.m1.5.5.2.2" xref="S3.E12.m1.5.5.2.2.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.2.1" xref="S3.E12.m1.5.5.2.1.cmml"><munderover id="S3.E12.m1.5.5.2.1.2" xref="S3.E12.m1.5.5.2.1.2.cmml"><mo id="S3.E12.m1.5.5.2.1.2.2.2" movablelimits="false" xref="S3.E12.m1.5.5.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E12.m1.5.5.2.1.2.2.3" xref="S3.E12.m1.5.5.2.1.2.2.3.cmml"><mi id="S3.E12.m1.5.5.2.1.2.2.3.2" xref="S3.E12.m1.5.5.2.1.2.2.3.2.cmml">n</mi><mo id="S3.E12.m1.5.5.2.1.2.2.3.1" xref="S3.E12.m1.5.5.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E12.m1.5.5.2.1.2.2.3.3" xref="S3.E12.m1.5.5.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.5.5.2.1.2.3" xref="S3.E12.m1.5.5.2.1.2.3.cmml">G</mi></munderover><mrow id="S3.E12.m1.5.5.2.1.1" xref="S3.E12.m1.5.5.2.1.1.cmml"><mi id="S3.E12.m1.5.5.2.1.1.3" xref="S3.E12.m1.5.5.2.1.1.3.cmml">p</mi><mo id="S3.E12.m1.5.5.2.1.1.2" xref="S3.E12.m1.5.5.2.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.5.5.2.1.1.1.1" xref="S3.E12.m1.5.5.2.1.1.1.1.1.cmml"><mo id="S3.E12.m1.5.5.2.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.5.5.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.5.5.2.1.1.1.1.1" xref="S3.E12.m1.5.5.2.1.1.1.1.1.cmml"><msub id="S3.E12.m1.5.5.2.1.1.1.1.1.3" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.5.5.2.1.1.1.1.1.3.2" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.2.cmml">𝐘</mi><mtext id="S3.E12.m1.5.5.2.1.1.1.1.1.3.3" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.3a.cmml">final</mtext></msub><mo fence="false" id="S3.E12.m1.5.5.2.1.1.1.1.1.2" xref="S3.E12.m1.5.5.2.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3" xref="S3.E12.m1.3.3.cmml">𝐗</mi><mo id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.2.cmml">;</mo><msub id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.2.cmml">𝐌</mi><mi id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub></mrow></mrow><mo id="S3.E12.m1.5.5.2.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.5.5.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.5b"><apply id="S3.E12.m1.5.5.cmml" xref="S3.E12.m1.5.5"><approx id="S3.E12.m1.5.5.3.cmml" xref="S3.E12.m1.5.5.3"></approx><apply id="S3.E12.m1.4.4.1.cmml" xref="S3.E12.m1.4.4.1"><times id="S3.E12.m1.4.4.1.2.cmml" xref="S3.E12.m1.4.4.1.2"></times><ci id="S3.E12.m1.4.4.1.3.cmml" xref="S3.E12.m1.4.4.1.3">𝑝</ci><apply id="S3.E12.m1.4.4.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.4.4.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S3.E12.m1.4.4.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.2.2">𝐘</ci><ci id="S3.E12.m1.4.4.1.1.1.1.2.3a.cmml" xref="S3.E12.m1.4.4.1.1.1.1.2.3"><mtext id="S3.E12.m1.4.4.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E12.m1.4.4.1.1.1.1.2.3">final</mtext></ci></apply><list id="S3.E12.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.3.2"><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">𝐗</ci><ci id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">𝒯</ci></list></apply></apply><apply id="S3.E12.m1.5.5.2.cmml" xref="S3.E12.m1.5.5.2"><times id="S3.E12.m1.5.5.2.2.cmml" xref="S3.E12.m1.5.5.2.2"></times><apply id="S3.E12.m1.5.5.2.3.cmml" xref="S3.E12.m1.5.5.2.3"><divide id="S3.E12.m1.5.5.2.3.1.cmml" xref="S3.E12.m1.5.5.2.3"></divide><cn id="S3.E12.m1.5.5.2.3.2.cmml" type="integer" xref="S3.E12.m1.5.5.2.3.2">1</cn><ci id="S3.E12.m1.5.5.2.3.3.cmml" xref="S3.E12.m1.5.5.2.3.3">𝐺</ci></apply><apply id="S3.E12.m1.5.5.2.1.cmml" xref="S3.E12.m1.5.5.2.1"><apply id="S3.E12.m1.5.5.2.1.2.cmml" xref="S3.E12.m1.5.5.2.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.2.1.2.1.cmml" xref="S3.E12.m1.5.5.2.1.2">superscript</csymbol><apply id="S3.E12.m1.5.5.2.1.2.2.cmml" xref="S3.E12.m1.5.5.2.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.2.1.2.2.1.cmml" xref="S3.E12.m1.5.5.2.1.2">subscript</csymbol><sum id="S3.E12.m1.5.5.2.1.2.2.2.cmml" xref="S3.E12.m1.5.5.2.1.2.2.2"></sum><apply id="S3.E12.m1.5.5.2.1.2.2.3.cmml" xref="S3.E12.m1.5.5.2.1.2.2.3"><eq id="S3.E12.m1.5.5.2.1.2.2.3.1.cmml" xref="S3.E12.m1.5.5.2.1.2.2.3.1"></eq><ci id="S3.E12.m1.5.5.2.1.2.2.3.2.cmml" xref="S3.E12.m1.5.5.2.1.2.2.3.2">𝑛</ci><cn id="S3.E12.m1.5.5.2.1.2.2.3.3.cmml" type="integer" xref="S3.E12.m1.5.5.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.5.5.2.1.2.3.cmml" xref="S3.E12.m1.5.5.2.1.2.3">𝐺</ci></apply><apply id="S3.E12.m1.5.5.2.1.1.cmml" xref="S3.E12.m1.5.5.2.1.1"><times id="S3.E12.m1.5.5.2.1.1.2.cmml" xref="S3.E12.m1.5.5.2.1.1.2"></times><ci id="S3.E12.m1.5.5.2.1.1.3.cmml" xref="S3.E12.m1.5.5.2.1.1.3">𝑝</ci><apply id="S3.E12.m1.5.5.2.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E12.m1.5.5.2.1.1.1.1.1.3.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.2.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.5.5.2.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.2">𝐘</ci><ci id="S3.E12.m1.5.5.2.1.1.1.1.1.3.3a.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.3"><mtext id="S3.E12.m1.5.5.2.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E12.m1.5.5.2.1.1.1.1.1.3.3">final</mtext></ci></apply><list id="S3.E12.m1.5.5.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1"><ci id="S3.E12.m1.3.3.cmml" xref="S3.E12.m1.3.3">𝐗</ci><apply id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.2">𝐌</ci><ci id="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.5.5.2.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.5c">p(\mathbf{Y}_{\text{final}}|\mathbf{X};\mathcal{T})\approx\frac{1}{G}\sum_{n=1%
}^{G}p(\mathbf{Y}_{\text{final}}|\mathbf{X};\mathbf{M}_{n})</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.5d">italic_p ( bold_Y start_POSTSUBSCRIPT final end_POSTSUBSCRIPT | bold_X ; caligraphic_T ) ≈ divide start_ARG 1 end_ARG start_ARG italic_G end_ARG ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT italic_p ( bold_Y start_POSTSUBSCRIPT final end_POSTSUBSCRIPT | bold_X ; bold_M start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.16">where <math alttext="\mathbf{M}_{n}" class="ltx_Math" display="inline" id="S3.SS2.p4.12.m1.1"><semantics id="S3.SS2.p4.12.m1.1a"><msub id="S3.SS2.p4.12.m1.1.1" xref="S3.SS2.p4.12.m1.1.1.cmml"><mi id="S3.SS2.p4.12.m1.1.1.2" xref="S3.SS2.p4.12.m1.1.1.2.cmml">𝐌</mi><mi id="S3.SS2.p4.12.m1.1.1.3" xref="S3.SS2.p4.12.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m1.1b"><apply id="S3.SS2.p4.12.m1.1.1.cmml" xref="S3.SS2.p4.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.12.m1.1.1.1.cmml" xref="S3.SS2.p4.12.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.12.m1.1.1.2.cmml" xref="S3.SS2.p4.12.m1.1.1.2">𝐌</ci><ci id="S3.SS2.p4.12.m1.1.1.3.cmml" xref="S3.SS2.p4.12.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m1.1c">\mathbf{M}_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.12.m1.1d">bold_M start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> represents the weights of the model at the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p4.13.m2.1"><semantics id="S3.SS2.p4.13.m2.1a"><mi id="S3.SS2.p4.13.m2.1.1" xref="S3.SS2.p4.13.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.13.m2.1b"><ci id="S3.SS2.p4.13.m2.1.1.cmml" xref="S3.SS2.p4.13.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.13.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.13.m2.1d">italic_n</annotation></semantics></math>-th checkpoint, and <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S3.SS2.p4.14.m3.1"><semantics id="S3.SS2.p4.14.m3.1a"><mi id="S3.SS2.p4.14.m3.1.1" xref="S3.SS2.p4.14.m3.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.14.m3.1b"><ci id="S3.SS2.p4.14.m3.1.1.cmml" xref="S3.SS2.p4.14.m3.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.14.m3.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.14.m3.1d">bold_X</annotation></semantics></math> are unseen testing input images.

<br class="ltx_break"/>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.16.1">Segmentation Uncertainty Estimation</span>:
The variation in predictions across different checkpoints also allows for estimating uncertainty in the final segmentation mask. The generated uncertainty map helps pinpoint regions of the medical scan that exhibit high uncertainty in the prediction. Given <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p4.15.m4.1"><semantics id="S3.SS2.p4.15.m4.1a"><mi id="S3.SS2.p4.15.m4.1.1" xref="S3.SS2.p4.15.m4.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.15.m4.1b"><ci id="S3.SS2.p4.15.m4.1.1.cmml" xref="S3.SS2.p4.15.m4.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.15.m4.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.15.m4.1d">italic_R</annotation></semantics></math> classes in the medical image, the uncertainty for each pixel <math alttext="(i,j)" class="ltx_Math" display="inline" id="S3.SS2.p4.16.m5.2"><semantics id="S3.SS2.p4.16.m5.2a"><mrow id="S3.SS2.p4.16.m5.2.3.2" xref="S3.SS2.p4.16.m5.2.3.1.cmml"><mo id="S3.SS2.p4.16.m5.2.3.2.1" stretchy="false" xref="S3.SS2.p4.16.m5.2.3.1.cmml">(</mo><mi id="S3.SS2.p4.16.m5.1.1" xref="S3.SS2.p4.16.m5.1.1.cmml">i</mi><mo id="S3.SS2.p4.16.m5.2.3.2.2" xref="S3.SS2.p4.16.m5.2.3.1.cmml">,</mo><mi id="S3.SS2.p4.16.m5.2.2" xref="S3.SS2.p4.16.m5.2.2.cmml">j</mi><mo id="S3.SS2.p4.16.m5.2.3.2.3" stretchy="false" xref="S3.SS2.p4.16.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.16.m5.2b"><interval closure="open" id="S3.SS2.p4.16.m5.2.3.1.cmml" xref="S3.SS2.p4.16.m5.2.3.2"><ci id="S3.SS2.p4.16.m5.1.1.cmml" xref="S3.SS2.p4.16.m5.1.1">𝑖</ci><ci id="S3.SS2.p4.16.m5.2.2.cmml" xref="S3.SS2.p4.16.m5.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.16.m5.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.16.m5.2d">( italic_i , italic_j )</annotation></semantics></math> can be computed by calculating the entropy as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H(\mathbf{Y}_{\text{final},{(i,j)}})=-\sum_{r=1}^{R}h(r)\log h(r)" class="ltx_Math" display="block" id="S3.E13.m1.7"><semantics id="S3.E13.m1.7a"><mrow id="S3.E13.m1.7.7" xref="S3.E13.m1.7.7.cmml"><mrow id="S3.E13.m1.7.7.1" xref="S3.E13.m1.7.7.1.cmml"><mi id="S3.E13.m1.7.7.1.3" xref="S3.E13.m1.7.7.1.3.cmml">H</mi><mo id="S3.E13.m1.7.7.1.2" xref="S3.E13.m1.7.7.1.2.cmml">⁢</mo><mrow id="S3.E13.m1.7.7.1.1.1" xref="S3.E13.m1.7.7.1.1.1.1.cmml"><mo id="S3.E13.m1.7.7.1.1.1.2" stretchy="false" xref="S3.E13.m1.7.7.1.1.1.1.cmml">(</mo><msub id="S3.E13.m1.7.7.1.1.1.1" xref="S3.E13.m1.7.7.1.1.1.1.cmml"><mi id="S3.E13.m1.7.7.1.1.1.1.2" xref="S3.E13.m1.7.7.1.1.1.1.2.cmml">𝐘</mi><mrow id="S3.E13.m1.4.4.4.4" xref="S3.E13.m1.4.4.4.5.cmml"><mtext id="S3.E13.m1.3.3.3.3" xref="S3.E13.m1.3.3.3.3a.cmml">final</mtext><mo id="S3.E13.m1.4.4.4.4.2" xref="S3.E13.m1.4.4.4.5.cmml">,</mo><mrow id="S3.E13.m1.4.4.4.4.1.2" xref="S3.E13.m1.4.4.4.4.1.1.cmml"><mo id="S3.E13.m1.4.4.4.4.1.2.1" stretchy="false" xref="S3.E13.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">i</mi><mo id="S3.E13.m1.4.4.4.4.1.2.2" xref="S3.E13.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.2.cmml">j</mi><mo id="S3.E13.m1.4.4.4.4.1.2.3" stretchy="false" xref="S3.E13.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E13.m1.7.7.1.1.1.3" stretchy="false" xref="S3.E13.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.7.7.2" xref="S3.E13.m1.7.7.2.cmml">=</mo><mrow id="S3.E13.m1.7.7.3" xref="S3.E13.m1.7.7.3.cmml"><mo id="S3.E13.m1.7.7.3a" xref="S3.E13.m1.7.7.3.cmml">−</mo><mrow id="S3.E13.m1.7.7.3.2" xref="S3.E13.m1.7.7.3.2.cmml"><munderover id="S3.E13.m1.7.7.3.2.1" xref="S3.E13.m1.7.7.3.2.1.cmml"><mo id="S3.E13.m1.7.7.3.2.1.2.2" movablelimits="false" xref="S3.E13.m1.7.7.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E13.m1.7.7.3.2.1.2.3" xref="S3.E13.m1.7.7.3.2.1.2.3.cmml"><mi id="S3.E13.m1.7.7.3.2.1.2.3.2" xref="S3.E13.m1.7.7.3.2.1.2.3.2.cmml">r</mi><mo id="S3.E13.m1.7.7.3.2.1.2.3.1" xref="S3.E13.m1.7.7.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E13.m1.7.7.3.2.1.2.3.3" xref="S3.E13.m1.7.7.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m1.7.7.3.2.1.3" xref="S3.E13.m1.7.7.3.2.1.3.cmml">R</mi></munderover><mrow id="S3.E13.m1.7.7.3.2.2" xref="S3.E13.m1.7.7.3.2.2.cmml"><mi id="S3.E13.m1.7.7.3.2.2.2" xref="S3.E13.m1.7.7.3.2.2.2.cmml">h</mi><mo id="S3.E13.m1.7.7.3.2.2.1" xref="S3.E13.m1.7.7.3.2.2.1.cmml">⁢</mo><mrow id="S3.E13.m1.7.7.3.2.2.3.2" xref="S3.E13.m1.7.7.3.2.2.cmml"><mo id="S3.E13.m1.7.7.3.2.2.3.2.1" stretchy="false" xref="S3.E13.m1.7.7.3.2.2.cmml">(</mo><mi id="S3.E13.m1.5.5" xref="S3.E13.m1.5.5.cmml">r</mi><mo id="S3.E13.m1.7.7.3.2.2.3.2.2" stretchy="false" xref="S3.E13.m1.7.7.3.2.2.cmml">)</mo></mrow><mo id="S3.E13.m1.7.7.3.2.2.1a" lspace="0.167em" xref="S3.E13.m1.7.7.3.2.2.1.cmml">⁢</mo><mrow id="S3.E13.m1.7.7.3.2.2.4" xref="S3.E13.m1.7.7.3.2.2.4.cmml"><mi id="S3.E13.m1.7.7.3.2.2.4.1" xref="S3.E13.m1.7.7.3.2.2.4.1.cmml">log</mi><mo id="S3.E13.m1.7.7.3.2.2.4a" lspace="0.167em" xref="S3.E13.m1.7.7.3.2.2.4.cmml">⁡</mo><mi id="S3.E13.m1.7.7.3.2.2.4.2" xref="S3.E13.m1.7.7.3.2.2.4.2.cmml">h</mi></mrow><mo id="S3.E13.m1.7.7.3.2.2.1b" xref="S3.E13.m1.7.7.3.2.2.1.cmml">⁢</mo><mrow id="S3.E13.m1.7.7.3.2.2.5.2" xref="S3.E13.m1.7.7.3.2.2.cmml"><mo id="S3.E13.m1.7.7.3.2.2.5.2.1" stretchy="false" xref="S3.E13.m1.7.7.3.2.2.cmml">(</mo><mi id="S3.E13.m1.6.6" xref="S3.E13.m1.6.6.cmml">r</mi><mo id="S3.E13.m1.7.7.3.2.2.5.2.2" stretchy="false" xref="S3.E13.m1.7.7.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.7b"><apply id="S3.E13.m1.7.7.cmml" xref="S3.E13.m1.7.7"><eq id="S3.E13.m1.7.7.2.cmml" xref="S3.E13.m1.7.7.2"></eq><apply id="S3.E13.m1.7.7.1.cmml" xref="S3.E13.m1.7.7.1"><times id="S3.E13.m1.7.7.1.2.cmml" xref="S3.E13.m1.7.7.1.2"></times><ci id="S3.E13.m1.7.7.1.3.cmml" xref="S3.E13.m1.7.7.1.3">𝐻</ci><apply id="S3.E13.m1.7.7.1.1.1.1.cmml" xref="S3.E13.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.7.7.1.1.1.1.1.cmml" xref="S3.E13.m1.7.7.1.1.1">subscript</csymbol><ci id="S3.E13.m1.7.7.1.1.1.1.2.cmml" xref="S3.E13.m1.7.7.1.1.1.1.2">𝐘</ci><list id="S3.E13.m1.4.4.4.5.cmml" xref="S3.E13.m1.4.4.4.4"><ci id="S3.E13.m1.3.3.3.3a.cmml" xref="S3.E13.m1.3.3.3.3"><mtext id="S3.E13.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E13.m1.3.3.3.3">final</mtext></ci><interval closure="open" id="S3.E13.m1.4.4.4.4.1.1.cmml" xref="S3.E13.m1.4.4.4.4.1.2"><ci id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1">𝑖</ci><ci id="S3.E13.m1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2">𝑗</ci></interval></list></apply></apply><apply id="S3.E13.m1.7.7.3.cmml" xref="S3.E13.m1.7.7.3"><minus id="S3.E13.m1.7.7.3.1.cmml" xref="S3.E13.m1.7.7.3"></minus><apply id="S3.E13.m1.7.7.3.2.cmml" xref="S3.E13.m1.7.7.3.2"><apply id="S3.E13.m1.7.7.3.2.1.cmml" xref="S3.E13.m1.7.7.3.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.7.7.3.2.1.1.cmml" xref="S3.E13.m1.7.7.3.2.1">superscript</csymbol><apply id="S3.E13.m1.7.7.3.2.1.2.cmml" xref="S3.E13.m1.7.7.3.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.7.7.3.2.1.2.1.cmml" xref="S3.E13.m1.7.7.3.2.1">subscript</csymbol><sum id="S3.E13.m1.7.7.3.2.1.2.2.cmml" xref="S3.E13.m1.7.7.3.2.1.2.2"></sum><apply id="S3.E13.m1.7.7.3.2.1.2.3.cmml" xref="S3.E13.m1.7.7.3.2.1.2.3"><eq id="S3.E13.m1.7.7.3.2.1.2.3.1.cmml" xref="S3.E13.m1.7.7.3.2.1.2.3.1"></eq><ci id="S3.E13.m1.7.7.3.2.1.2.3.2.cmml" xref="S3.E13.m1.7.7.3.2.1.2.3.2">𝑟</ci><cn id="S3.E13.m1.7.7.3.2.1.2.3.3.cmml" type="integer" xref="S3.E13.m1.7.7.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E13.m1.7.7.3.2.1.3.cmml" xref="S3.E13.m1.7.7.3.2.1.3">𝑅</ci></apply><apply id="S3.E13.m1.7.7.3.2.2.cmml" xref="S3.E13.m1.7.7.3.2.2"><times id="S3.E13.m1.7.7.3.2.2.1.cmml" xref="S3.E13.m1.7.7.3.2.2.1"></times><ci id="S3.E13.m1.7.7.3.2.2.2.cmml" xref="S3.E13.m1.7.7.3.2.2.2">ℎ</ci><ci id="S3.E13.m1.5.5.cmml" xref="S3.E13.m1.5.5">𝑟</ci><apply id="S3.E13.m1.7.7.3.2.2.4.cmml" xref="S3.E13.m1.7.7.3.2.2.4"><log id="S3.E13.m1.7.7.3.2.2.4.1.cmml" xref="S3.E13.m1.7.7.3.2.2.4.1"></log><ci id="S3.E13.m1.7.7.3.2.2.4.2.cmml" xref="S3.E13.m1.7.7.3.2.2.4.2">ℎ</ci></apply><ci id="S3.E13.m1.6.6.cmml" xref="S3.E13.m1.6.6">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.7c">H(\mathbf{Y}_{\text{final},{(i,j)}})=-\sum_{r=1}^{R}h(r)\log h(r)</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.7d">italic_H ( bold_Y start_POSTSUBSCRIPT final , ( italic_i , italic_j ) end_POSTSUBSCRIPT ) = - ∑ start_POSTSUBSCRIPT italic_r = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT italic_h ( italic_r ) roman_log italic_h ( italic_r )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.17">where</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(r)=p(\mathbf{Y}_{\text{final},(i,j)}=r|\mathbf{X};\mathcal{T})" class="ltx_Math" display="block" id="S3.E14.m1.8"><semantics id="S3.E14.m1.8a"><mrow id="S3.E14.m1.8.8" xref="S3.E14.m1.8.8.cmml"><mrow id="S3.E14.m1.8.8.3" xref="S3.E14.m1.8.8.3.cmml"><mi id="S3.E14.m1.8.8.3.2" xref="S3.E14.m1.8.8.3.2.cmml">h</mi><mo id="S3.E14.m1.8.8.3.1" xref="S3.E14.m1.8.8.3.1.cmml">⁢</mo><mrow id="S3.E14.m1.8.8.3.3.2" xref="S3.E14.m1.8.8.3.cmml"><mo id="S3.E14.m1.8.8.3.3.2.1" stretchy="false" xref="S3.E14.m1.8.8.3.cmml">(</mo><mi id="S3.E14.m1.5.5" xref="S3.E14.m1.5.5.cmml">r</mi><mo id="S3.E14.m1.8.8.3.3.2.2" stretchy="false" xref="S3.E14.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.8.8.2" xref="S3.E14.m1.8.8.2.cmml">=</mo><mrow id="S3.E14.m1.8.8.1" xref="S3.E14.m1.8.8.1.cmml"><mi id="S3.E14.m1.8.8.1.3" xref="S3.E14.m1.8.8.1.3.cmml">p</mi><mo id="S3.E14.m1.8.8.1.2" xref="S3.E14.m1.8.8.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.8.8.1.1.1" xref="S3.E14.m1.8.8.1.1.1.1.cmml"><mo id="S3.E14.m1.8.8.1.1.1.2" stretchy="false" xref="S3.E14.m1.8.8.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.8.8.1.1.1.1" xref="S3.E14.m1.8.8.1.1.1.1.cmml"><msub id="S3.E14.m1.8.8.1.1.1.1.2" xref="S3.E14.m1.8.8.1.1.1.1.2.cmml"><mi id="S3.E14.m1.8.8.1.1.1.1.2.2" xref="S3.E14.m1.8.8.1.1.1.1.2.2.cmml">𝐘</mi><mrow id="S3.E14.m1.4.4.4.4" xref="S3.E14.m1.4.4.4.5.cmml"><mtext id="S3.E14.m1.3.3.3.3" xref="S3.E14.m1.3.3.3.3a.cmml">final</mtext><mo id="S3.E14.m1.4.4.4.4.2" xref="S3.E14.m1.4.4.4.5.cmml">,</mo><mrow id="S3.E14.m1.4.4.4.4.1.2" xref="S3.E14.m1.4.4.4.4.1.1.cmml"><mo id="S3.E14.m1.4.4.4.4.1.2.1" stretchy="false" xref="S3.E14.m1.4.4.4.4.1.1.cmml">(</mo><mi id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml">i</mi><mo id="S3.E14.m1.4.4.4.4.1.2.2" xref="S3.E14.m1.4.4.4.4.1.1.cmml">,</mo><mi id="S3.E14.m1.2.2.2.2" xref="S3.E14.m1.2.2.2.2.cmml">j</mi><mo id="S3.E14.m1.4.4.4.4.1.2.3" stretchy="false" xref="S3.E14.m1.4.4.4.4.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E14.m1.8.8.1.1.1.1.1" xref="S3.E14.m1.8.8.1.1.1.1.1.cmml">=</mo><mrow id="S3.E14.m1.8.8.1.1.1.1.3" xref="S3.E14.m1.8.8.1.1.1.1.3.cmml"><mi id="S3.E14.m1.8.8.1.1.1.1.3.2" xref="S3.E14.m1.8.8.1.1.1.1.3.2.cmml">r</mi><mo fence="false" id="S3.E14.m1.8.8.1.1.1.1.3.1" xref="S3.E14.m1.8.8.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E14.m1.8.8.1.1.1.1.3.3.2" xref="S3.E14.m1.8.8.1.1.1.1.3.3.1.cmml"><mi id="S3.E14.m1.6.6" xref="S3.E14.m1.6.6.cmml">𝐗</mi><mo id="S3.E14.m1.8.8.1.1.1.1.3.3.2.1" xref="S3.E14.m1.8.8.1.1.1.1.3.3.1.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.7.7" xref="S3.E14.m1.7.7.cmml">𝒯</mi></mrow></mrow></mrow><mo id="S3.E14.m1.8.8.1.1.1.3" stretchy="false" xref="S3.E14.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.8b"><apply id="S3.E14.m1.8.8.cmml" xref="S3.E14.m1.8.8"><eq id="S3.E14.m1.8.8.2.cmml" xref="S3.E14.m1.8.8.2"></eq><apply id="S3.E14.m1.8.8.3.cmml" xref="S3.E14.m1.8.8.3"><times id="S3.E14.m1.8.8.3.1.cmml" xref="S3.E14.m1.8.8.3.1"></times><ci id="S3.E14.m1.8.8.3.2.cmml" xref="S3.E14.m1.8.8.3.2">ℎ</ci><ci id="S3.E14.m1.5.5.cmml" xref="S3.E14.m1.5.5">𝑟</ci></apply><apply id="S3.E14.m1.8.8.1.cmml" xref="S3.E14.m1.8.8.1"><times id="S3.E14.m1.8.8.1.2.cmml" xref="S3.E14.m1.8.8.1.2"></times><ci id="S3.E14.m1.8.8.1.3.cmml" xref="S3.E14.m1.8.8.1.3">𝑝</ci><apply id="S3.E14.m1.8.8.1.1.1.1.cmml" xref="S3.E14.m1.8.8.1.1.1"><eq id="S3.E14.m1.8.8.1.1.1.1.1.cmml" xref="S3.E14.m1.8.8.1.1.1.1.1"></eq><apply id="S3.E14.m1.8.8.1.1.1.1.2.cmml" xref="S3.E14.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.8.8.1.1.1.1.2.1.cmml" xref="S3.E14.m1.8.8.1.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.8.8.1.1.1.1.2.2.cmml" xref="S3.E14.m1.8.8.1.1.1.1.2.2">𝐘</ci><list id="S3.E14.m1.4.4.4.5.cmml" xref="S3.E14.m1.4.4.4.4"><ci id="S3.E14.m1.3.3.3.3a.cmml" xref="S3.E14.m1.3.3.3.3"><mtext id="S3.E14.m1.3.3.3.3.cmml" mathsize="70%" xref="S3.E14.m1.3.3.3.3">final</mtext></ci><interval closure="open" id="S3.E14.m1.4.4.4.4.1.1.cmml" xref="S3.E14.m1.4.4.4.4.1.2"><ci id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1">𝑖</ci><ci id="S3.E14.m1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.2.2">𝑗</ci></interval></list></apply><apply id="S3.E14.m1.8.8.1.1.1.1.3.cmml" xref="S3.E14.m1.8.8.1.1.1.1.3"><csymbol cd="latexml" id="S3.E14.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E14.m1.8.8.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E14.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.E14.m1.8.8.1.1.1.1.3.2">𝑟</ci><list id="S3.E14.m1.8.8.1.1.1.1.3.3.1.cmml" xref="S3.E14.m1.8.8.1.1.1.1.3.3.2"><ci id="S3.E14.m1.6.6.cmml" xref="S3.E14.m1.6.6">𝐗</ci><ci id="S3.E14.m1.7.7.cmml" xref="S3.E14.m1.7.7">𝒯</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.8c">h(r)=p(\mathbf{Y}_{\text{final},(i,j)}=r|\mathbf{X};\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.8d">italic_h ( italic_r ) = italic_p ( bold_Y start_POSTSUBSCRIPT final , ( italic_i , italic_j ) end_POSTSUBSCRIPT = italic_r | bold_X ; caligraphic_T )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Datasets and Experimental Setup</h3>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>BiomedCLIP fine-tuning</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">We employed the public MedPix dataset, which contains various radiological modalities, to fine-tune the BiomedCLIP model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite> with our DHN-NCE loss. The base encoders for images and text were the Vision Transformer (ViT) and PubMedBERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite>, respectively. The MedPix dataset was cleaned by removing special characters, trimming leading and trailing white spaces, and excluding samples with captions shorter than 20 characters. All images were resized to 224 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mo id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><times id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">×</annotation></semantics></math> 224 pixels and normalized according to the RGB channel means and standard deviations used in the original CLIP model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib9" title="">9</a>]</cite>. We performed an 85%-15% split, resulting in 20,292 training images and 3,515 validation images. Fine-tuning was performed with a learning rate of 1E-6, a 50% decay rate, and a batch size of 64.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.3">To test the fine-tuning quality of BiomedCLIP, we assessed the top-1 and top-2 accuracy of matching retrievals for both image-to-text and text-to-image on the ROCO (Radiology Objects in COntext) dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib41" title="">41</a>]</cite>, which contains approximately 7,042 multi-modal medical images covering a wide range of radiological cases. We ran the experiments five times with a batch size of 50, using shuffling to randomize image-text pairs (resulting in 70,420 shuffled examples). In addition, we compared different SOTA loss functions for fine-tuning, including InfoNCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib38" title="">38</a>]</cite>, DCL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib39" title="">39</a>]</cite> and HN-NCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib42" title="">42</a>]</cite> against our DHN-NCE loss. For a fair comparison, all strategies were trained using the same hyperparameters (<math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.1"><semantics id="S3.SS3.SSS1.p2.1.m1.1a"><mi id="S3.SS3.SSS1.p2.1.m1.1.1" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.1b"><ci id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.1d">italic_τ</annotation></semantics></math> = 0.6, learning rate = 1E-6), with the hardness parameters for HN-NCE and DHN-NCE set to <math alttext="\beta_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.2.m2.1"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><msub id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml">β</mi><mn id="S3.SS3.SSS1.p2.2.m2.1.1.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><apply id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2">𝛽</ci><cn id="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">\beta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.2.m2.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> = <math alttext="\beta_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.3.m3.1"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><msub id="S3.SS3.SSS1.p2.3.m3.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml">β</mi><mn id="S3.SS3.SSS1.p2.3.m3.1.1.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><apply id="S3.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.2">𝛽</ci><cn id="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">\beta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.3.m3.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> = 0.15. We also included baseline results from pre-trained BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite>, PMC-CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib43" title="">43</a>]</cite>, and CLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib9" title="">9</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Image segmentation accuracy</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">To evaluate the zero-shot and weakly supervised segmentation results, as well as various design elements of the proposed MedCLIP-SAMv2 framework, we utilized four public datasets, each representing different radiology modalities and tasks. These datasets, which include segmentations of breast tumors, brain tumors, and lungs, were divided into training, validation, and testing sets as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS2.p2">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Breast Tumor Ultrasound</span>: The Breast Ultrasound Images dataset (BUSI) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib44" title="">44</a>]</cite>, containing 600 images of benign and malignant tumors for training. Additionally, 50 and 113 images from the UDIAT dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib45" title="">45</a>]</cite> were used for validation and testing, respectively.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Brain Tumor MRI</span>: The Brain Tumor dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib46" title="">46</a>]</cite>, comprising 1,462 T1-weighted MRI scans for training, 500 for validation, and 600 for testing.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.1.1">Lung Chest X-ray</span>: The COVID-19 Radiography Database (COVID-QU-Ex) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib47" title="">47</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib48" title="">48</a>]</cite> is divided into 16,280 chest X-rays (normal, lung opacity, viral pneumonia, and COVID-19 cases) for training, 1,372 for validation, and 957 for testing.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.1.1">Lung CT</span>: CT scans from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib49" title="">49</a>]</cite>, consisting of segmentation masks for fibrotic diseased lungs from 107 patients, split into 7,959 slices for training, 1,000 for validation, and 1,800 for testing. The split was done by patient ID to prevent data leakage.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS2.p3">
<p class="ltx_p" id="S3.SS3.SSS2.p3.1">For weakly supervised segmentation, we trained the nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib24" title="">24</a>]</cite> architecture for 600 epochs with 3 cycles for all datasets. The learning rate was initialized to 0.01 and we adopted a cyclical learning rate schedule as described in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib25" title="">25</a>]</cite>, where the learning rate oscillates between a maximum and minimum value throughout each cycle. This allows the model to escape local optima and explore a wider solution space, leading to more diverse and robust predictions. We saved the last 10 checkpoints in each of the 3 cycles resulting in 30 total model checkpoints. The final segmentation result is averaged from the predictions of these 30 checkpoints and is later thresholded to create a binary mask.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.140" style="width:433.6pt;height:232.7pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-35.7pt,19.1pt) scale(0.858598638283828,0.858598638283828) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.140.140">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.140.140.141.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.140.140.141.1.1" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.1.1" style="font-size:80%;">Technique</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.140.140.141.1.2" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.2.1" style="font-size:80%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.140.140.141.1.3" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.3.1" style="font-size:80%;">Breast Ultrasound</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.140.140.141.1.4" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.4.1" style="font-size:80%;">Brain MRI</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.140.140.141.1.5" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.5.1" style="font-size:80%;">Lung X-ray</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.140.140.141.1.6" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.6.1" style="font-size:80%;">Lung CT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S3.T1.140.140.141.1.7" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.140.140.141.1.7.1" style="font-size:80%;">All</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.1" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S3.T1.1.1.1.1.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.1.m1.1a"><mo id="S3.T1.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.2" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.2.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S3.T1.2.2.2.2.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.2.2.2.2.m1.1"><semantics id="S3.T1.2.2.2.2.m1.1a"><mo id="S3.T1.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.m1.1b"><ci id="S3.T1.2.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.3.3.3.3" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.3.3.3.3.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S3.T1.3.3.3.3.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.3.3.3.3.m1.1"><semantics id="S3.T1.3.3.3.3.m1.1a"><mo id="S3.T1.3.3.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.3.m1.1b"><ci id="S3.T1.3.3.3.3.m1.1.1.cmml" xref="S3.T1.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.4.4.4.4" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.4.4.4.4.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S3.T1.4.4.4.4.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.4.4.4.4.m1.1"><semantics id="S3.T1.4.4.4.4.m1.1a"><mo id="S3.T1.4.4.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.4.m1.1b"><ci id="S3.T1.4.4.4.4.m1.1.1.cmml" xref="S3.T1.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.5.5.5.5" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.5.5.5.5.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S3.T1.5.5.5.5.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.5.5.5.5.m1.1"><semantics id="S3.T1.5.5.5.5.m1.1a"><mo id="S3.T1.5.5.5.5.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.5.5.m1.1b"><ci id="S3.T1.5.5.5.5.m1.1.1.cmml" xref="S3.T1.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.5.5.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.6.6.6" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.6.6.6.6.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S3.T1.6.6.6.6.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.6.6.6.6.m1.1"><semantics id="S3.T1.6.6.6.6.m1.1a"><mo id="S3.T1.6.6.6.6.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.6.6.m1.1b"><ci id="S3.T1.6.6.6.6.m1.1.1.cmml" xref="S3.T1.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.7.7.7.7" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.7.7.7.7.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S3.T1.7.7.7.7.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.7.7.7.7.m1.1"><semantics id="S3.T1.7.7.7.7.m1.1a"><mo id="S3.T1.7.7.7.7.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.7.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.7.7.m1.1b"><ci id="S3.T1.7.7.7.7.m1.1.1.cmml" xref="S3.T1.7.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.7.7.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.8.8.8.8" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.8.8.8.8.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S3.T1.8.8.8.8.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.8.8.8.8.m1.1"><semantics id="S3.T1.8.8.8.8.m1.1a"><mo id="S3.T1.8.8.8.8.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.8.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.8.8.m1.1b"><ci id="S3.T1.8.8.8.8.m1.1.1.cmml" xref="S3.T1.8.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.8.8.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.9.9.9.9" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.9.9.9.9.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S3.T1.9.9.9.9.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.9.9.9.9.m1.1"><semantics id="S3.T1.9.9.9.9.m1.1a"><mo id="S3.T1.9.9.9.9.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.9.9.9.9.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.9.9.m1.1b"><ci id="S3.T1.9.9.9.9.m1.1.1.cmml" xref="S3.T1.9.9.9.9.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.9.9.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.9.9.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.10.10.10.10" style="padding:2pt 3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.10.10.10.10.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S3.T1.10.10.10.10.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.10.10.10.10.m1.1"><semantics id="S3.T1.10.10.10.10.m1.1a"><mo id="S3.T1.10.10.10.10.m1.1.1" mathsize="80%" stretchy="false" xref="S3.T1.10.10.10.10.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.10.10.m1.1b"><ci id="S3.T1.10.10.10.10.m1.1.1.cmml" xref="S3.T1.10.10.10.10.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.10.10.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.10.10.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.20.20.20">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.20.20.20.11" rowspan="3" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.20.20.20.11.1" style="font-size:80%;">Zero-shot</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.20.20.20.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.20.20.20.12.1" style="font-size:80%;">SaLIP</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.11.11.11.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.11.11.11.1.1" style="font-size:80%;">44.33</span><sub class="ltx_sub" id="S3.T1.11.11.11.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.11.11.11.1.2.1" style="font-size:80%;">10.12</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.12.12.12.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.12.12.12.2.1" style="font-size:80%;">48.62</span><sub class="ltx_sub" id="S3.T1.12.12.12.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.12.12.12.2.2.1" style="font-size:80%;">10.25</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.13.13.13.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.13.13.13.3.1" style="font-size:80%;">47.96</span><sub class="ltx_sub" id="S3.T1.13.13.13.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.13.13.13.3.2.1" style="font-size:80%;">9.14</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.14.14.14.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.14.14.14.4.1" style="font-size:80%;">50.24</span><sub class="ltx_sub" id="S3.T1.14.14.14.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.14.14.14.4.2.1" style="font-size:80%;">9.26</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.15.15.15.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.15.15.15.5.1" style="font-size:80%;">63.14</span><sub class="ltx_sub" id="S3.T1.15.15.15.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.15.15.15.5.2.1" style="font-size:80%;">11.34</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.16.16.16.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.16.16.16.6.1" style="font-size:80%;">66.44</span><sub class="ltx_sub" id="S3.T1.16.16.16.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.16.16.16.6.2.1" style="font-size:80%;">11.58</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.17.17.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.17.17.17.7.1" style="font-size:80%;">76.32</span><sub class="ltx_sub" id="S3.T1.17.17.17.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.17.17.17.7.2.1" style="font-size:80%;">11.22</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.18.18.18.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.18.18.18.8.1" style="font-size:80%;">78.46</span><sub class="ltx_sub" id="S3.T1.18.18.18.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.18.18.18.8.2.1" style="font-size:80%;">11.35</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.19.19.19.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.19.19.19.9.1" style="font-size:80%;">57.94</span><sub class="ltx_sub" id="S3.T1.19.19.19.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.19.19.19.9.2.1" style="font-size:80%;">10.48</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.20.20.20.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.20.20.20.10.1" style="font-size:80%;">60.94</span><sub class="ltx_sub" id="S3.T1.20.20.20.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.20.20.20.10.2.1" style="font-size:80%;">10.61</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.30.30.30">
<td class="ltx_td ltx_align_center" id="S3.T1.30.30.30.11" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.30.30.30.11.1" style="font-size:80%;">SAMAug</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.21.21.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.21.21.21.1.1" style="font-size:80%;">56.39</span><sub class="ltx_sub" id="S3.T1.21.21.21.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.21.21.21.1.2.1" style="font-size:80%;">10.85</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.22.22.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.22.22.22.2.1" style="font-size:80%;">59.23</span><sub class="ltx_sub" id="S3.T1.22.22.22.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.22.22.22.2.2.1" style="font-size:80%;">10.92</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.23.23.23.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.23.23.23.3.1" style="font-size:80%;">45.71</span><sub class="ltx_sub" id="S3.T1.23.23.23.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.23.23.23.3.2.1" style="font-size:80%;">10.34</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.24.24.24.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.24.24.24.4.1" style="font-size:80%;">48.81</span><sub class="ltx_sub" id="S3.T1.24.24.24.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.24.24.24.4.2.1" style="font-size:80%;">11.29</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.25.25.25.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.25.25.25.5.1" style="font-size:80%;">57.18</span><sub class="ltx_sub" id="S3.T1.25.25.25.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.25.25.25.5.2.1" style="font-size:80%;">12.12</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.26.26.26.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.26.26.26.6.1" style="font-size:80%;">60.08</span><sub class="ltx_sub" id="S3.T1.26.26.26.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.26.26.26.6.2.1" style="font-size:80%;">12.34</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.27.27.27.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.27.27.27.7.1" style="font-size:80%;">44.61</span><sub class="ltx_sub" id="S3.T1.27.27.27.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.27.27.27.7.2.1" style="font-size:80%;">10.42</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.28.28.28.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.28.28.28.8.1" style="font-size:80%;">46.48</span><sub class="ltx_sub" id="S3.T1.28.28.28.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.28.28.28.8.2.1" style="font-size:80%;">10.57</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.29.29.29.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.29.29.29.9.1" style="font-size:80%;">50.97</span><sub class="ltx_sub" id="S3.T1.29.29.29.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.29.29.29.9.2.1" style="font-size:80%;">11.89</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.30.30.30.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.30.30.30.10.1" style="font-size:80%;">53.65</span><sub class="ltx_sub" id="S3.T1.30.30.30.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.30.30.30.10.2.1" style="font-size:80%;">12.03</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.40.40.40">
<td class="ltx_td ltx_align_center" id="S3.T1.40.40.40.11" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.40.40.40.11.1" style="font-size:80%;background-color:#EBEBEB;">Ours</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.31.31.1" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.31.31.31.1.1" style="font-size:80%;background-color:#EBEBEB;">78.42<sub class="ltx_sub" id="S3.T1.31.31.31.1.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.31.31.31.1.1.1.1">9.32</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.32.32.2" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.32.32.32.2.1" style="font-size:80%;background-color:#EBEBEB;">82.69<sub class="ltx_sub" id="S3.T1.32.32.32.2.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.32.32.32.2.1.1.1">9.50</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.33.33.33.3" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.33.33.33.3.1" style="font-size:80%;background-color:#EBEBEB;">77.12<sub class="ltx_sub" id="S3.T1.33.33.33.3.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.33.33.33.3.1.1.1">6.82</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.34.34.34.4" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.34.34.34.4.1" style="font-size:80%;background-color:#EBEBEB;">83.18<sub class="ltx_sub" id="S3.T1.34.34.34.4.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.34.34.34.4.1.1.1">6.70</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.35.35.35.5" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.35.35.35.5.1" style="font-size:80%;background-color:#EBEBEB;">76.39<sub class="ltx_sub" id="S3.T1.35.35.35.5.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.35.35.35.5.1.1.1">2.14</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.36.36.36.6" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.36.36.36.6.1" style="font-size:80%;background-color:#EBEBEB;">81.63<sub class="ltx_sub" id="S3.T1.36.36.36.6.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.36.36.36.6.1.1.1">2.15</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.37.37.37.7" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.37.37.37.7.1" style="font-size:80%;background-color:#EBEBEB;">80.92<sub class="ltx_sub" id="S3.T1.37.37.37.7.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.37.37.37.7.1.1.1">5.51</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.38.38.38.8" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.38.38.38.8.1" style="font-size:80%;background-color:#EBEBEB;">82.76<sub class="ltx_sub" id="S3.T1.38.38.38.8.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.38.38.38.8.1.1.1">5.44</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.39.39.39.9" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.39.39.39.9.1" style="font-size:80%;background-color:#EBEBEB;">78.21<sub class="ltx_sub" id="S3.T1.39.39.39.9.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.39.39.39.9.1.1.1">5.70</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.40.40.40.10" style="background-color:#EBEBEB;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.40.40.40.10.1" style="font-size:80%;background-color:#EBEBEB;">82.57<sub class="ltx_sub" id="S3.T1.40.40.40.10.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.40.40.40.10.1.1.1">5.55</span></sub></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.50.50.50">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.50.50.50.11" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.50.50.50.11.1" style="font-size:80%;">Weakly Supervised</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.50.50.50.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.50.50.50.12.1" style="font-size:80%;">nnUNet</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.41.41.41.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.41.41.41.1.1" style="font-size:80%;">73.77</span><sub class="ltx_sub" id="S3.T1.41.41.41.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.41.41.41.1.2.1" style="font-size:80%;">14.48</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.42.42.42.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.42.42.42.2.1" style="font-size:80%;">79.71</span><sub class="ltx_sub" id="S3.T1.42.42.42.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.42.42.42.2.2.1" style="font-size:80%;">14.79</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.43.43.43.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.43.43.43.3.1" style="font-size:80%;">77.16</span><sub class="ltx_sub" id="S3.T1.43.43.43.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.43.43.43.3.2.1" style="font-size:80%;">12.17</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.44.44.44.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.44.44.44.4.1" style="font-size:80%;">85.21</span><sub class="ltx_sub" id="S3.T1.44.44.44.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.44.44.44.4.2.1" style="font-size:80%;">12.60</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.45.45.45.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.45.45.45.5.1" style="font-size:80%;">70.15</span><sub class="ltx_sub" id="S3.T1.45.45.45.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.45.45.45.5.2.1" style="font-size:80%;">6.40</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.46.46.46.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.46.46.46.6.1" style="font-size:80%;">74.10</span><sub class="ltx_sub" id="S3.T1.46.46.46.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.46.46.46.6.2.1" style="font-size:80%;">6.59</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.47.47.47.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.47.47.47.7.1" style="font-size:80%;">82.24</span><sub class="ltx_sub" id="S3.T1.47.47.47.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.47.47.47.7.2.1" style="font-size:80%;">5.12</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.48.48.48.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.48.48.48.8.1" style="font-size:80%;">85.65</span><sub class="ltx_sub" id="S3.T1.48.48.48.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.48.48.48.8.2.1" style="font-size:80%;">4.70</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.49.49.49.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.49.49.49.9.1" style="font-size:80%;">75.83</span><sub class="ltx_sub" id="S3.T1.49.49.49.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.49.49.49.9.2.1" style="font-size:80%;">9.54</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.50.50.50.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.50.50.50.10.1" style="font-size:80%;">81.17</span><sub class="ltx_sub" id="S3.T1.50.50.50.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.50.50.50.10.2.1" style="font-size:80%;">9.67</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.60.60.60">
<td class="ltx_td ltx_align_center" id="S3.T1.60.60.60.11" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.60.60.60.11.1" style="font-size:80%;background-color:#D4D4D4;">Ours</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.51.51.51.1" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.51.51.51.1.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text" id="S3.T1.51.51.51.1.1.1"> <span class="ltx_text ltx_font_bold" id="S3.T1.51.51.51.1.1.1.1">78.87<sub class="ltx_sub" id="S3.T1.51.51.51.1.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.51.51.51.1.1.1.1.1.1">12.29</span></sub></span></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.52.52.52.2" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.52.52.52.2.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text ltx_font_bold" id="S3.T1.52.52.52.2.1.1">84.58<sub class="ltx_sub" id="S3.T1.52.52.52.2.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.52.52.52.2.1.1.1.1">12.19</span></sub></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.53.53.53.3" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.53.53.53.3.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text ltx_font_bold" id="S3.T1.53.53.53.3.1.1">80.03<sub class="ltx_sub" id="S3.T1.53.53.53.3.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.53.53.53.3.1.1.1.1">9.91</span></sub></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.54.54.54.4" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.54.54.54.4.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text" id="S3.T1.54.54.54.4.1.1"> <span class="ltx_text ltx_font_bold" id="S3.T1.54.54.54.4.1.1.1">88.25<sub class="ltx_sub" id="S3.T1.54.54.54.4.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.54.54.54.4.1.1.1.1.1">10.04</span></sub></span></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.55.55.55.5" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.55.55.55.5.1" style="font-size:80%;background-color:#D4D4D4;">80.77<sub class="ltx_sub" id="S3.T1.55.55.55.5.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.55.55.55.5.1.1.1">4.44</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.56.56.56.6" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.56.56.56.6.1" style="font-size:80%;background-color:#D4D4D4;">84.53<sub class="ltx_sub" id="S3.T1.56.56.56.6.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.56.56.56.6.1.1.1">4.51</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.57.57.57.7" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.57.57.57.7.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text" id="S3.T1.57.57.57.7.1.1"> <span class="ltx_text ltx_font_bold" id="S3.T1.57.57.57.7.1.1.1">88.78<sub class="ltx_sub" id="S3.T1.57.57.57.7.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.57.57.57.7.1.1.1.1.1">4.43</span></sub></span></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.58.58.58.8" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.58.58.58.8.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text ltx_font_bold" id="S3.T1.58.58.58.8.1.1">91.95<sub class="ltx_sub" id="S3.T1.58.58.58.8.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.58.58.58.8.1.1.1.1">4.06</span></sub></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.59.59.59.9" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.59.59.59.9.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text ltx_font_bold" id="S3.T1.59.59.59.9.1.1">82.11<sub class="ltx_sub" id="S3.T1.59.59.59.9.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.59.59.59.9.1.1.1.1">7.77</span></sub></span></span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.60.60.60.10" style="background-color:#D4D4D4;padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.60.60.60.10.1" style="font-size:80%;background-color:#D4D4D4;"><span class="ltx_text ltx_font_bold" id="S3.T1.60.60.60.10.1.1">87.33<sub class="ltx_sub" id="S3.T1.60.60.60.10.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.60.60.60.10.1.1.1.1">7.70</span></sub></span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.70.70.70">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.70.70.70.11" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.70.70.70.11.1" style="font-size:80%;">One-shot</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.70.70.70.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.70.70.70.12.1" style="font-size:80%;">UniverSeg</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.61.61.61.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.61.61.61.1.1" style="font-size:80%;">40.56</span><sub class="ltx_sub" id="S3.T1.61.61.61.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.61.61.61.1.2.1" style="font-size:80%;">5.14</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.62.62.62.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.62.62.62.2.1" style="font-size:80%;">53.25</span><sub class="ltx_sub" id="S3.T1.62.62.62.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.62.62.62.2.2.1" style="font-size:80%;">6.22</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.63.63.63.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.63.63.63.3.1" style="font-size:80%;">23.81</span><sub class="ltx_sub" id="S3.T1.63.63.63.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.63.63.63.3.2.1" style="font-size:80%;">5.45</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.64.64.64.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.64.64.64.4.1" style="font-size:80%;">35.28</span><sub class="ltx_sub" id="S3.T1.64.64.64.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.64.64.64.4.2.1" style="font-size:80%;">6.49</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.65.65.65.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.65.65.65.5.1" style="font-size:80%;">68.15</span><sub class="ltx_sub" id="S3.T1.65.65.65.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.65.65.65.5.2.1" style="font-size:80%;">2.21</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.66.66.66.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.66.66.66.6.1" style="font-size:80%;">80.09</span><sub class="ltx_sub" id="S3.T1.66.66.66.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.66.66.66.6.2.1" style="font-size:80%;">2.16</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.67.67.67.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.67.67.67.7.1" style="font-size:80%;">54.94</span><sub class="ltx_sub" id="S3.T1.67.67.67.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.67.67.67.7.2.1" style="font-size:80%;">8.21</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.68.68.68.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.68.68.68.8.1" style="font-size:80%;">69.62</span><sub class="ltx_sub" id="S3.T1.68.68.68.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.68.68.68.8.2.1" style="font-size:80%;">7.59</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.69.69.69.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.69.69.69.9.1" style="font-size:80%;">46.87</span><sub class="ltx_sub" id="S3.T1.69.69.69.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.69.69.69.9.2.1" style="font-size:80%;">10.83</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.70.70.70.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.70.70.70.10.1" style="font-size:80%;">59.56</span><sub class="ltx_sub" id="S3.T1.70.70.70.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.70.70.70.10.2.1" style="font-size:80%;">11.20</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.80.80.80">
<td class="ltx_td ltx_align_center" id="S3.T1.80.80.80.11" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.80.80.80.11.1" style="font-size:80%;">ProtoSAM</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.71.71.71.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.71.71.71.1.1" style="font-size:80%;">48.44</span><sub class="ltx_sub" id="S3.T1.71.71.71.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.71.71.71.1.2.1" style="font-size:80%;">10.93</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.72.72.72.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.72.72.72.2.1" style="font-size:80%;">50.24</span><sub class="ltx_sub" id="S3.T1.72.72.72.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.72.72.72.2.2.1" style="font-size:80%;">10.84</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.73.73.73.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.73.73.73.3.1" style="font-size:80%;">45.68</span><sub class="ltx_sub" id="S3.T1.73.73.73.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.73.73.73.3.2.1" style="font-size:80%;">15.14</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.74.74.74.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.74.74.74.4.1" style="font-size:80%;">51.69</span><sub class="ltx_sub" id="S3.T1.74.74.74.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.74.74.74.4.2.1" style="font-size:80%;">15.65</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.75.75.75.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.75.75.75.5.1" style="font-size:80%;">80.75</span><sub class="ltx_sub" id="S3.T1.75.75.75.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.75.75.75.5.2.1" style="font-size:80%;">1.40</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.76.76.76.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.76.76.76.6.1" style="font-size:80%;">85.11</span><sub class="ltx_sub" id="S3.T1.76.76.76.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.76.76.76.6.2.1" style="font-size:80%;">1.30</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.77.77.77.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.77.77.77.7.1" style="font-size:80%;">84.50</span><sub class="ltx_sub" id="S3.T1.77.77.77.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.77.77.77.7.2.1" style="font-size:80%;">9.94</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.78.78.78.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.78.78.78.8.1" style="font-size:80%;">87.62</span><sub class="ltx_sub" id="S3.T1.78.78.78.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.78.78.78.8.2.1" style="font-size:80%;">9.72</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.79.79.79.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.79.79.79.9.1" style="font-size:80%;">64.84</span><sub class="ltx_sub" id="S3.T1.79.79.79.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.79.79.79.9.2.1" style="font-size:80%;">13.01</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.80.80.80.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.80.80.80.10.1" style="font-size:80%;">68.67</span><sub class="ltx_sub" id="S3.T1.80.80.80.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.80.80.80.10.2.1" style="font-size:80%;">12.74</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.90.90.90">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.90.90.90.11" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.90.90.90.11.1" style="font-size:80%;">Few-shot (K = 4)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.90.90.90.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.90.90.90.12.1" style="font-size:80%;">UniverSeg</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.81.81.81.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.81.81.81.1.1" style="font-size:80%;">47.56</span><sub class="ltx_sub" id="S3.T1.81.81.81.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.81.81.81.1.2.1" style="font-size:80%;">8.57</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.82.82.82.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.82.82.82.2.1" style="font-size:80%;">54.25</span><sub class="ltx_sub" id="S3.T1.82.82.82.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.82.82.82.2.2.1" style="font-size:80%;">8.71</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.83.83.83.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.83.83.83.3.1" style="font-size:80%;">53.82</span><sub class="ltx_sub" id="S3.T1.83.83.83.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.83.83.83.3.2.1" style="font-size:80%;">10.17</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.84.84.84.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.84.84.84.4.1" style="font-size:80%;">66.40</span><sub class="ltx_sub" id="S3.T1.84.84.84.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.84.84.84.4.2.1" style="font-size:80%;">9.96</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.85.85.85.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.85.85.85.5.1" style="font-size:80%;">79.25</span><sub class="ltx_sub" id="S3.T1.85.85.85.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.85.85.85.5.2.1" style="font-size:80%;">2.10</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.86.86.86.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.86.86.86.6.1" style="font-size:80%;">84.80</span><sub class="ltx_sub" id="S3.T1.86.86.86.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.86.86.86.6.2.1" style="font-size:80%;">1.70</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.87.87.87.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.87.87.87.7.1" style="font-size:80%;">65.68</span><sub class="ltx_sub" id="S3.T1.87.87.87.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.87.87.87.7.2.1" style="font-size:80%;">12.02</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.88.88.88.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.88.88.88.8.1" style="font-size:80%;">70.56</span><sub class="ltx_sub" id="S3.T1.88.88.88.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.88.88.88.8.2.1" style="font-size:80%;">11.67</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.89.89.89.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.89.89.89.9.1" style="font-size:80%;">61.58</span><sub class="ltx_sub" id="S3.T1.89.89.89.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.89.89.89.9.2.1" style="font-size:80%;">11.87</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.90.90.90.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.90.90.90.10.1" style="font-size:80%;">69.00</span><sub class="ltx_sub" id="S3.T1.90.90.90.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.90.90.90.10.2.1" style="font-size:80%;">11.31</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.100.100.100">
<td class="ltx_td ltx_align_center" id="S3.T1.100.100.100.11" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.100.100.100.11.1" style="font-size:80%;">Self-Prompt-SAM</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.91.91.91.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.91.91.91.1.1" style="font-size:80%;">42.04</span><sub class="ltx_sub" id="S3.T1.91.91.91.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.91.91.91.1.2.1" style="font-size:80%;">17.19</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.92.92.92.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.92.92.92.2.1" style="font-size:80%;">44.30</span><sub class="ltx_sub" id="S3.T1.92.92.92.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.92.92.92.2.2.1" style="font-size:80%;">17.64</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.93.93.93.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.93.93.93.3.1" style="font-size:80%;">46.43</span><sub class="ltx_sub" id="S3.T1.93.93.93.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.93.93.93.3.2.1" style="font-size:80%;">15.25</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.94.94.94.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.94.94.94.4.1" style="font-size:80%;">50.29</span><sub class="ltx_sub" id="S3.T1.94.94.94.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.94.94.94.4.2.1" style="font-size:80%;">15.83</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.95.95.95.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.95.95.95.5.1" style="font-size:80%;">67.97</span><sub class="ltx_sub" id="S3.T1.95.95.95.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.95.95.95.5.2.1" style="font-size:80%;">2.89</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.96.96.96.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.96.96.96.6.1" style="font-size:80%;">71.63</span><sub class="ltx_sub" id="S3.T1.96.96.96.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.96.96.96.6.2.1" style="font-size:80%;">2.83</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.97.97.97.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.97.97.97.7.1" style="font-size:80%;">81.50</span><sub class="ltx_sub" id="S3.T1.97.97.97.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.97.97.97.7.2.1" style="font-size:80%;">3.84</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.98.98.98.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.98.98.98.8.1" style="font-size:80%;">83.40</span><sub class="ltx_sub" id="S3.T1.98.98.98.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.98.98.98.8.2.1" style="font-size:80%;">3.77</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.99.99.99.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.99.99.99.9.1" style="font-size:80%;">59.49</span><sub class="ltx_sub" id="S3.T1.99.99.99.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.99.99.99.9.2.1" style="font-size:80%;">13.10</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.100.100.100.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.100.100.100.10.1" style="font-size:80%;">62.41</span><sub class="ltx_sub" id="S3.T1.100.100.100.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.100.100.100.10.2.1" style="font-size:80%;">13.06</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.110.110.110">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.110.110.110.11" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.110.110.110.11.1" style="font-size:80%;">Few-shot (K = 16)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.110.110.110.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.110.110.110.12.1" style="font-size:80%;">UniverSeg</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.101.101.101.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.101.101.101.1.1" style="font-size:80%;">66.36</span><sub class="ltx_sub" id="S3.T1.101.101.101.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.101.101.101.1.2.1" style="font-size:80%;">8.57</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.102.102.102.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.102.102.102.2.1" style="font-size:80%;">72.22</span><sub class="ltx_sub" id="S3.T1.102.102.102.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.102.102.102.2.2.1" style="font-size:80%;">8.30</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.103.103.103.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.103.103.103.3.1" style="font-size:80%;">62.82</span><sub class="ltx_sub" id="S3.T1.103.103.103.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.103.103.103.3.2.1" style="font-size:80%;">7.97</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.104.104.104.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.104.104.104.4.1" style="font-size:80%;">72.76</span><sub class="ltx_sub" id="S3.T1.104.104.104.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.104.104.104.4.2.1" style="font-size:80%;">7.94</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.105.105.105.5" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.105.105.105.5.1" style="font-size:80%;">83.44<sub class="ltx_sub" id="S3.T1.105.105.105.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.105.105.105.5.1.1.1">1.54</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.106.106.106.6" style="padding:2pt 3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.106.106.106.6.1" style="font-size:80%;">87.73<sub class="ltx_sub" id="S3.T1.106.106.106.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S3.T1.106.106.106.6.1.1.1">1.24</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.107.107.107.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.107.107.107.7.1" style="font-size:80%;">86.49</span><sub class="ltx_sub" id="S3.T1.107.107.107.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.107.107.107.7.2.1" style="font-size:80%;">2.49</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.108.108.108.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.108.108.108.8.1" style="font-size:80%;">89.96</span><sub class="ltx_sub" id="S3.T1.108.108.108.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.108.108.108.8.2.1" style="font-size:80%;">1.94</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.109.109.109.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.109.109.109.9.1" style="font-size:80%;">74.78</span><sub class="ltx_sub" id="S3.T1.109.109.109.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.109.109.109.9.2.1" style="font-size:80%;">7.39</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.110.110.110.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.110.110.110.10.1" style="font-size:80%;">80.67</span><sub class="ltx_sub" id="S3.T1.110.110.110.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.110.110.110.10.2.1" style="font-size:80%;">6.25</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.120.120.120">
<td class="ltx_td ltx_align_center" id="S3.T1.120.120.120.11" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.120.120.120.11.1" style="font-size:80%;">Self-Prompt-SAM</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.111.111.111.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.111.111.111.1.1" style="font-size:80%;">62.36</span><sub class="ltx_sub" id="S3.T1.111.111.111.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.111.111.111.1.2.1" style="font-size:80%;">16.38</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.112.112.112.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.112.112.112.2.1" style="font-size:80%;">66.01</span><sub class="ltx_sub" id="S3.T1.112.112.112.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.112.112.112.2.2.1" style="font-size:80%;">16.92</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.113.113.113.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.113.113.113.3.1" style="font-size:80%;">52.55</span><sub class="ltx_sub" id="S3.T1.113.113.113.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.113.113.113.3.2.1" style="font-size:80%;">15.29</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.114.114.114.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.114.114.114.4.1" style="font-size:80%;">57.07</span><sub class="ltx_sub" id="S3.T1.114.114.114.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.114.114.114.4.2.1" style="font-size:80%;">15.93</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.115.115.115.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.115.115.115.5.1" style="font-size:80%;">82.49</span><sub class="ltx_sub" id="S3.T1.115.115.115.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.115.115.115.5.2.1" style="font-size:80%;">2.50</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.116.116.116.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.116.116.116.6.1" style="font-size:80%;">86.49</span><sub class="ltx_sub" id="S3.T1.116.116.116.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.116.116.116.6.2.1" style="font-size:80%;">2.45</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.117.117.117.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.117.117.117.7.1" style="font-size:80%;">83.66</span><sub class="ltx_sub" id="S3.T1.117.117.117.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.117.117.117.7.2.1" style="font-size:80%;">3.90</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.118.118.118.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.118.118.118.8.1" style="font-size:80%;">85.49</span><sub class="ltx_sub" id="S3.T1.118.118.118.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.118.118.118.8.2.1" style="font-size:80%;">3.84</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.119.119.119.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.119.119.119.9.1" style="font-size:80%;">70.27</span><sub class="ltx_sub" id="S3.T1.119.119.119.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.119.119.119.9.2.1" style="font-size:80%;">11.84</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.120.120.120.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.120.120.120.10.1" style="font-size:80%;">73.77</span><sub class="ltx_sub" id="S3.T1.120.120.120.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.120.120.120.10.2.1" style="font-size:80%;">11.69</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.130.130.130">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S3.T1.130.130.130.11" rowspan="2" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.130.130.130.11.1" style="font-size:80%;">Fully Supervised</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.130.130.130.12" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.130.130.130.12.1" style="font-size:80%;">nnUNet</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.121.121.121.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.121.121.121.1.1" style="font-size:80%;">82.47</span><sub class="ltx_sub" id="S3.T1.121.121.121.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.121.121.121.1.2.1" style="font-size:80%;">10.49</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.122.122.122.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.122.122.122.2.1" style="font-size:80%;">88.32</span><sub class="ltx_sub" id="S3.T1.122.122.122.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.122.122.122.2.2.1" style="font-size:80%;">10.77</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.123.123.123.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.123.123.123.3.1" style="font-size:80%;">87.74</span><sub class="ltx_sub" id="S3.T1.123.123.123.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.123.123.123.3.2.1" style="font-size:80%;">6.28</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.124.124.124.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.124.124.124.4.1" style="font-size:80%;">95.10</span><sub class="ltx_sub" id="S3.T1.124.124.124.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.124.124.124.4.2.1" style="font-size:80%;">6.28</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.125.125.125.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.125.125.125.5.1" style="font-size:80%;">98.72</span><sub class="ltx_sub" id="S3.T1.125.125.125.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.125.125.125.5.2.1" style="font-size:80%;">0.65</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.126.126.126.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.126.126.126.6.1" style="font-size:80%;">99.51</span><sub class="ltx_sub" id="S3.T1.126.126.126.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.126.126.126.6.2.1" style="font-size:80%;">0.41</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.127.127.127.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.127.127.127.7.1" style="font-size:80%;">97.10</span><sub class="ltx_sub" id="S3.T1.127.127.127.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.127.127.127.7.2.1" style="font-size:80%;">2.74</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.128.128.128.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.128.128.128.8.1" style="font-size:80%;">99.18</span><sub class="ltx_sub" id="S3.T1.128.128.128.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.128.128.128.8.2.1" style="font-size:80%;">2.13</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.129.129.129.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.129.129.129.9.1" style="font-size:80%;">84.63</span><sub class="ltx_sub" id="S3.T1.129.129.129.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.129.129.129.9.2.1" style="font-size:80%;">5.04</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.130.130.130.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.130.130.130.10.1" style="font-size:80%;">90.42</span><sub class="ltx_sub" id="S3.T1.130.130.130.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.130.130.130.10.2.1" style="font-size:80%;">4.80</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.140.140.140">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.140.140.140.11" style="padding:2pt 3.0pt;"><span class="ltx_text" id="S3.T1.140.140.140.11.1" style="font-size:80%;">nnUNet Ensemble</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.131.131.131.1" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.131.131.131.1.1" style="font-size:80%;">84.72</span><sub class="ltx_sub" id="S3.T1.131.131.131.1.2"><span class="ltx_text ltx_font_italic" id="S3.T1.131.131.131.1.2.1" style="font-size:80%;">10.97</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.132.132.132.2" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.132.132.132.2.1" style="font-size:80%;">90.85</span><sub class="ltx_sub" id="S3.T1.132.132.132.2.2"><span class="ltx_text ltx_font_italic" id="S3.T1.132.132.132.2.2.1" style="font-size:80%;">11.26</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.133.133.133.3" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.133.133.133.3.1" style="font-size:80%;">88.82</span><sub class="ltx_sub" id="S3.T1.133.133.133.3.2"><span class="ltx_text ltx_font_italic" id="S3.T1.133.133.133.3.2.1" style="font-size:80%;">5.93</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.134.134.134.4" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.134.134.134.4.1" style="font-size:80%;">95.84</span><sub class="ltx_sub" id="S3.T1.134.134.134.4.2"><span class="ltx_text ltx_font_italic" id="S3.T1.134.134.134.4.2.1" style="font-size:80%;">5.54</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.135.135.135.5" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.135.135.135.5.1" style="font-size:80%;">99.14</span><sub class="ltx_sub" id="S3.T1.135.135.135.5.2"><span class="ltx_text ltx_font_italic" id="S3.T1.135.135.135.5.2.1" style="font-size:80%;">2.50</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.136.136.136.6" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.136.136.136.6.1" style="font-size:80%;">99.82</span><sub class="ltx_sub" id="S3.T1.136.136.136.6.2"><span class="ltx_text ltx_font_italic" id="S3.T1.136.136.136.6.2.1" style="font-size:80%;">1.93</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.137.137.137.7" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.137.137.137.7.1" style="font-size:80%;">98.12</span><sub class="ltx_sub" id="S3.T1.137.137.137.7.2"><span class="ltx_text ltx_font_italic" id="S3.T1.137.137.137.7.2.1" style="font-size:80%;">4.09</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.138.138.138.8" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.138.138.138.8.1" style="font-size:80%;">99.65</span><sub class="ltx_sub" id="S3.T1.138.138.138.8.2"><span class="ltx_text ltx_font_italic" id="S3.T1.138.138.138.8.2.1" style="font-size:80%;">4.03</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.139.139.139.9" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.139.139.139.9.1" style="font-size:80%;">85.43</span><sub class="ltx_sub" id="S3.T1.139.139.139.9.2"><span class="ltx_text ltx_font_italic" id="S3.T1.139.139.139.9.2.1" style="font-size:80%;">5.87</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.140.140.140.10" style="padding:2pt 3.0pt;">
<span class="ltx_text" id="S3.T1.140.140.140.10.1" style="font-size:80%;">91.74</span><sub class="ltx_sub" id="S3.T1.140.140.140.10.2"><span class="ltx_text ltx_font_italic" id="S3.T1.140.140.140.10.2.1" style="font-size:80%;">5.71</span></sub>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.148.2.1" style="font-size:113%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.142.1" style="font-size:113%;">Comparison of DSC and NSD values (%) with different few-shot and zero-shot medical image segmentation methods (mean<sub class="ltx_sub" id="S3.T1.142.1.1"><span class="ltx_text ltx_font_italic" id="S3.T1.142.1.1.1">std</span></sub>)</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Experimental setup and metrics</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">We performed a comprehensive comparison of segmentation quality using the initial labels derived from post-processed M2IB results, zero-shot pseudo-masks, and weakly supervised outputs on the specified testing datasets. Our zero-shot method was benchmarked against SOTA zero-shot (SaLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib50" title="">50</a>]</cite> and SAMAug <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib51" title="">51</a>]</cite>) and few-shot (UniverSeg <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib52" title="">52</a>]</cite>, ProtoSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib53" title="">53</a>]</cite>, and Self-Prompt-SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib54" title="">54</a>]</cite>) segmentation methods. Additionally, we compare our weakly supervised method with nnUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib24" title="">24</a>]</cite> trained on pseudo-labels without checkpoint ensembling. As part of the ablation studies for zero-shot segmentation, we examined: <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p1.1.1">1)</span> the impact of fine-tuning BiomedCLIP and the choice of explainable AI (XAI) technique for saliency map generation, <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p1.1.2">2)</span> the influence of different text prompts on overall segmentation performance, <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p1.1.3">3)</span> the contribution of each model component to the final performance, and <span class="ltx_text ltx_font_bold" id="S3.SS3.SSS3.p1.1.4">4)</span> the selection of SAM pre-trained models with various visual prompting strategies. These ablation studies were conducted on the test sets of all four datasets mentioned. In all experiments, Dice-Sørensen Coefficient (DSC) and Normalized Surface Distance (NSD) were used as evaluation metrics. Paired-sample t-tests were also conducted to validate the observed trends, with a p-value of less than 0.05 indicating statistical significance.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Comparison with SOTA Methods</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.T1" title="Table 1 ‣ 3.3.2 Image segmentation accuracy ‣ 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a> shows a comparison of the proposed methods with different SOTA techniques. In general, our method demonstrated superior performance in both zero-shot and weakly supervised settings. In the weakly supervised scenario, our method achieved an average DSC of <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.2.1">82.11</span> and NSD of <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.2.2">87.33</span>, significantly outperforming all zero-shot and few-shot SOTA methods across various imaging modalities/tasks (<math alttext="p" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_p</annotation></semantics></math> <math alttext="&lt;" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mo id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><lt id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">&lt;</annotation></semantics></math> 0.05), except Lung X-ray. However, the fully supervised methods still offer higher accuracy than those using limited resources. Notably, our zero-shot approach achieved an average DSC of <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.2.3">78.21</span> and NSD of <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.2.4">82.57</span>, even surpassing weakly supervised nnUNet trained on pseudo-labels without checkpoint ensembling on average.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Cross-modal retrieval accuracy</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The accuracy of cross-modal retrieval (text-to-image and image-to-text) for the ROCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib41" title="">41</a>]</cite> is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T2" title="Table 2 ‣ 4.2 Cross-modal retrieval accuracy ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a> across different losses for fine-tuning BiomedCLIP, with three pre-trained CLIP models as baselines. It can be seen that domain-specific pre-trained models performed better than CLIP, with the larger-scale pretraining offering better retrieval accuracy while the pre-trained BiomedCLIP demonstrating the highest retrieval accuracy among all pre-trained models. Fine-tuning BiomedCLIP further enhanced its performance. Specifically, BiomedCLIP fine-tuned with DHN-NCE reached <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">84.70%</span> top-1 and <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.2">94.73%</span> top-2 in image-to-text retrieval, and <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.3">85.99%</span> top-1 and <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.4">95.17%</span> top-2 in text-to-image retrieval, significantly outperforming other loss functions and the baseline models (<math alttext="p&lt;" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">p</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">&lt;</mo><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><lt id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></lt><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">p&lt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_p &lt;</annotation></semantics></math> 0.01). Additionally, the benefit of fine-tuning BiomedCLIP with our DHN-NCE loss is further validated with improved segmentation quality across different tasks and image modalities in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T4" title="Table 4 ‣ 4.3.2 Component Ablation Analysis ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T5" title="Table 5 ‣ 4.3.3 Effect of Saliency Maps ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.30" style="width:433.6pt;height:135.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-43.1pt,13.4pt) scale(0.834182431078366,0.834182431078366) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.30.30">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.2.2">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2.3" rowspan="2" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.2.2.2.3.1" style="font-size:80%;">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2.4" rowspan="2" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.2.2.2.4.1" style="font-size:80%;">Version</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.1.1.1.1" style="padding:0.4pt 11.0pt;">
<math alttext="image\rightarrow text" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mrow id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2.2" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.2.2.cmml">i</mi><mo id="S4.T2.1.1.1.1.m1.1.1.2.1" xref="S4.T2.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.3" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.2.3.cmml">m</mi><mo id="S4.T2.1.1.1.1.m1.1.1.2.1a" xref="S4.T2.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.4" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.2.4.cmml">a</mi><mo id="S4.T2.1.1.1.1.m1.1.1.2.1b" xref="S4.T2.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.5" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.2.5.cmml">g</mi><mo id="S4.T2.1.1.1.1.m1.1.1.2.1c" xref="S4.T2.1.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.2.6" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.2.6.cmml">e</mi></mrow><mo id="S4.T2.1.1.1.1.m1.1.1.1" mathsize="80%" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">→</mo><mrow id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.3.2" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.T2.1.1.1.1.m1.1.1.3.1" xref="S4.T2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.3.3" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.3.3.cmml">e</mi><mo id="S4.T2.1.1.1.1.m1.1.1.3.1a" xref="S4.T2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.3.4" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.3.4.cmml">x</mi><mo id="S4.T2.1.1.1.1.m1.1.1.3.1b" xref="S4.T2.1.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.1.m1.1.1.3.5" mathsize="80%" xref="S4.T2.1.1.1.1.m1.1.1.3.5.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><ci id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1">→</ci><apply id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2"><times id="S4.T2.1.1.1.1.m1.1.1.2.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.1"></times><ci id="S4.T2.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.2">𝑖</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.3">𝑚</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.4.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.4">𝑎</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.5.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.5">𝑔</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2.6.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2.6">𝑒</ci></apply><apply id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3"><times id="S4.T2.1.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.1.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.3">𝑒</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.4.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.4">𝑥</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.5.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">image\rightarrow text</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">italic_i italic_m italic_a italic_g italic_e → italic_t italic_e italic_x italic_t</annotation></semantics></math><span class="ltx_text" id="S4.T2.1.1.1.1.1" style="font-size:80%;"> (%)</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.2.2.2.2" style="padding:0.4pt 11.0pt;">
<math alttext="text\rightarrow image" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml"><mrow id="S4.T2.2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.2.m1.1.1.2.cmml"><mi id="S4.T2.2.2.2.2.m1.1.1.2.2" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.2.2.cmml">t</mi><mo id="S4.T2.2.2.2.2.m1.1.1.2.1" xref="S4.T2.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.2.3" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.2.3.cmml">e</mi><mo id="S4.T2.2.2.2.2.m1.1.1.2.1a" xref="S4.T2.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.2.4" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.2.4.cmml">x</mi><mo id="S4.T2.2.2.2.2.m1.1.1.2.1b" xref="S4.T2.2.2.2.2.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.2.5" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.2.5.cmml">t</mi></mrow><mo id="S4.T2.2.2.2.2.m1.1.1.1" mathsize="80%" stretchy="false" xref="S4.T2.2.2.2.2.m1.1.1.1.cmml">→</mo><mrow id="S4.T2.2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.2.m1.1.1.3.cmml"><mi id="S4.T2.2.2.2.2.m1.1.1.3.2" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.3.2.cmml">i</mi><mo id="S4.T2.2.2.2.2.m1.1.1.3.1" xref="S4.T2.2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.3.3" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.3.3.cmml">m</mi><mo id="S4.T2.2.2.2.2.m1.1.1.3.1a" xref="S4.T2.2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.3.4" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.3.4.cmml">a</mi><mo id="S4.T2.2.2.2.2.m1.1.1.3.1b" xref="S4.T2.2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.3.5" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.3.5.cmml">g</mi><mo id="S4.T2.2.2.2.2.m1.1.1.3.1c" xref="S4.T2.2.2.2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.2.2.m1.1.1.3.6" mathsize="80%" xref="S4.T2.2.2.2.2.m1.1.1.3.6.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"><ci id="S4.T2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.1">→</ci><apply id="S4.T2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2"><times id="S4.T2.2.2.2.2.m1.1.1.2.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2.1"></times><ci id="S4.T2.2.2.2.2.m1.1.1.2.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2.2">𝑡</ci><ci id="S4.T2.2.2.2.2.m1.1.1.2.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2.3">𝑒</ci><ci id="S4.T2.2.2.2.2.m1.1.1.2.4.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2.4">𝑥</ci><ci id="S4.T2.2.2.2.2.m1.1.1.2.5.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2.5">𝑡</ci></apply><apply id="S4.T2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3"><times id="S4.T2.2.2.2.2.m1.1.1.3.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.1"></times><ci id="S4.T2.2.2.2.2.m1.1.1.3.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.2">𝑖</ci><ci id="S4.T2.2.2.2.2.m1.1.1.3.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.3">𝑚</ci><ci id="S4.T2.2.2.2.2.m1.1.1.3.4.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.4">𝑎</ci><ci id="S4.T2.2.2.2.2.m1.1.1.3.5.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.5">𝑔</ci><ci id="S4.T2.2.2.2.2.m1.1.1.3.6.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">text\rightarrow image</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.m1.1d">italic_t italic_e italic_x italic_t → italic_i italic_m italic_a italic_g italic_e</annotation></semantics></math><span class="ltx_text" id="S4.T2.2.2.2.2.1" style="font-size:80%;"> (%)</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.30.30.31.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.30.30.31.1.1" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.31.1.1.1" style="font-size:80%;">Top-1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.30.30.31.1.2" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.31.1.2.1" style="font-size:80%;">Top-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.30.30.31.1.3" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.31.1.3.1" style="font-size:80%;">Top-1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.30.30.31.1.4" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.31.1.4.1" style="font-size:80%;">Top-2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.6.5" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.6.6.6.5.1" style="font-size:80%;">CLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.6.6.6.5.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib9" title="">9</a><span class="ltx_text" id="S4.T2.6.6.6.5.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.6.6" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.6.6.6.6.1" style="font-size:80%;">Pre-trained</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.3.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.3.3.3.1.1" style="font-size:80%;">26.68</span><sub class="ltx_sub" id="S4.T2.3.3.3.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.3.3.3.1.2.1" style="font-size:80%;">0.30</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.4.4.4.2.1" style="font-size:80%;">41.80</span><sub class="ltx_sub" id="S4.T2.4.4.4.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.4.4.4.2.2.1" style="font-size:80%;">0.19</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.5.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.5.5.5.3.1" style="font-size:80%;">26.17</span><sub class="ltx_sub" id="S4.T2.5.5.5.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.5.5.5.3.2.1" style="font-size:80%;">0.20</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.6.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.6.6.6.4.1" style="font-size:80%;">41.13</span><sub class="ltx_sub" id="S4.T2.6.6.6.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.6.6.6.4.2.1" style="font-size:80%;">0.20</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.10.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.10.10.5" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.10.10.10.5.1" style="font-size:80%;">PMC-CLIP </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.10.10.10.5.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib43" title="">43</a><span class="ltx_text" id="S4.T2.10.10.10.5.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.10.10.6" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.10.10.10.6.1" style="font-size:80%;">Pre-trained</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.7.7.7.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.7.7.7.1.1" style="font-size:80%;">75.47</span><sub class="ltx_sub" id="S4.T2.7.7.7.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.7.7.7.1.2.1" style="font-size:80%;">0.37</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.8.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.8.8.8.2.1" style="font-size:80%;">87.46</span><sub class="ltx_sub" id="S4.T2.8.8.8.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.8.8.8.2.2.1" style="font-size:80%;">0.11</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.9.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.9.9.9.3.1" style="font-size:80%;">76.78</span><sub class="ltx_sub" id="S4.T2.9.9.9.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.9.9.9.3.2.1" style="font-size:80%;">0.11</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.10.10.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.10.10.10.4.1" style="font-size:80%;">88.35</span><sub class="ltx_sub" id="S4.T2.10.10.10.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.10.10.10.4.2.1" style="font-size:80%;">0.19</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.14.14.14">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.14.14.14.5" rowspan="5" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.14.14.14.5.1" style="font-size:80%;">BiomedCLIP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib11" title="">11</a>]</cite></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.14.14.14.6" style="padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.14.14.14.6.1" style="font-size:80%;">Pre-trained</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.11.11.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.11.11.11.1.1" style="font-size:80%;">81.83</span><sub class="ltx_sub" id="S4.T2.11.11.11.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.11.11.11.1.2.1" style="font-size:80%;">0.20</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.12.12.12.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.12.12.12.2.1" style="font-size:80%;">92.79</span><sub class="ltx_sub" id="S4.T2.12.12.12.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.12.12.12.2.2.1" style="font-size:80%;">0.13</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.13.13.13.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.13.13.13.3.1" style="font-size:80%;">81.36</span><sub class="ltx_sub" id="S4.T2.13.13.13.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.13.13.13.3.2.1" style="font-size:80%;">0.48</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.14.14.14.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.14.14.14.4.1" style="font-size:80%;">92.27</span><sub class="ltx_sub" id="S4.T2.14.14.14.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.14.14.14.4.2.1" style="font-size:80%;">0.14</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.18.18.18">
<td class="ltx_td ltx_align_center" id="S4.T2.18.18.18.5" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.18.18.18.5.1" style="font-size:80%;">InfoNCE </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.18.18.18.5.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib38" title="">38</a><span class="ltx_text" id="S4.T2.18.18.18.5.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.15.15.15.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.15.15.15.1.1" style="font-size:80%;">84.21</span><sub class="ltx_sub" id="S4.T2.15.15.15.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.15.15.15.1.2.1" style="font-size:80%;">0.35</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.16.16.16.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.16.16.16.2.1" style="font-size:80%;">94.47</span><sub class="ltx_sub" id="S4.T2.16.16.16.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.16.16.16.2.2.1" style="font-size:80%;">0.19</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.17.17.17.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.17.17.17.3.1" style="font-size:80%;">85.73</span><sub class="ltx_sub" id="S4.T2.17.17.17.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.17.17.17.3.2.1" style="font-size:80%;">0.19</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.18.18.18.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.18.18.18.4.1" style="font-size:80%;">94.99</span><sub class="ltx_sub" id="S4.T2.18.18.18.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.18.18.18.4.2.1" style="font-size:80%;">0.16</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.22.22.22">
<td class="ltx_td ltx_align_center" id="S4.T2.22.22.22.5" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.22.22.22.5.1" style="font-size:80%;">DCL </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.22.22.22.5.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib39" title="">39</a><span class="ltx_text" id="S4.T2.22.22.22.5.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.19.19.19.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.19.19.19.1.1" style="font-size:80%;">84.44</span><sub class="ltx_sub" id="S4.T2.19.19.19.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.19.19.19.1.2.1" style="font-size:80%;">0.37</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.20.20.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.20.20.20.2.1" style="font-size:80%;">94.68</span><sub class="ltx_sub" id="S4.T2.20.20.20.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.20.20.20.2.2.1" style="font-size:80%;">0.19</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.21.21.21.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.21.21.21.3.1" style="font-size:80%;">85.89</span><sub class="ltx_sub" id="S4.T2.21.21.21.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.21.21.21.3.2.1" style="font-size:80%;">0.16</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.22.22.22.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.22.22.22.4.1" style="font-size:80%;">95.09</span><sub class="ltx_sub" id="S4.T2.22.22.22.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.22.22.22.4.2.1" style="font-size:80%;">0.19</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.26.26.26">
<td class="ltx_td ltx_align_center" id="S4.T2.26.26.26.5" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.26.26.26.5.1" style="font-size:80%;">HN-NCE </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.26.26.26.5.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib42" title="">42</a><span class="ltx_text" id="S4.T2.26.26.26.5.3.2" style="font-size:80%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.23.23.23.1" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.23.23.23.1.1" style="font-size:80%;">84.33</span><sub class="ltx_sub" id="S4.T2.23.23.23.1.2"><span class="ltx_text ltx_font_italic" id="S4.T2.23.23.23.1.2.1" style="font-size:80%;">0.35</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.24.24.24.2" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.24.24.24.2.1" style="font-size:80%;">94.60</span><sub class="ltx_sub" id="S4.T2.24.24.24.2.2"><span class="ltx_text ltx_font_italic" id="S4.T2.24.24.24.2.2.1" style="font-size:80%;">0.19</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.25.25.25.3" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.25.25.25.3.1" style="font-size:80%;">85.80</span><sub class="ltx_sub" id="S4.T2.25.25.25.3.2"><span class="ltx_text ltx_font_italic" id="S4.T2.25.25.25.3.2.1" style="font-size:80%;">0.17</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.26.26.4" style="padding:0.4pt 11.0pt;">
<span class="ltx_text" id="S4.T2.26.26.26.4.1" style="font-size:80%;">95.10</span><sub class="ltx_sub" id="S4.T2.26.26.26.4.2"><span class="ltx_text ltx_font_italic" id="S4.T2.26.26.26.4.2.1" style="font-size:80%;">0.19</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.30.30.30">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.30.30.30.5" style="background-color:#E6E6E6;padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.30.5.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.30.30.30.5.1.1">DHN-NCE</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.27.27.27.1" style="background-color:#E6E6E6;padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.27.27.27.1.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.27.27.27.1.1.1">84.70<sub class="ltx_sub" id="S4.T2.27.27.27.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.27.27.27.1.1.1.1.1">0.33</span></sub></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.28.28.28.2" style="background-color:#E6E6E6;padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.28.28.28.2.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.28.28.28.2.1.1">94.73<sub class="ltx_sub" id="S4.T2.28.28.28.2.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.28.28.28.2.1.1.1.1">0.16</span></sub></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.29.29.29.3" style="background-color:#E6E6E6;padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.29.29.29.3.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.29.29.29.3.1.1">85.99<sub class="ltx_sub" id="S4.T2.29.29.29.3.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.29.29.29.3.1.1.1.1">0.19</span></sub></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.30.30.30.4" style="background-color:#E6E6E6;padding:0.4pt 11.0pt;"><span class="ltx_text" id="S4.T2.30.30.30.4.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T2.30.30.30.4.1.1">95.17<sub class="ltx_sub" id="S4.T2.30.30.30.4.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.30.30.30.4.1.1.1.1">0.19</span></sub></span></span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.38.2.1" style="font-size:113%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.32.1" style="font-size:113%;">Top-K cross-modal retrieval accuracy (mean<sub class="ltx_sub" id="S4.T2.32.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.32.1.1.1">std</span></sub>)
for CLIP models.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Experiments</h3>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Effect of text prompt designs</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">We conducted a series of experiments to analyze the impact of various text prompt designs on zero-shot segmentation performance. In particular, we compared six different prompt configurations: <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.1">P0</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.2">P1</span> include the class name of the object to be segmented, while <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.3">P2</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.4">P3</span> consist of longer, descriptive single prompts, and finally <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.5">P4</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.6">P5</span> are ensembles of 20 text prompts. Note that <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.7">P0</span>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.8">P2</span>, and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.9">P4</span> are generic text prompts, while <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.10">P1</span>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.11">P3</span>, and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.12">P5</span> are more nuanced with subtypes of the target object of interests. For example, for Breast Ultrasound, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.13">P0</span> is “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.14">breast tumor</span>” while <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.15">P1</span> can either be “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.16">malignant breast tumor</span>” or “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.17">benign breast tumor</span>” depending on the tumor class. For <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.18">P2</span>, we used one descriptive sentence, such as “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.19">A medical breast mammogram showing a suspicious, irregularly shaped mass suggestive of a breast tumor.</span>” <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.20">P3</span>, on the other hand, includes descriptive text about a specific tumor subtype, like “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.21">A medical breast mammogram showing an irregularly shaped, spiculated mass suggestive of a malignant breast tumor.</span>” <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.22">P4</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.23">P5</span> are similar to <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.24">P2</span> and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.25">P3</span>, but they use an ensemble approach by averaging the text embeddings of 20 different prompts. Here, all descriptive clinical prompts are generated using GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib55" title="">55</a>]</cite>. For Lung CT, we evaluated solely on generic prompts as there is only one class available. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T3" title="Table 3 ‣ 4.3.1 Effect of text prompt designs ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>, the choice of text prompt significantly influences segmentation performance. Class-specific prompts (<span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.26">P3</span>) generally yielded better results for smaller structures like breast and brain tumors whereas generic prompts (<span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.27">P0</span>, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p1.1.28">P2</span>) performed better for larger structures like lungs in X-ray and CT scans, where simpler, more generic descriptions allowed the model to focus on larger areas. The best prompt configuration for each task is used to generate the results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.T1" title="Table 1 ‣ 3.3.2 Image segmentation accuracy ‣ 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.50" style="width:433.6pt;height:175.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(38.8pt,-15.7pt) scale(1.21830517923706,1.21830517923706) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.50.50">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.50.50.51.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.50.50.51.1.1" rowspan="2" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.51.1.1.1" style="font-size:80%;">Prompt</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.50.50.51.1.2" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.51.1.2.1" style="font-size:80%;">Breast Ultrasound</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.50.50.51.1.3" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.51.1.3.1" style="font-size:80%;">Brain MRI</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.50.50.51.1.4" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.51.1.4.1" style="font-size:80%;">Lung X-ray</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.50.50.51.1.5" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.51.1.5.1" style="font-size:80%;">Lung CT</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.1.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T3.1.1.1.1.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.2.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T3.2.2.2.2.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.3.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T3.3.3.3.3.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.4.4.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.4.4.4.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T3.4.4.4.4.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.4.4.4.m1.1"><semantics id="S4.T3.4.4.4.4.m1.1a"><mo id="S4.T3.4.4.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m1.1b"><ci id="S4.T3.4.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.5.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.5.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T3.5.5.5.5.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.5.5.5.5.m1.1"><semantics id="S4.T3.5.5.5.5.m1.1a"><mo id="S4.T3.5.5.5.5.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.m1.1b"><ci id="S4.T3.5.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.6.6.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.6.6.6.6.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T3.6.6.6.6.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.6.6.6.6.m1.1"><semantics id="S4.T3.6.6.6.6.m1.1a"><mo id="S4.T3.6.6.6.6.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.6.m1.1b"><ci id="S4.T3.6.6.6.6.m1.1.1.cmml" xref="S4.T3.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.7.7.7.7" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.7.7.7.7.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T3.7.7.7.7.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.7.7.7.7.m1.1"><semantics id="S4.T3.7.7.7.7.m1.1a"><mo id="S4.T3.7.7.7.7.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.7.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.7.m1.1b"><ci id="S4.T3.7.7.7.7.m1.1.1.cmml" xref="S4.T3.7.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.7.7.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.8" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.8.8.8.8.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T3.8.8.8.8.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.8.8.8.8.m1.1"><semantics id="S4.T3.8.8.8.8.m1.1a"><mo id="S4.T3.8.8.8.8.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T3.8.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.8.8.m1.1b"><ci id="S4.T3.8.8.8.8.m1.1.1.cmml" xref="S4.T3.8.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.16.16.16">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.16.16.16.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.16.16.16.9.1" style="font-size:80%;">P0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.9.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.9.9.9.1.1" style="font-size:80%;">65.04</span><sub class="ltx_sub" id="S4.T3.9.9.9.1.2"><span class="ltx_text ltx_font_italic" id="S4.T3.9.9.9.1.2.1" style="font-size:80%;">15.84</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.10.10.10.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.10.10.10.2.1" style="font-size:80%;">69.38</span><sub class="ltx_sub" id="S4.T3.10.10.10.2.2"><span class="ltx_text ltx_font_italic" id="S4.T3.10.10.10.2.2.1" style="font-size:80%;">16.14</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.11.11.11.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.11.11.11.3.1" style="font-size:80%;">72.00</span><sub class="ltx_sub" id="S4.T3.11.11.11.3.2"><span class="ltx_text ltx_font_italic" id="S4.T3.11.11.11.3.2.1" style="font-size:80%;">8.47</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.12.12.12.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.12.12.12.4.1" style="font-size:80%;">77.78</span><sub class="ltx_sub" id="S4.T3.12.12.12.4.2"><span class="ltx_text ltx_font_italic" id="S4.T3.12.12.12.4.2.1" style="font-size:80%;">8.48</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.13.13.13.5" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.13.13.13.5.1" style="font-size:80%;">76.39<sub class="ltx_sub" id="S4.T3.13.13.13.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.13.13.13.5.1.1.1">2.14</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.14.14.14.6" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.14.14.14.6.1" style="font-size:80%;">81.63<sub class="ltx_sub" id="S4.T3.14.14.14.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.14.14.14.6.1.1.1">2.15</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.15.15.15.7" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.15.15.15.7.1" style="font-size:80%;">71.14</span><sub class="ltx_sub" id="S4.T3.15.15.15.7.2"><span class="ltx_text ltx_font_italic" id="S4.T3.15.15.15.7.2.1" style="font-size:80%;">6.02</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.16.16.16.8" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.16.16.16.8.1" style="font-size:80%;">73.17</span><sub class="ltx_sub" id="S4.T3.16.16.16.8.2"><span class="ltx_text ltx_font_italic" id="S4.T3.16.16.16.8.2.1" style="font-size:80%;">5.95</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.22.22.22">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.22.22.22.7" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.22.22.22.7.1" style="font-size:80%;">P1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.17.17.17.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.17.17.17.1.1" style="font-size:80%;">68.88</span><sub class="ltx_sub" id="S4.T3.17.17.17.1.2"><span class="ltx_text ltx_font_italic" id="S4.T3.17.17.17.1.2.1" style="font-size:80%;">15.03</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.18.18.18.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.18.18.18.2.1" style="font-size:80%;">73.02</span><sub class="ltx_sub" id="S4.T3.18.18.18.2.2"><span class="ltx_text ltx_font_italic" id="S4.T3.18.18.18.2.2.1" style="font-size:80%;">15.39</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.19.19.19.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.19.19.19.3.1" style="font-size:80%;">38.68</span><sub class="ltx_sub" id="S4.T3.19.19.19.3.2"><span class="ltx_text ltx_font_italic" id="S4.T3.19.19.19.3.2.1" style="font-size:80%;">11.83</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.20.20.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.20.20.20.4.1" style="font-size:80%;">41.37</span><sub class="ltx_sub" id="S4.T3.20.20.20.4.2"><span class="ltx_text ltx_font_italic" id="S4.T3.20.20.20.4.2.1" style="font-size:80%;">12.33</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.21.21.21.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.21.21.21.5.1" style="font-size:80%;">71.03</span><sub class="ltx_sub" id="S4.T3.21.21.21.5.2"><span class="ltx_text ltx_font_italic" id="S4.T3.21.21.21.5.2.1" style="font-size:80%;">5.31</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.22.22.22.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.22.22.22.6.1" style="font-size:80%;">75.07</span><sub class="ltx_sub" id="S4.T3.22.22.22.6.2"><span class="ltx_text ltx_font_italic" id="S4.T3.22.22.22.6.2.1" style="font-size:80%;">5.33</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.22.22.22.8" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.22.22.22.8.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.22.22.22.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.22.22.22.9.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.30.30.30">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.30.30.30.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.30.30.30.9.1" style="font-size:80%;">P2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.23.23.23.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.23.23.23.1.1" style="font-size:80%;">70.26</span><sub class="ltx_sub" id="S4.T3.23.23.23.1.2"><span class="ltx_text ltx_font_italic" id="S4.T3.23.23.23.1.2.1" style="font-size:80%;">12.98</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.24.24.24.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.24.24.24.2.1" style="font-size:80%;">74.60</span><sub class="ltx_sub" id="S4.T3.24.24.24.2.2"><span class="ltx_text ltx_font_italic" id="S4.T3.24.24.24.2.2.1" style="font-size:80%;">13.35</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.25.25.25.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.25.25.25.3.1" style="font-size:80%;">72.51</span><sub class="ltx_sub" id="S4.T3.25.25.25.3.2"><span class="ltx_text ltx_font_italic" id="S4.T3.25.25.25.3.2.1" style="font-size:80%;">7.92</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.26.26.26.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.26.26.26.4.1" style="font-size:80%;">78.51</span><sub class="ltx_sub" id="S4.T3.26.26.26.4.2"><span class="ltx_text ltx_font_italic" id="S4.T3.26.26.26.4.2.1" style="font-size:80%;">7.85</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.27.27.27.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.27.27.27.5.1" style="font-size:80%;">65.23</span><sub class="ltx_sub" id="S4.T3.27.27.27.5.2"><span class="ltx_text ltx_font_italic" id="S4.T3.27.27.27.5.2.1" style="font-size:80%;">5.54</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.28.28.28.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.28.28.28.6.1" style="font-size:80%;">69.08</span><sub class="ltx_sub" id="S4.T3.28.28.28.6.2"><span class="ltx_text ltx_font_italic" id="S4.T3.28.28.28.6.2.1" style="font-size:80%;">5.68</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.29.29.29.7" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.29.29.29.7.1" style="font-size:80%;">80.92<sub class="ltx_sub" id="S4.T3.29.29.29.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.29.29.29.7.1.1.1">5.51</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.30.30.30.8" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.30.30.30.8.1" style="font-size:80%;">82.76<sub class="ltx_sub" id="S4.T3.30.30.30.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.30.30.30.8.1.1.1">5.44</span></sub></span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.36.36.36">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.36.36.36.7" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.36.36.36.7.1" style="font-size:80%;">P3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.31.31.31.1" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.31.31.31.1.1" style="font-size:80%;">78.42<sub class="ltx_sub" id="S4.T3.31.31.31.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.31.31.31.1.1.1.1">9.32</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.32.32.32.2" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.32.32.32.2.1" style="font-size:80%;">82.69<sub class="ltx_sub" id="S4.T3.32.32.32.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.32.32.32.2.1.1.1">9.50</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.33.33.33.3" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.33.33.33.3.1" style="font-size:80%;">77.12<sub class="ltx_sub" id="S4.T3.33.33.33.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.33.33.33.3.1.1.1">6.82</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.34.34.34.4" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.34.34.34.4.1" style="font-size:80%;">83.18<sub class="ltx_sub" id="S4.T3.34.34.34.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T3.34.34.34.4.1.1.1">6.70</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.35.35.35.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.35.35.35.5.1" style="font-size:80%;">65.35</span><sub class="ltx_sub" id="S4.T3.35.35.35.5.2"><span class="ltx_text ltx_font_italic" id="S4.T3.35.35.35.5.2.1" style="font-size:80%;">5.45</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.36.36.36.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.36.36.36.6.1" style="font-size:80%;">69.29</span><sub class="ltx_sub" id="S4.T3.36.36.36.6.2"><span class="ltx_text ltx_font_italic" id="S4.T3.36.36.36.6.2.1" style="font-size:80%;">5.55</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.36.36.36.8" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.36.36.36.8.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.36.36.36.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.36.36.36.9.1" style="font-size:80%;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.44.44.44">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.44.44.44.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.44.44.44.9.1" style="font-size:80%;">P4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.37.37.37.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.37.37.37.1.1" style="font-size:80%;">68.86</span><sub class="ltx_sub" id="S4.T3.37.37.37.1.2"><span class="ltx_text ltx_font_italic" id="S4.T3.37.37.37.1.2.1" style="font-size:80%;">17.18</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.38.38.38.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.38.38.38.2.1" style="font-size:80%;">72.31</span><sub class="ltx_sub" id="S4.T3.38.38.38.2.2"><span class="ltx_text ltx_font_italic" id="S4.T3.38.38.38.2.2.1" style="font-size:80%;">17.67</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.39.39.39.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.39.39.39.3.1" style="font-size:80%;">70.46</span><sub class="ltx_sub" id="S4.T3.39.39.39.3.2"><span class="ltx_text ltx_font_italic" id="S4.T3.39.39.39.3.2.1" style="font-size:80%;">9.04</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.40.40.40.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.40.40.40.4.1" style="font-size:80%;">75.69</span><sub class="ltx_sub" id="S4.T3.40.40.40.4.2"><span class="ltx_text ltx_font_italic" id="S4.T3.40.40.40.4.2.1" style="font-size:80%;">9.25</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.41.41.41.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.41.41.41.5.1" style="font-size:80%;">70.22</span><sub class="ltx_sub" id="S4.T3.41.41.41.5.2"><span class="ltx_text ltx_font_italic" id="S4.T3.41.41.41.5.2.1" style="font-size:80%;">5.46</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.42.42.42.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.42.42.42.6.1" style="font-size:80%;">74.07</span><sub class="ltx_sub" id="S4.T3.42.42.42.6.2"><span class="ltx_text ltx_font_italic" id="S4.T3.42.42.42.6.2.1" style="font-size:80%;">5.53</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.43.43.43.7" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.43.43.43.7.1" style="font-size:80%;">77.38</span><sub class="ltx_sub" id="S4.T3.43.43.43.7.2"><span class="ltx_text ltx_font_italic" id="S4.T3.43.43.43.7.2.1" style="font-size:80%;">5.76</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.44.44.44.8" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.44.44.44.8.1" style="font-size:80%;">79.19</span><sub class="ltx_sub" id="S4.T3.44.44.44.8.2"><span class="ltx_text ltx_font_italic" id="S4.T3.44.44.44.8.2.1" style="font-size:80%;">5.66</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.50.50.50">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.50.50.50.7" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.50.7.1" style="font-size:80%;">P5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.45.45.45.1" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.45.45.45.1.1" style="font-size:80%;">66.41</span><sub class="ltx_sub" id="S4.T3.45.45.45.1.2"><span class="ltx_text ltx_font_italic" id="S4.T3.45.45.45.1.2.1" style="font-size:80%;">18.18</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.46.46.46.2" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.46.46.46.2.1" style="font-size:80%;">69.99</span><sub class="ltx_sub" id="S4.T3.46.46.46.2.2"><span class="ltx_text ltx_font_italic" id="S4.T3.46.46.46.2.2.1" style="font-size:80%;">18.71</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.47.47.47.3" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.47.47.47.3.1" style="font-size:80%;">71.06</span><sub class="ltx_sub" id="S4.T3.47.47.47.3.2"><span class="ltx_text ltx_font_italic" id="S4.T3.47.47.47.3.2.1" style="font-size:80%;">8.68</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.48.48.48.4" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.48.48.48.4.1" style="font-size:80%;">76.46</span><sub class="ltx_sub" id="S4.T3.48.48.48.4.2"><span class="ltx_text ltx_font_italic" id="S4.T3.48.48.48.4.2.1" style="font-size:80%;">8.73</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.49.49.49.5" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.49.49.49.5.1" style="font-size:80%;">69.82</span><sub class="ltx_sub" id="S4.T3.49.49.49.5.2"><span class="ltx_text ltx_font_italic" id="S4.T3.49.49.49.5.2.1" style="font-size:80%;">5.31</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.50.50.50.6" style="padding-top:0.4pt;padding-bottom:0.4pt;">
<span class="ltx_text" id="S4.T3.50.50.50.6.1" style="font-size:80%;">73.78</span><sub class="ltx_sub" id="S4.T3.50.50.50.6.2"><span class="ltx_text ltx_font_italic" id="S4.T3.50.50.50.6.2.1" style="font-size:80%;">5.39</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.50.50.50.8" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.50.8.1" style="font-size:80%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.50.50.50.9" style="padding-top:0.4pt;padding-bottom:0.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.50.50.50.9.1" style="font-size:80%;">-</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.58.2.1" style="font-size:113%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.52.1" style="font-size:113%;">Effect of different text prompt templates on the segmentation performance (mean<sub class="ltx_sub" id="S4.T3.52.1.1"><span class="ltx_text ltx_font_italic" id="S4.T3.52.1.1.1">std</span></sub>)</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Component Ablation Analysis</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T4" title="Table 4 ‣ 4.3.2 Component Ablation Analysis ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a> shows the contribution of each component of our framework in improving the average segmentation performance on all datasets. Starting with saliency maps generated using the M2IB, we achieved a baseline DSC of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.1">46.23</span> and an NSD of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.2">50.50</span>, providing an initial focus on key regions of interest. Fine-tuning BiomedCLIP with the proposed DHN-NCE loss raised the DSC to <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.3">49.43</span> and the NSD to <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.4">53.54</span>. Post-processing the saliency maps with k-means clustering further enhanced the segmentation quality, allowing the model to better delineate foreground and background areas by refining the initial segmentation boundaries. Incorporating a filtering step greatly impacted the results, increasing the DSC to <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.5">58.80</span> and the NSD to <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.6">63.10</span>, as it eliminated small, irrelevant clusters and reduced noise, improving overall precision. With the integration of SAM and the use of visual prompts, such as bounding boxes or points, our zero-shot method yielded a substantial improvement, achieving a DSC of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.7">78.21</span> and an NSD of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.8">82.57</span>. Finally, weakly supervised training with checkpoint ensembling further refined the segmentation quality by leveraging pseudo-labels generated from the zero-shot method. By using these pseudo-labels to fine-tune a segmentation network, we were able to reach a final DSC of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.9">82.11</span> and an NSD of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p1.1.10">87.33</span>.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.14" style="width:216.8pt;height:127.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.3pt,-0.8pt) scale(1.0119938369545,1.0119938369545) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.14.14">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.2.2.2.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.2.2.2.3.1" style="font-size:80%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.1" style="font-size:80%;">DSC<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T4.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.1.m1.1d">↑</annotation></semantics></math></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.2.2.2" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.2.2.2.2.1" style="font-size:80%;">NSD<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.1.m1.1"><semantics id="S4.T4.2.2.2.2.1.m1.1a"><mo id="S4.T4.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T4.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.1.m1.1b"><ci id="S4.T4.2.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.1.m1.1d">↑</annotation></semantics></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.4.4.4.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.4.4.4.3.1" style="font-size:80%;">1: Saliency Maps</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.3.3.3.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.3.3.3.1.1" style="font-size:80%;">46.23</span><sub class="ltx_sub" id="S4.T4.3.3.3.1.2"><span class="ltx_text ltx_font_italic" id="S4.T4.3.3.3.1.2.1" style="font-size:80%;">6.58</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.4.4.4.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.4.4.4.2.1" style="font-size:80%;">50.50</span><sub class="ltx_sub" id="S4.T4.4.4.4.2.2"><span class="ltx_text ltx_font_italic" id="S4.T4.4.4.4.2.2.1" style="font-size:80%;">6.86</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.6.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.6.6.6.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.6.6.6.3.1" style="font-size:80%;">2: + DHN-NCE Fine-tuning</span></th>
<td class="ltx_td ltx_align_left" id="S4.T4.5.5.5.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.5.5.5.1.1" style="font-size:80%;">49.10</span><sub class="ltx_sub" id="S4.T4.5.5.5.1.2"><span class="ltx_text ltx_font_italic" id="S4.T4.5.5.5.1.2.1" style="font-size:80%;">5.46</span></sub>
</td>
<td class="ltx_td ltx_align_left" id="S4.T4.6.6.6.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.6.6.6.2.1" style="font-size:80%;">53.54</span><sub class="ltx_sub" id="S4.T4.6.6.6.2.2"><span class="ltx_text ltx_font_italic" id="S4.T4.6.6.6.2.2.1" style="font-size:80%;">5.62</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.8.8.8.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.8.8.8.3.1" style="font-size:80%;">3: + K-Means Post-processing</span></th>
<td class="ltx_td ltx_align_left" id="S4.T4.7.7.7.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.7.7.7.1.1" style="font-size:80%;">52.14</span><sub class="ltx_sub" id="S4.T4.7.7.7.1.2"><span class="ltx_text ltx_font_italic" id="S4.T4.7.7.7.1.2.1" style="font-size:80%;">4.27</span></sub>
</td>
<td class="ltx_td ltx_align_left" id="S4.T4.8.8.8.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.8.8.8.2.1" style="font-size:80%;">55.89</span><sub class="ltx_sub" id="S4.T4.8.8.8.2.2"><span class="ltx_text ltx_font_italic" id="S4.T4.8.8.8.2.2.1" style="font-size:80%;">4.40</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.10.10.10.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.10.10.10.3.1" style="font-size:80%;">4: + Area-based Filtering</span></th>
<td class="ltx_td ltx_align_left" id="S4.T4.9.9.9.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.9.9.9.1.1" style="font-size:80%;">58.80</span><sub class="ltx_sub" id="S4.T4.9.9.9.1.2"><span class="ltx_text ltx_font_italic" id="S4.T4.9.9.9.1.2.1" style="font-size:80%;">4.73</span></sub>
</td>
<td class="ltx_td ltx_align_left" id="S4.T4.10.10.10.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T4.10.10.10.2.1" style="font-size:80%;">63.10</span><sub class="ltx_sub" id="S4.T4.10.10.10.2.2"><span class="ltx_text ltx_font_italic" id="S4.T4.10.10.10.2.2.1" style="font-size:80%;">4.95</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.12.12.12" style="background-color:#EBEBEB;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T4.12.12.12.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.12.12.12.3.1" style="font-size:80%;background-color:#EBEBEB;">5: + SAM</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.11.11.11.1" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.11.11.11.1.1" style="font-size:80%;background-color:#EBEBEB;">78.21<sub class="ltx_sub" id="S4.T4.11.11.11.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T4.11.11.11.1.1.1.1">5.70</span></sub></span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.12.12.12.2" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.12.12.12.2.1" style="font-size:80%;background-color:#EBEBEB;">82.57<sub class="ltx_sub" id="S4.T4.12.12.12.2.1.1"><span class="ltx_text ltx_font_italic" id="S4.T4.12.12.12.2.1.1.1">5.55</span></sub></span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.14.14.14" style="background-color:#D4D4D4;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.14.14.14.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T4.14.14.14.3.1" style="font-size:80%;background-color:#D4D4D4;">6: + nnUNet Ensemble</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.13.13.13.1" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.13.13.13.1.1" style="font-size:80%;background-color:#D4D4D4;">82.11<sub class="ltx_sub" id="S4.T4.13.13.13.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T4.13.13.13.1.1.1.1">7.77</span></sub></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.14.14.14.2" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.14.14.14.2.1" style="font-size:80%;background-color:#D4D4D4;">87.33<sub class="ltx_sub" id="S4.T4.14.14.14.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T4.14.14.14.2.1.1.1">7.70</span></sub></span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.22.2.1" style="font-size:113%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.16.1" style="font-size:113%;">Effect of different components (mean<sub class="ltx_sub" id="S4.T4.16.1.1"><span class="ltx_text ltx_font_italic" id="S4.T4.16.1.1.1">std</span></sub>)</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Effect of Saliency Maps</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.2">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T5" title="Table 5 ‣ 4.3.3 Effect of Saliency Maps ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">5</span></a>, M2IB achieved the highest performance across all tasks, with an average DSC of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.2.1">78.21</span> and NSD of <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.2.2">82.57</span> when using the fine-tuned BiomedCLIP model. In both its pre-trained and fine-tuned forms, M2IB significantly outperformed gScoreCAM and GradCAM (<math alttext="p" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.1.m1.1"><semantics id="S4.SS3.SSS3.p1.1.m1.1a"><mi id="S4.SS3.SSS3.p1.1.m1.1.1" xref="S4.SS3.SSS3.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.1.m1.1b"><ci id="S4.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS3.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.1.m1.1d">italic_p</annotation></semantics></math> <math alttext="&lt;" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.2.m2.1"><semantics id="S4.SS3.SSS3.p1.2.m2.1a"><mo id="S4.SS3.SSS3.p1.2.m2.1.1" xref="S4.SS3.SSS3.p1.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS3.p1.2.m2.1b"><lt id="S4.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS3.p1.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS3.p1.2.m2.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS3.p1.2.m2.1d">&lt;</annotation></semantics></math> 0.05). BiomedCLIP fine-tuning improved the scores across all saliency map techniques on average, with the largest gains seen in M2IB, which improved by <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.2.3">3.98</span> in DSC and <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS3.p1.2.4">4.10</span> in NSD compared to its pre-trained version.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.14" style="width:216.8pt;height:145.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(1.2pt,-0.8pt) scale(1.01073607336157,1.01073607336157) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.14.14">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.14.14.15.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.14.14.15.1.1" rowspan="2" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.14.14.15.1.1.1" style="font-size:80%;">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T5.14.14.15.1.2" rowspan="2" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.14.14.15.1.2.1" style="font-size:80%;">Technique</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T5.14.14.15.1.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T5.14.14.15.1.3.1" style="font-size:80%;">All</span></th>
</tr>
<tr class="ltx_tr" id="S4.T5.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T5.1.1.1.1.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.1.1.1.1.m1.1"><semantics id="S4.T5.1.1.1.1.m1.1a"><mo id="S4.T5.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T5.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.2.2.2.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T5.2.2.2.2.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T5.2.2.2.2.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T5.2.2.2.2.m1.1"><semantics id="S4.T5.2.2.2.2.m1.1a"><mo id="S4.T5.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T5.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.2.m1.1b"><ci id="S4.T5.2.2.2.2.m1.1.1.cmml" xref="S4.T5.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T5.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T5.4.4.4.3" rowspan="3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.4.4.4.3.1" style="font-size:80%;">
<span class="ltx_inline-block ltx_align_left" id="S4.T5.4.4.4.3.1.1">
<span class="ltx_p" id="S4.T5.4.4.4.3.1.1.1">Pre-trained</span>
<span class="ltx_p" id="S4.T5.4.4.4.3.1.1.2">BiomedCLIP</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T5.4.4.4.4" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.4.4.4.4.1" style="font-size:80%;">M2IB</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.3.3.3.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.3.3.3.1.1" style="font-size:80%;">74.23</span><sub class="ltx_sub" id="S4.T5.3.3.3.1.2"><span class="ltx_text ltx_font_italic" id="S4.T5.3.3.3.1.2.1" style="font-size:80%;">6.14</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.4.4.4.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.4.4.4.2.1" style="font-size:80%;">78.47</span><sub class="ltx_sub" id="S4.T5.4.4.4.2.2"><span class="ltx_text ltx_font_italic" id="S4.T5.4.4.4.2.2.1" style="font-size:80%;">6.02</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.6.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T5.6.6.6.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.6.6.6.3.1" style="font-size:80%;">gScoreCAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T5.5.5.5.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.5.5.5.1.1" style="font-size:80%;">59.86</span><sub class="ltx_sub" id="S4.T5.5.5.5.1.2"><span class="ltx_text ltx_font_italic" id="S4.T5.5.5.5.1.2.1" style="font-size:80%;">6.02</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.6.6.6.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.6.6.6.2.1" style="font-size:80%;">62.96</span><sub class="ltx_sub" id="S4.T5.6.6.6.2.2"><span class="ltx_text ltx_font_italic" id="S4.T5.6.6.6.2.2.1" style="font-size:80%;">5.86</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.8.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T5.8.8.8.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.8.8.8.3.1" style="font-size:80%;">GradCAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T5.7.7.7.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.7.7.7.1.1" style="font-size:80%;">28.78</span><sub class="ltx_sub" id="S4.T5.7.7.7.1.2"><span class="ltx_text ltx_font_italic" id="S4.T5.7.7.7.1.2.1" style="font-size:80%;">8.59</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.8.8.8.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.8.8.8.2.1" style="font-size:80%;">31.87</span><sub class="ltx_sub" id="S4.T5.8.8.8.2.2"><span class="ltx_text ltx_font_italic" id="S4.T5.8.8.8.2.2.1" style="font-size:80%;">8.34</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.10.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T5.10.10.10.3" rowspan="3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.10.10.10.3.1" style="font-size:80%;">
<span class="ltx_inline-block ltx_align_left" id="S4.T5.10.10.10.3.1.1">
<span class="ltx_p" id="S4.T5.10.10.10.3.1.1.1">Fine-tuned</span>
<span class="ltx_p" id="S4.T5.10.10.10.3.1.1.2">BiomedCLIP</span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T5.10.10.10.4" style="background-color:#E6E6E6;padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.10.10.10.4.1" style="font-size:80%;background-color:#E6E6E6;">M2IB</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.9.9.9.1" style="background-color:#E6E6E6;padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.9.9.9.1.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T5.9.9.9.1.1.1">78.21<sub class="ltx_sub" id="S4.T5.9.9.9.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T5.9.9.9.1.1.1.1.1">5.70</span></sub></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.10.10.10.2" style="background-color:#E6E6E6;padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.10.10.10.2.1" style="font-size:80%;background-color:#E6E6E6;"><span class="ltx_text ltx_font_bold" id="S4.T5.10.10.10.2.1.1">82.57<sub class="ltx_sub" id="S4.T5.10.10.10.2.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T5.10.10.10.2.1.1.1.1">5.55</span></sub></span></span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.12.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T5.12.12.12.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.12.12.12.3.1" style="font-size:80%;">gScoreCAM</span></th>
<td class="ltx_td ltx_align_center" id="S4.T5.11.11.11.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.11.11.11.1.1" style="font-size:80%;">61.73</span><sub class="ltx_sub" id="S4.T5.11.11.11.1.2"><span class="ltx_text ltx_font_italic" id="S4.T5.11.11.11.1.2.1" style="font-size:80%;">6.22</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T5.12.12.12.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.12.12.12.2.1" style="font-size:80%;">64.99</span><sub class="ltx_sub" id="S4.T5.12.12.12.2.2"><span class="ltx_text ltx_font_italic" id="S4.T5.12.12.12.2.2.1" style="font-size:80%;">6.09</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T5.14.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T5.14.14.14.3" style="padding:0.4pt 8.0pt;"><span class="ltx_text" id="S4.T5.14.14.14.3.1" style="font-size:80%;">GradCAM</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.13.13.13.1" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.13.13.13.1.1" style="font-size:80%;">30.60</span><sub class="ltx_sub" id="S4.T5.13.13.13.1.2"><span class="ltx_text ltx_font_italic" id="S4.T5.13.13.13.1.2.1" style="font-size:80%;">8.90</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.14.14.14.2" style="padding:0.4pt 8.0pt;">
<span class="ltx_text" id="S4.T5.14.14.14.2.1" style="font-size:80%;">33.81</span><sub class="ltx_sub" id="S4.T5.14.14.14.2.2"><span class="ltx_text ltx_font_italic" id="S4.T5.14.14.14.2.2.1" style="font-size:80%;">8.73</span></sub>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.22.2.1" style="font-size:113%;">Table 5</span>: </span><span class="ltx_text" id="S4.T5.16.1" style="font-size:113%;">Comparison between different Saliency Map techniques as well as the pre-trained and fine-tuned BiomedCLIP on the overall performance (mean<sub class="ltx_sub" id="S4.T5.16.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.16.1.1.1">std</span></sub>)</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="447" id="S4.F2.g1" src="x2.png" width="749"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Qualitative comparison of segmentation results. Coarse=K-means post-processed saliency map, WSS=Weakly Supervised Segmentation and GT=Ground Truth. The uncertainty map corresponds to the weakly supervised segmentation.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T6.64" style="width:433.6pt;height:164pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(2.7pt,-1.0pt) scale(1.01253993431217,1.01253993431217) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T6.64.64">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.64.64.65.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.64.64.65.1.1" rowspan="2" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.1.1" style="font-size:80%;">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.64.64.65.1.2" rowspan="2" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.2.1" style="font-size:80%;">Type</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.64.64.65.1.3" rowspan="2" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.3.1" style="font-size:80%;">Prompts</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T6.64.64.65.1.4" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.4.1" style="font-size:80%;">Breast Ultrasound</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T6.64.64.65.1.5" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.5.1" style="font-size:80%;">Brain MRI</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T6.64.64.65.1.6" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.6.1" style="font-size:80%;">Lung X-ray</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T6.64.64.65.1.7" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.64.64.65.1.7.1" style="font-size:80%;">Lung CT</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.1.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.1.1.1.1.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T6.1.1.1.1.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.1.1.1.1.m1.1"><semantics id="S4.T6.1.1.1.1.m1.1a"><mo id="S4.T6.1.1.1.1.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.2.2.2.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.2.2.2.2.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T6.2.2.2.2.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.2.2.2.2.m1.1"><semantics id="S4.T6.2.2.2.2.m1.1a"><mo id="S4.T6.2.2.2.2.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.2.2.m1.1b"><ci id="S4.T6.2.2.2.2.m1.1.1.cmml" xref="S4.T6.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.3.3.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.3.3.3.3.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T6.3.3.3.3.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.3.3.3.3.m1.1"><semantics id="S4.T6.3.3.3.3.m1.1a"><mo id="S4.T6.3.3.3.3.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.3.3.m1.1b"><ci id="S4.T6.3.3.3.3.m1.1.1.cmml" xref="S4.T6.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.4.4.4.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.4.4.4.4.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T6.4.4.4.4.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.4.4.4.4.m1.1"><semantics id="S4.T6.4.4.4.4.m1.1a"><mo id="S4.T6.4.4.4.4.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.4.4.m1.1b"><ci id="S4.T6.4.4.4.4.m1.1.1.cmml" xref="S4.T6.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.5.5.5.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.5.5.5.5.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T6.5.5.5.5.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.5.5.5.5.m1.1"><semantics id="S4.T6.5.5.5.5.m1.1a"><mo id="S4.T6.5.5.5.5.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.5.5.5.5.m1.1b"><ci id="S4.T6.5.5.5.5.m1.1.1.cmml" xref="S4.T6.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.5.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.6.6.6.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.6.6.6.6.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T6.6.6.6.6.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.6.6.6.6.m1.1"><semantics id="S4.T6.6.6.6.6.m1.1a"><mo id="S4.T6.6.6.6.6.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.6.6.6.6.m1.1b"><ci id="S4.T6.6.6.6.6.m1.1.1.cmml" xref="S4.T6.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.7.7.7.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.7.7.7.7.1" style="font-size:80%;">DSC</span><span class="ltx_text" id="S4.T6.7.7.7.7.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.7.7.7.7.m1.1"><semantics id="S4.T6.7.7.7.7.m1.1a"><mo id="S4.T6.7.7.7.7.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.7.7.7.7.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.7.7.7.7.m1.1b"><ci id="S4.T6.7.7.7.7.m1.1.1.cmml" xref="S4.T6.7.7.7.7.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.7.7.7.7.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.7.7.7.7.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.8.8.8.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text ltx_font_bold" id="S4.T6.8.8.8.8.1" style="font-size:80%;">NSD</span><span class="ltx_text" id="S4.T6.8.8.8.8.2" style="font-size:80%;"> </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T6.8.8.8.8.m1.1"><semantics id="S4.T6.8.8.8.8.m1.1a"><mo id="S4.T6.8.8.8.8.m1.1.1" mathsize="80%" stretchy="false" xref="S4.T6.8.8.8.8.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T6.8.8.8.8.m1.1b"><ci id="S4.T6.8.8.8.8.m1.1.1.cmml" xref="S4.T6.8.8.8.8.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.8.8.8.8.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T6.8.8.8.8.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.16.16.16">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.16.16.16.9" rowspan="3" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.16.16.16.9.1" style="font-size:80%;">SAM</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.16.16.16.10" rowspan="3" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.16.16.16.10.1" style="font-size:80%;">ViT-H</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.16.16.16.11" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.16.16.16.11.1" style="font-size:80%;">Points</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.9.9.9.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.9.9.9.1.1" style="font-size:80%;">66.30</span><sub class="ltx_sub" id="S4.T6.9.9.9.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.9.9.9.1.2.1" style="font-size:80%;">5.76</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.10.10.10.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.10.10.10.2.1" style="font-size:80%;">69.85</span><sub class="ltx_sub" id="S4.T6.10.10.10.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.10.10.10.2.2.1" style="font-size:80%;">5.90</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.11.11.11.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.11.11.11.3.1" style="font-size:80%;">66.90</span><sub class="ltx_sub" id="S4.T6.11.11.11.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.11.11.11.3.2.1" style="font-size:80%;">4.69</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.12.12.12.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.12.12.12.4.1" style="font-size:80%;">71.92</span><sub class="ltx_sub" id="S4.T6.12.12.12.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.12.12.12.4.2.1" style="font-size:80%;">4.83</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.13.13.13.5" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.13.13.13.5.1" style="font-size:80%;">76.39<sub class="ltx_sub" id="S4.T6.13.13.13.5.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.13.13.13.5.1.1.1">2.14</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.14.14.14.6" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.14.14.14.6.1" style="font-size:80%;">81.63<sub class="ltx_sub" id="S4.T6.14.14.14.6.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.14.14.14.6.1.1.1">2.15</span></sub></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.15.15.15.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.15.15.15.7.1" style="font-size:80%;">62.11</span><sub class="ltx_sub" id="S4.T6.15.15.15.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.15.15.15.7.2.1" style="font-size:80%;">5.25</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.16.16.16.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.16.16.16.8.1" style="font-size:80%;">64.63</span><sub class="ltx_sub" id="S4.T6.16.16.16.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.16.16.16.8.2.1" style="font-size:80%;">5.28</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.24.24.24">
<td class="ltx_td ltx_align_center" id="S4.T6.24.24.24.9" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.24.24.24.9.1" style="font-size:80%;">BBoxes</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.17.17.17.1" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.17.17.17.1.1" style="font-size:80%;">78.42<sub class="ltx_sub" id="S4.T6.17.17.17.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.17.17.17.1.1.1.1">9.32</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.18.18.18.2" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.18.18.18.2.1" style="font-size:80%;">82.69<sub class="ltx_sub" id="S4.T6.18.18.18.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.18.18.18.2.1.1.1">9.50</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.19.19.19.3" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.19.19.19.3.1" style="font-size:80%;">77.12<sub class="ltx_sub" id="S4.T6.19.19.19.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.19.19.19.3.1.1.1">6.82</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.20.20.20.4" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.20.20.20.4.1" style="font-size:80%;">83.18<sub class="ltx_sub" id="S4.T6.20.20.20.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.20.20.20.4.1.1.1">6.70</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.21.21.21.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.21.21.21.5.1" style="font-size:80%;">72.40</span><sub class="ltx_sub" id="S4.T6.21.21.21.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.21.21.21.5.2.1" style="font-size:80%;">4.72</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.22.22.22.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.22.22.22.6.1" style="font-size:80%;">76.38</span><sub class="ltx_sub" id="S4.T6.22.22.22.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.22.22.22.6.2.1" style="font-size:80%;">4.76</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.23.23.23.7" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.23.23.23.7.1" style="font-size:80%;">80.92<sub class="ltx_sub" id="S4.T6.23.23.23.7.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.23.23.23.7.1.1.1">5.51</span></sub></span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.24.24.24.8" style="padding:0.4pt 4.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T6.24.24.24.8.1" style="font-size:80%;">82.76<sub class="ltx_sub" id="S4.T6.24.24.24.8.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T6.24.24.24.8.1.1.1">5.44</span></sub></span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.32.32.32">
<td class="ltx_td ltx_align_center" id="S4.T6.32.32.32.9" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.32.32.32.9.1" style="font-size:80%;">Points + BBoxes</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.25.25.25.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.25.25.25.1.1" style="font-size:80%;">75.64</span><sub class="ltx_sub" id="S4.T6.25.25.25.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.25.25.25.1.2.1" style="font-size:80%;">5.57</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.26.26.26.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.26.26.26.2.1" style="font-size:80%;">79.60</span><sub class="ltx_sub" id="S4.T6.26.26.26.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.26.26.26.2.2.1" style="font-size:80%;">5.62</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.27.27.27.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.27.27.27.3.1" style="font-size:80%;">76.04</span><sub class="ltx_sub" id="S4.T6.27.27.27.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.27.27.27.3.2.1" style="font-size:80%;">3.66</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.28.28.28.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.28.28.28.4.1" style="font-size:80%;">81.76</span><sub class="ltx_sub" id="S4.T6.28.28.28.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.28.28.28.4.2.1" style="font-size:80%;">3.64</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.29.29.29.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.29.29.29.5.1" style="font-size:80%;">76.22</span><sub class="ltx_sub" id="S4.T6.29.29.29.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.29.29.29.5.2.1" style="font-size:80%;">1.94</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.30.30.30.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.30.30.30.6.1" style="font-size:80%;">81.30</span><sub class="ltx_sub" id="S4.T6.30.30.30.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.30.30.30.6.2.1" style="font-size:80%;">1.93</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.31.31.31.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.31.31.31.7.1" style="font-size:80%;">63.84</span><sub class="ltx_sub" id="S4.T6.31.31.31.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.31.31.31.7.2.1" style="font-size:80%;">4.72</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.32.32.32.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.32.32.32.8.1" style="font-size:80%;">66.23</span><sub class="ltx_sub" id="S4.T6.32.32.32.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.32.32.32.8.2.1" style="font-size:80%;">4.71</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.40.40.40">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.40.40.40.9" rowspan="3" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.40.40.40.9.1" style="font-size:80%;">SAM-Med2D</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.40.40.40.10" rowspan="3" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.40.40.40.10.1" style="font-size:80%;">ViT-B</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.40.40.40.11" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.40.40.40.11.1" style="font-size:80%;">Points</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.33.33.33.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.33.33.33.1.1" style="font-size:80%;">74.52</span><sub class="ltx_sub" id="S4.T6.33.33.33.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.33.33.33.1.2.1" style="font-size:80%;">5.32</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.34.34.34.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.34.34.34.2.1" style="font-size:80%;">79.36</span><sub class="ltx_sub" id="S4.T6.34.34.34.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.34.34.34.2.2.1" style="font-size:80%;">6.45</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.35.35.35.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.35.35.35.3.1" style="font-size:80%;">68.68</span><sub class="ltx_sub" id="S4.T6.35.35.35.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.35.35.35.3.2.1" style="font-size:80%;">4.21</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.36.36.36.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.36.36.36.4.1" style="font-size:80%;">77.67</span><sub class="ltx_sub" id="S4.T6.36.36.36.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.36.36.36.4.2.1" style="font-size:80%;">3.87</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.37.37.37.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.37.37.37.5.1" style="font-size:80%;">61.70</span><sub class="ltx_sub" id="S4.T6.37.37.37.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.37.37.37.5.2.1" style="font-size:80%;">6.14</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.38.38.38.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.38.38.38.6.1" style="font-size:80%;">69.28</span><sub class="ltx_sub" id="S4.T6.38.38.38.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.38.38.38.6.2.1" style="font-size:80%;">5.91</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.39.39.39.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.39.39.39.7.1" style="font-size:80%;">67.40</span><sub class="ltx_sub" id="S4.T6.39.39.39.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.39.39.39.7.2.1" style="font-size:80%;">4.75</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.40.40.40.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.40.40.40.8.1" style="font-size:80%;">74.08</span><sub class="ltx_sub" id="S4.T6.40.40.40.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.40.40.40.8.2.1" style="font-size:80%;">6.33</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.48.48.48">
<td class="ltx_td ltx_align_center" id="S4.T6.48.48.48.9" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.48.48.48.9.1" style="font-size:80%;">BBoxes</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.41.41.41.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.41.41.41.1.1" style="font-size:80%;">76.20</span><sub class="ltx_sub" id="S4.T6.41.41.41.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.41.41.41.1.2.1" style="font-size:80%;">4.89</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.42.42.42.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.42.42.42.2.1" style="font-size:80%;">81.46</span><sub class="ltx_sub" id="S4.T6.42.42.42.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.42.42.42.2.2.1" style="font-size:80%;">5.74</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.43.43.43.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.43.43.43.3.1" style="font-size:80%;">56.00</span><sub class="ltx_sub" id="S4.T6.43.43.43.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.43.43.43.3.2.1" style="font-size:80%;">3.67</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.44.44.44.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.44.44.44.4.1" style="font-size:80%;">65.48</span><sub class="ltx_sub" id="S4.T6.44.44.44.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.44.44.44.4.2.1" style="font-size:80%;">6.58</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.45.45.45.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.45.45.45.5.1" style="font-size:80%;">31.60</span><sub class="ltx_sub" id="S4.T6.45.45.45.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.45.45.45.5.2.1" style="font-size:80%;">3.92</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.46.46.46.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.46.46.46.6.1" style="font-size:80%;">37.75</span><sub class="ltx_sub" id="S4.T6.46.46.46.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.46.46.46.6.2.1" style="font-size:80%;">4.01</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.47.47.47.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.47.47.47.7.1" style="font-size:80%;">64.82</span><sub class="ltx_sub" id="S4.T6.47.47.47.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.47.47.47.7.2.1" style="font-size:80%;">5.43</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.48.48.48.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.48.48.48.8.1" style="font-size:80%;">69.80</span><sub class="ltx_sub" id="S4.T6.48.48.48.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.48.48.48.8.2.1" style="font-size:80%;">6.27</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.56.56.56">
<td class="ltx_td ltx_align_center" id="S4.T6.56.56.56.9" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.56.56.56.9.1" style="font-size:80%;">Points + BBoxes</span></td>
<td class="ltx_td ltx_align_center" id="S4.T6.49.49.49.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.49.49.49.1.1" style="font-size:80%;">75.96</span><sub class="ltx_sub" id="S4.T6.49.49.49.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.49.49.49.1.2.1" style="font-size:80%;">5.11</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.50.50.50.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.50.50.50.2.1" style="font-size:80%;">80.59</span><sub class="ltx_sub" id="S4.T6.50.50.50.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.50.50.50.2.2.1" style="font-size:80%;">3.86</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.51.51.51.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.51.51.51.3.1" style="font-size:80%;">69.03</span><sub class="ltx_sub" id="S4.T6.51.51.51.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.51.51.51.3.2.1" style="font-size:80%;">4.32</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.52.52.52.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.52.52.52.4.1" style="font-size:80%;">78.06</span><sub class="ltx_sub" id="S4.T6.52.52.52.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.52.52.52.4.2.1" style="font-size:80%;">6.02</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.53.53.53.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.53.53.53.5.1" style="font-size:80%;">38.97</span><sub class="ltx_sub" id="S4.T6.53.53.53.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.53.53.53.5.2.1" style="font-size:80%;">5.38</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.54.54.54.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.54.54.54.6.1" style="font-size:80%;">46.67</span><sub class="ltx_sub" id="S4.T6.54.54.54.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.54.54.54.6.2.1" style="font-size:80%;">6.49</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.55.55.55.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.55.55.55.7.1" style="font-size:80%;">72.70</span><sub class="ltx_sub" id="S4.T6.55.55.55.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.55.55.55.7.2.1" style="font-size:80%;">5.07</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T6.56.56.56.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.56.56.56.8.1" style="font-size:80%;">79.75</span><sub class="ltx_sub" id="S4.T6.56.56.56.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.56.56.56.8.2.1" style="font-size:80%;">4.73</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T6.64.64.64">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.64.64.64.9" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.64.64.64.9.1" style="font-size:80%;">MedSAM</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.64.64.64.10" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.64.64.64.10.1" style="font-size:80%;">ViT-B</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.64.64.64.11" style="padding:0.4pt 4.0pt;"><span class="ltx_text" id="S4.T6.64.64.64.11.1" style="font-size:80%;">BBoxes</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.57.57.57.1" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.57.57.57.1.1" style="font-size:80%;">65.18</span><sub class="ltx_sub" id="S4.T6.57.57.57.1.2"><span class="ltx_text ltx_font_italic" id="S4.T6.57.57.57.1.2.1" style="font-size:80%;">9.45</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.58.58.58.2" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.58.58.58.2.1" style="font-size:80%;">69.22</span><sub class="ltx_sub" id="S4.T6.58.58.58.2.2"><span class="ltx_text ltx_font_italic" id="S4.T6.58.58.58.2.2.1" style="font-size:80%;">9.51</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.59.59.59.3" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.59.59.59.3.1" style="font-size:80%;">68.91</span><sub class="ltx_sub" id="S4.T6.59.59.59.3.2"><span class="ltx_text ltx_font_italic" id="S4.T6.59.59.59.3.2.1" style="font-size:80%;">7.54</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.60.60.60.4" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.60.60.60.4.1" style="font-size:80%;">75.12</span><sub class="ltx_sub" id="S4.T6.60.60.60.4.2"><span class="ltx_text ltx_font_italic" id="S4.T6.60.60.60.4.2.1" style="font-size:80%;">7.60</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.61.61.61.5" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.61.61.61.5.1" style="font-size:80%;">74.30</span><sub class="ltx_sub" id="S4.T6.61.61.61.5.2"><span class="ltx_text ltx_font_italic" id="S4.T6.61.61.61.5.2.1" style="font-size:80%;">4.94</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.62.62.62.6" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.62.62.62.6.1" style="font-size:80%;">77.81</span><sub class="ltx_sub" id="S4.T6.62.62.62.6.2"><span class="ltx_text ltx_font_italic" id="S4.T6.62.62.62.6.2.1" style="font-size:80%;">4.82</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.63.63.63.7" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.63.63.63.7.1" style="font-size:80%;">63.69</span><sub class="ltx_sub" id="S4.T6.63.63.63.7.2"><span class="ltx_text ltx_font_italic" id="S4.T6.63.63.63.7.2.1" style="font-size:80%;">7.40</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.64.64.64.8" style="padding:0.4pt 4.0pt;">
<span class="ltx_text" id="S4.T6.64.64.64.8.1" style="font-size:80%;">66.10</span><sub class="ltx_sub" id="S4.T6.64.64.64.8.2"><span class="ltx_text ltx_font_italic" id="S4.T6.64.64.64.8.2.1" style="font-size:80%;">7.28</span></sub>
</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T6.72.2.1" style="font-size:113%;">Table 6</span>: </span><span class="ltx_text" id="S4.T6.66.1" style="font-size:113%;">Comparison between different SAM pre-trained models and visual prompting techniques (mean<sub class="ltx_sub" id="S4.T6.66.1.1"><span class="ltx_text ltx_font_italic" id="S4.T6.66.1.1.1">std</span></sub>)</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.4 </span>SAM and Visual Prompting Comparison</h4>
<div class="ltx_para" id="S4.SS3.SSS4.p1">
<p class="ltx_p" id="S4.SS3.SSS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.T6" title="Table 6 ‣ 4.3.3 Effect of Saliency Maps ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">6</span></a> compares different SAM models and visual prompting techniques. We see that bounding boxes generally provided the best segmentation performance, except in Lung X-rays, where adding point prompts enhanced results. On the other hand, point prompts alone performed worse while combining points and bounding boxes slightly improved the results in some tasks, such as Lung X-ray (<span class="ltx_text ltx_font_bold" id="S4.SS3.SSS4.p1.1.1">76.22</span> DSC, <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS4.p1.1.2">81.30</span> NSD). In addition, the comparison of SAM, MedSAM, and SAM-Med2D demonstrates that SAM, despite not being pre-trained on medical data, performs well with bounding box prompts, achieving high scores in most modalities/tasks, including Lung CT. SAM-Med2D excels in fine-scaled segmentation, but struggles with larger structures, like lung lobes, where MedSAM performs better. The superior performance of SAM may be attributed to its use of a larger model architecture (ViT-H) compared to MedSAM and SAM-Med2D, which only offer ViT-B configurations.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Qualitative Segmentation Results</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Lastly, we present qualitative segmentation results across the four imaging modalities evaluated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.F2" title="Figure 2 ‣ 4.3.3 Effect of Saliency Maps ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>. Our proposed MedCLIP-SAMv2 consistently produced high-quality segmentation masks in weakly supervised settings. For all datasets except Brain MRI, the initial coarse segmentation was suboptimal. However, it provided a sufficient starting point for the zero-shot approach to refine coarse activation maps. For breast and brain tumors, the zero-shot results were notably better than those for Lung CT and Lung X-ray. In Lung CT, the primary challenge for the algorithm was distinguishing between the two lobes. The post-processed results showed one large, connected contour in the center. The zero-shot refinement slightly separated these two regions, though some artifacts persisted. However, the weakly supervised training effectively corrected these false activations, producing a high-quality segmentation map. For Lung X-ray, while the weakly supervised training improved upon the less precise zero-shot masks, the improvement was not as substantial as with Lung CT. Furthermore, we also included uncertainty maps for all predictions. For Brain MRI, high uncertainty was observed only at the edges of the segmentation, which is typical. For Breast Ultrasound, high uncertainty was observed at the borders of the segmentation, while the surrounding area outside the borders showed low uncertainty. In contrast, for Lung X-rays, slight uncertainty appeared in the center of the mask, increasing towards the edges. In the case of Lung CT, high uncertainty was observed both at the edges and in the center of the lung lobes. This was largely due to the artifacts present in the zero-shot pseudo-labels.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">The presented MedCLIP-SAMv2 framework demonstrates superior performance in zero-shot and weakly supervised medical image segmentation tasks across four critical medical imaging modalities: CT, MRI, Ultrasound, and X-ray. By leveraging BiomedCLIP and SAM with visual and text prompts, our method exhibits robust generalization, excelling in complex tasks such as brain and breast tumor segmentation, where smaller and intricate anatomical details pose challenges. This approach notably surpasses other SOTA zero-shot and few-shot methods, especially in difficult segmentation scenarios (see Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S3.T1" title="Table 1 ‣ 3.3.2 Image segmentation accuracy ‣ 3.3 Datasets and Experimental Setup ‣ 3 Methods ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>). Recent methods like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#bib.bib56" title="">56</a>]</cite> have demonstrated the potential of CLIP for zero-shot segmentation by decoupling the pixel-level and image-level classification tasks. However, such methods require fully supervised segmentation ground truth, limiting their application in settings where labels are scarce or noisy. In contrast, MedCLIP-SAMv2 bypasses this requirement and operates without relying on segmentation labels during training, offering a more scalable approach for medical imaging, particularly in weakly supervised settings.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">One of the key strengths of our framework lies in the integration of the novel M2IB, which effectively extracts meaningful information from medical images and texts, enhancing segmentation performance. The introduction of the DHN-NCE loss played a crucial role in fine-tuning BiomedCLIP, enabling the model to focus on challenging details while maintaining high performance across all tasks and modalities. Importantly, the combination of M2IB and DHN-NCE allowed the model to generate coarse segmentation masks that are later refined via SAM in a zero-shot setting, proving the versatility of the method without the need for ground truth annotations. The effectiveness of prompt design was another critical insight. Contextually rich, descriptive prompts yielded better results in complex tasks like tumor segmentation, where finer anatomical understanding is required. Conversely, more generic prompts sufficed for simpler tasks like lung segmentation, where larger, distinct structures allowed the model to achieve strong performance with less specific guidance.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Our framework’s ability to operate in a weakly supervised paradigm further strengthens its potential clinical applicability. By using pseudo-labels from zero-shot segmentation to fine-tune the model, we saw notable improvements, particularly in lung CT segmentation, where the combination of zero-shot labels and weak supervision generated significant accuracy gains. To the best of our knowledge, we are the first to integrate uncertainty estimation through nnUNet with checkpoint ensembling by training on pseudo-segmentation data, providing a robust method for enhancing segmentation quality while offering insights into prediction confidence. Uncertainty measures are essential in clinical adoption, as they help identify regions where the model’s predictions are less certain, enabling clinicians to focus on areas that may require further examination or validation.</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1">Despite the original SAM model not being pre-trained on medical images, it showed strong performance in zero-shot settings, outperforming MedSAM and SAM-Med2D when provided with imperfect visual prompts like points or bounding boxes. This underscores the robustness of SAM to sub-optimal input conditions. Specifically, this can be seen in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.19483v2#S4.F2" title="Figure 2 ‣ 4.3.3 Effect of Saliency Maps ‣ 4.3 Ablation Experiments ‣ 4 Results ‣ MedCLIP-SAMv2: Towards Universal Text-Driven Medical Image Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a> where even suboptimal coarse segmentations can be refined using both zero-shot and weakly supervised methods. Looking ahead, future work will focus on extending our framework to handle 3D medical data, a crucial step in advancing the segmentation of volumetric imaging modalities like MRI and CT. Incorporating 3D models will enable our framework to better capture complex anatomical structures, further enhancing its clinical utility. Overall, our findings show that MedCLIP-SAMv2, with its novel integrated components, marks a significant step forward in the development of universal, interactive medical image segmentation. The framework’s adaptability across different tasks and its ability to operate with minimal labeled data emphasize its potential for clinical adoption, particularly in resource-constrained environments.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">We presented MedCLIP-SAMv2, a refined version of the original MedCLIP-SAM framework, improving segmentation performance with minimal supervision across CT, X-ray, Ultrasound, and MRI. By introducing the novel DHN-NCE loss for fine-tuning BiomedCLIP and leveraging SAM, our model achieved enhanced accuracy, particularly in complex tasks. MedCLIP-SAMv2 outperforms its predecessor through superior generalization and refined segmentation, demonstrating strong potential for clinical use in data-limited environments.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We acknowledge the support of the Natural Sciences and Engineering Research Council of Canada (NSERC).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Siuly and Y. Zhang, “Medical big data: neurological diseases diagnosis through medical data analysis,” <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Data Science and Engineering</span>, vol. 1, pp. 54–64, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Baevski, A. Babu, W.-N. Hsu, and M. Auli, “Efficient self-supervised learning with contextualized target representations for vision, speech and language,” in <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">International Conference on Machine Learning</span>, pp. 1416–1429, PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, K. Swersky, M. Norouzi, and G. E. Hinton, “Big self-supervised models are strong semi-supervised learners,” <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Advances in neural information processing systems</span>, vol. 33, pp. 22243–22255, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Taleb, C. Lippert, T. Klein, and M. Nabi, “Multimodal self-supervised learning for medical image analysis,” in <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">International conference on information processing in medical imaging</span>, pp. 661–673, Springer, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Loquercio, M. Segu, and D. Scaramuzza, “A general framework for uncertainty estimation in deep learning,” <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">IEEE Robotics and Automation Letters</span>, vol. 5, no. 2, pp. 3153–3160, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Liu, Z. Lin, S. Padhy, D. Tran, T. Bedrax Weiss, and B. Lakshminarayanan, “Simple and principled uncertainty estimation with deterministic deep learning via distance awareness,” <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</span>, vol. 33, pp. 7498–7512, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
N. Arun, N. Gaw, P. Singh, K. Chang, M. Aggarwal, B. Chen, K. Hoebel, S. Gupta, J. Patel, M. Gidwani, J. Adebayo, M. D. Li, and J. Kalpathy-Cramer, “Assessing the (un)trustworthiness of saliency maps for localizing abnormalities in medical imaging,” 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
W. Bae, J. Noh, and G. Kim, “Rethinking class activation mapping for weakly supervised object localization,” in <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XV 16</span>, pp. 618–634, Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, G. Krueger, and I. Sutskever, “Learning transferable visual models from natural language supervision,” 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao, S. Whitehead, A. C. Berg, W.-Y. Lo, P. Dollár, and R. Girshick, “Segment anything,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Zhang, Y. Xu, N. Usuyama, J. Bagga, R. Tinn, S. Preston, R. Rao, M. Wei, N. Valluri, C. Wong, M. P. Lungren, T. Naumann, and H. Poon, “Large-scale domain-specific pretraining for biomedical vision-language processing,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Ma and B. Wang, “Segment anything in medical images,” <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">ArXiv</span>, vol. abs/2304.12306, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Z. Chen, Q. Xu, X. Liu, and Y. Yuan, “Un-sam: Universal prompt-free segmentation for generalized nuclei images,” 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
X. Hu, X. Xu, and Y. Shi, “How to efficiently adapt large segmentation model(sam) to medical images,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Li, J. Cao, P. Ye, Y. Ding, C. Tu, and T. Chen, “Clipsam: Clip and sam collaboration for zero-shot anomaly segmentation,” 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. Li, H. Wang, Y. Duan, and X. Li, “Clip surgery for better explainability with enhancement in open-vocabulary tasks,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
X. Liu and X. Huang, “Weakly supervised salient object detection via bounding-box annotation and sam model,” <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Electronic Research Archive</span>, vol. 32, no. 3, pp. 1624–1645, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Yang and X. Gong, “Foundation model assisted weakly supervised semantic segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. Chen, Z. Mai, R. Li, and W. lun Chao, “Segment anything model (sam) enhanced pseudo labels for weakly supervised semantic segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Z. Huang, H. Liu, H. Zhang, X. Li, H. Liu, F. Xing, A. Laine, E. Angelini, C. Hendon, and Y. Gan, “Push the boundary of sam: A pseudo-label correction framework for medical segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
T. Koleilat, H. Asgariandehkordi, H. Rivaz, and Y. Xiao, “Medclip-sam: Bridging text and image towards universal medical image segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2403.20253</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
P. Chen, Q. Li, S. Biaz, T. Bui, and A. Nguyen, “gscorecam: What is clip looking at?,” in <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Proceedings of the Asian Conference on Computer Vision (ACCV)</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Wang, T. G. J. Rudner, and A. G. Wilson, “Visual explanations of image-text representations via multi-modal information bottleneck attribution,” 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
F. Isensee, P. F. Jaeger, S. A. Kohl, J. Petersen, and K. H. Maier-Hein, “nnu-net: a self-configuring method for deep learning-based biomedical image segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Nature methods</span>, vol. 18, no. 2, pp. 203–211, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. Zhao, C. Yang, A. Schweidtmann, and Q. Tao, “Efficient bayesian uncertainty estimation for nnu-net,” in <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">International Conference on Medical Image Computing and Computer-Assisted Intervention</span>, pp. 535–544, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
S. Eslami, C. Meinel, and G. de Melo, “PubMedCLIP: How much does CLIP benefit visual question answering in the medical domain?,” in <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Findings of the Association for Computational Linguistics: EACL 2023</span> (A. Vlachos and I. Augenstein, eds.), (Dubrovnik, Croatia), pp. 1181–1193, Association for Computational Linguistics, May 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z. Wang, Z. Wu, D. Agarwal, and J. Sun, “Medclip: Contrastive learning from unpaired medical images and text,” 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
R. Windsor, A. Jamaludin, T. Kadir, and A. Zisserman, “Vision-language modelling for radiological imaging and reports in the low data regime,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
C. Wu, X. Zhang, Y. Zhang, Y. Wang, and W. Xie, “Medklip: Medical knowledge enhanced language-image pre-training in radiology,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
M. Keicher, K. Zaripova, T. Czempiel, K. Mach, A. Khakzar, and N. Navab, “Flexr: Few-shot classification with language embeddings for structured reporting of chest x-rays,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
E. Tiu, E. Talius, P. Patel, C. P. Langlotz, A. Y. Ng, and P. Rajpurkar, “Expert-level detection of pathologies from unannotated chest x-ray images via self-supervised learning,” <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Nature Biomedical Engineering</span>, vol. 6, pp. 1399–1406, Dec 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Lin, M. Chen, W. Wang, B. Wu, K. Li, B. Lin, H. Liu, and X. He, “Clip is also an efficient segmenter: A text-driven approach for weakly supervised semantic segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
P.-T. Jiang and Y. Yang, “Segment anything is a good pseudo-label generator for weakly supervised semantic segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Liu, T. Hu, Y. Zhang, X. Gai, Y. Feng, and Z. Liu, “A chatgpt aided explainable framework for zero-shot medical image diagnosis,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
T. Shaharabany, A. Dahan, R. Giryes, and L. Wolf, “Autosam: Adapting sam to medical images by overloading the prompt encoder,” <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">ArXiv</span>, vol. abs/2306.06370, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
D. Cheng, Z. Qin, Z. Jiang, S. Zhang, Q. Lao, and K. Li, “Sam on medical images: A comprehensive study on three prompt modes,” <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">ArXiv</span>, vol. abs/2305.00035, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
S. Gong, Y. Zhong, W. Ma, J. Li, Z. Wang, J. Zhang, P.-A. Heng, and Q. Dou, “3dsam-adapter: Holistic adaptation of sam from 2d to 3d for promptable medical image segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
A. v. d. Oord, Y. Li, and O. Vinyals, “Representation learning with contrastive predictive coding,” <span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:1807.03748</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C.-H. Yeh, C.-Y. Hong, Y.-C. Hsu, T.-L. Liu, Y. Chen, and Y. LeCun, “Decoupled contrastive learning,” 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
J. Robinson, C.-Y. Chuang, S. Sra, and S. Jegelka, “Contrastive learning with hard negative samples,” 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
O. Pelka, S. Koitka, J. Rückert, F. Nensa, and C. Friedrich, “Radiology objects in context (roco): A multimodal image dataset,” in <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">CVII-STENT/LABELS@MICCAI</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
F. Radenovic, A. Dubey, A. Kadian, T. Mihaylov, S. Vandenhende, Y. Patel, Y. Wen, V. Ramanathan, and D. Mahajan, “Filtering, distillation, and hard negatives for vision-language pre-training,” <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">arXiv:2301.02280</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
W. Lin, Z. Zhao, X. Zhang, C. Wu, Y. Zhang, Y. Wang, and W. Xie, “Pmc-clip: Contrastive language-image pre-training using biomedical documents,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
W. Al-Dhabyani, M. Gomaa, H. Khaled, and A. Fahmy, “Dataset of breast ultrasound images,” <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">Data in Brief</span>, vol. 28, p. 104863, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
M. Byra, P. Jarosik, A. Szubert, M. Galperin, H. Ojeda-Fournier, L. Olson, M. O’Boyle, C. Comstock, and M. Andre, “Breast mass segmentation in ultrasound with selective kernel U-Net convolutional neural network,” <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">Biomed Signal Process Control</span>, vol. 61, June 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
J. Cheng, “brain tumor dataset,” 4 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
M. E. H. Chowdhury, T. Rahman, A. Khandakar, R. Mazhar, M. A. Kadir, Z. B. Mahbub, K. R. Islam, M. S. Khan, A. Iqbal, N. A. Emadi, M. B. I. Reaz, and M. T. Islam, “Can ai help in screening viral and covid-19 pneumonia?,” <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">IEEE Access</span>, vol. 8, pp. 132665–132676, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
T. Rahman, A. Khandakar, Y. Qiblawey, A. Tahir, S. Kiranyaz, S. B. Abul Kashem, M. T. Islam, S. Al Maadeed, S. M. Zughaier, M. S. Khan, and M. E. Chowdhury, “Exploring the effect of image enhancement techniques on covid-19 detection using chest x-ray images,” <span class="ltx_text ltx_font_italic" id="bib.bib48.1.1">Computers in Biology and Medicine</span>, vol. 132, p. 104319, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
D. Konya, “CT lung &amp; heart &amp; trachea segmentation,” Oct. 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
S. Aleem, F. Wang, M. Maniparambil, E. Arazo, J. Dietlmeier, G. Silvestre, K. Curran, N. E. O’Connor, and S. Little, “Test-time adaptation with salip: A cascade of sam and clip for zero shot medical image segmentation,” 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
H. Dai, C. Ma, Z. Yan, Z. Liu, E. Shi, Y. Li, P. Shu, X. Wei, L. Zhao, Z. Wu, F. Zeng, D. Zhu, W. Liu, Q. Li, L. Sun, S. Z. T. Liu, and X. Li, “Samaug: Point prompt augmentation for segment anything model,” 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
V. I. Butoi, J. J. G. Ortiz, T. Ma, M. R. Sabuncu, J. Guttag, and A. V. Dalca, “Universeg: Universal medical image segmentation,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
L. Ayzenberg, R. Giryes, and H. Greenspan, “Protosam-one shot medical image segmentation with foundational models,” <span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">arXiv preprint arXiv:2407.07042</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Q. Wu, Y. Zhang, and M. Elbatel, “Self-prompting large vision models for few-shot medical image segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib54.1.1">MICCAI Workshop on Domain Adaptation and Representation Transfer</span>, pp. 156–167, Springer, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
J. Achiam, S. Adler, S. Agarwal, L. Ahmad, I. Akkaya, F. L. Aleman, D. Almeida, J. Altenschmidt, S. Altman, S. Anadkat, <span class="ltx_text ltx_font_italic" id="bib.bib55.1.1">et al.</span>, “Gpt-4 technical report,” <span class="ltx_text ltx_font_italic" id="bib.bib55.2.2">arXiv preprint arXiv:2303.08774</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
J. Ding, N. Xue, G.-S. Xia, and D. Dai, “Decoupling zero-shot semantic segmentation,” 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct 10 22:42:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
